import{_ as G}from"./DulHLllv.js";import{C as m,j as t,g as u,d as M,m as N,u as I,r as S,E as V,x as s,G as B,H as _,i as l,F as j,O as z,aO as U,b as J,c as A,K as p,w as R,aK as K,f as v,t as H,v as L,e as T}from"./B4BPTRlB.js";import{u as P}from"./C1hERgHN.js";import{a as O}from"./5fD26zkw.js";function q(b,r){return u(),m("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"})])}const Q={class:"relative"},W=["onClick"],X={class:"w-full text-sm text-left"},Y={key:0},Z=M({__name:"MultipleSelect",props:N({options:{type:Array,required:!0},animate:{type:Boolean,default:!1}},{modelValue:{type:Array,default:[]},modelModifiers:{}}),emits:["update:modelValue"],setup(b){const r=I(b,"modelValue"),$=b,i=S(!1);function w(c){return r.value.some(n=>n.key===c.key)}function C(c){const n=r.value.findIndex(f=>f.key===c.key);n===-1?r.value.push(c):r.value.splice(n,1)}return(c,n)=>(u(),m("div",Q,[s(i)?(u(),m("div",{key:0,class:"fixed inset-0 w-screen z-10",onClick:n[0]||(n[0]=f=>i.value=!s(i))})):V("",!0),t("button",{class:_(["relative min-w-40 xl:min-w-52 w-full bg-white dark:bg-gray-800 flex justify-between items-center px-2 py-0.5 rounded-md border-[2px] border-gray-300 dark:border-gray-900",s(i)?"z-20":""]),onClick:n[1]||(n[1]=f=>i.value=!s(i))},[t("div",null,B(r.value.length)+" selected ",1),t("div",{class:_(["transition-all duration-200",s(i)?"-rotate-180":"rotate-0"])},[l(s(q),{class:"h-3 w-3 text-gray-400 dark:text-gray-600"})],2)],2),t("div",{class:_(["absolute w-full max-h-60 overflow-y-scroll top-9 bg-white dark:bg-gray-800 right-0 rounded-md border-[2px] border-gray-300 dark:border-gray-900 z-20 p-0.5",b.animate?s(i)?"transition-all h-60 opacity-100":"transition-all h-0 opacity-0 pointer-events-none":s(i)?"h-60":"h-0 opacity-0"])},[(u(!0),m(j,null,z($.options,f=>(u(),m("button",{key:f.key,class:"w-full flex justify-between items-center hover:bg-gray-100 hover:dark:bg-gray-800 p-1 rounded-md",onClick:F=>C(f)},[t("div",X,B(f.label),1),w(f)?(u(),m("div",Y,[l(s(U),{class:"h-4 w-4 text-gray-600 dark:text-gray-400"})])):V("",!0)],8,W))),128))],2)]))}}),ee={class:"relative"},te=["onClick"],re={class:"w-full text-sm text-left"},se={key:0},oe=M({__name:"SingleSelect",props:N({options:{type:Array,required:!0},animate:{type:Boolean,default:!1}},{modelValue:{type:Object,default:{}},modelModifiers:{}}),emits:["update:modelValue"],setup(b){const r=I(b,"modelValue"),$=b,i=S(!1);function w(C){r.value=C}return(C,c)=>(u(),m("div",ee,[s(i)?(u(),m("div",{key:0,class:"fixed inset-0 w-screen z-10",onClick:c[0]||(c[0]=n=>i.value=!s(i))})):V("",!0),t("button",{class:_(["relative min-w-40 xl:min-w-52 w-full bg-white dark:bg-gray-800 flex justify-between items-center px-2 py-0.5 rounded-md border-[2px] border-gray-300 dark:border-gray-900",s(i)?"z-20":""]),onClick:c[1]||(c[1]=n=>i.value=!s(i))},[t("div",null,B(r.value.label),1),t("div",{class:_(["transition-all duration-200",s(i)?"-rotate-180":"rotate-0"])},[l(s(q),{class:"h-3 w-3 text-gray-400 dark:text-gray-600"})],2)],2),t("div",{class:_(["absolute w-full max-h-60 overflow-y-scroll top-9 bg-white dark:bg-gray-800 right-0 rounded-md border-[2px] border-gray-300 dark:border-gray-900 z-20 p-0.5",b.animate?s(i)?"transition-all h-60 opacity-100":"transition-all h-0 opacity-0 pointer-events-none":s(i)?"h-60":"h-0 opacity-0"])},[(u(!0),m(j,null,z($.options,n=>(u(),m("button",{key:n.key,class:"w-full flex justify-between items-center hover:bg-gray-100 hover:dark:bg-gray-800 p-1 rounded-md",onClick:f=>w(n)},[t("div",re,B(n.label),1),n.key==r.value.key?(u(),m("div",se,[l(s(U),{class:"h-4 w-4 text-gray-600 dark:text-gray-400"})])):V("",!0)],8,te))),128))],2)]))}}),ae={class:"w-full"},ne={class:"mt-4 md:mt-8 p-3 md:p-4"},le={class:"space-y-4 lg:space-y-0 lg:flex justify-center items-center mb-4"},ie={class:"space-y-4 md:space-y-0 md:flex justify-center items-center lg:mb-0"},de={class:"flex items-center"},ue={class:"flex items-center md:ml-4"},ce={class:"lg:ml-4"},me={class:"flex flex-wrap gap-2 items-center"},pe={class:"overflow-x-auto -mx-3 md:mx-0"},fe={class:"flex min-w-max"},ge={class:"flex flex-col border-r-2 dark:border-gray-900 font-bold flex-shrink-0"},ye={class:"text-center"},be={class:"flex overflow-x-auto"},ke={class:"px-2 md:px-4 flex items-center justify-center border-b border-t-2 dark:border-gray-900 h-16 md:h-20 bg-white dark:bg-backdrop-dark gap-1"},xe={class:"text-xs md:text-sm text-gray-700 dark:text-gray-300 truncate"},Ce=M({__name:"benchmark",setup(b){P({title:"Benchmark"});const r=J(),$=K(),i=A(()=>r.tabs),w=S(r.benchmarkColumns),C=S(r.benchmarkSorts);r.benchmarkFilters.length===0&&r.setBenchmarkFilters(w.value);const c=S(JSON.parse(JSON.stringify(r.benchmarkFilters)));Object.keys(r.benchmarkSelectedSort).length==0&&r.setBenchmarkSort(C.value[0]);const n=S(r.benchmarkSelectedSort),f=A(()=>{var g,x,h;const k=r.tabs,o=[];for(const y in k){const d=k[y],e={id:d.id,strategy:((g=d.form.routes[0])==null?void 0:g.strategy)??"",start_date:d.form.start_date,finish_date:d.form.finish_date,fast_mode:d.form.fast_mode,exchange:d.form.exchange,symbol:((x=d.form.routes[0])==null?void 0:x.symbol)??"",timeframe:((h=d.form.routes[0])==null?void 0:h.timeframe)??""},a=d.results.metrics;Object.keys(a).length>0&&(e.total_closed_trades=a.total,e.net_profit=p.round(a.net_profit,1),e.net_profit_percentage=`${p.round(a.net_profit_percentage,1)} %`,e.total_paid_fees=p.round(a.fee,1),e.max_drawdown=`${p.round(a.max_drawdown,1)} %`,e.annual_return=`${p.round(a.annual_return,1)} %`,e.expectancy=`${p.round(a.expectancy_percentage,1)} %`,e.ratio_avg_win_loss=p.round(a.ratio_avg_win_loss,1),e.win_rate=`${p.round(a.win_rate*100,1)} %`,e.longs_percentage=`${p.round(a.longs_percentage,1)} %`,e.shorts_percentage=`${p.round(a.shorts_percentage,1)} %`,e.average_holding_hours=p.round(a.average_holding_period/3600,1),e.sharpe_ratio=p.round(a.sharpe_ratio,1),e.sortino_ratio=p.round(a.sortino_ratio,1),e.calmar_ratio=p.round(a.calmar_ratio,1),e.omega_ratio=p.round(a.omega_ratio,1)),d.results.executing&&!d.results.exception.error?(e.progress=`${d.results.progressbar.current}%`,e.status="running"):d.results.exception.error&&d.results.executing?(e.progress="❌",e.status="error"):Object.keys(a).length===0?e.status="":(e.progress="✅",e.status="finished"),o.push(e)}return o}),F=A(()=>n.value.key==="none"?f.value:[...f.value].sort((k,o)=>{const g=n.value.key,x=parseFloat(k[g])||null,h=parseFloat(o[g])||null;return x===null&&h===null?0:x===null?1:h===null||x>h?-1:x<h?1:0}));function D(){c.value.sort((k,o)=>w.value.findIndex(g=>g.key===k.key)-w.value.findIndex(g=>g.key===o.key)),r.setBenchmarkFilters(c.value)}return R(c,D,{deep:!0}),R(n,k=>{r.setBenchmarkSort(k)},{deep:!0}),(k,o)=>{const g=G,x=Z,h=oe,y=H,d=L;return u(),m(j,null,[t("div",ae,[l(g,{"current-tab":null,tabs:i.value,onClose:o[0]||(o[0]=e=>s(r).closeTab(e,s($).path))},null,8,["tabs"])]),t("div",ne,[t("div",le,[t("div",ie,[t("div",de,[o[4]||(o[4]=t("div",{class:"font-bold whitespace-nowrap mr-3 text-sm md:text-base"},"Filter by:",-1)),l(x,{modelValue:c.value,"onUpdate:modelValue":o[1]||(o[1]=e=>c.value=e),options:w.value},null,8,["modelValue","options"])]),t("div",ue,[o[5]||(o[5]=t("div",{class:"font-bold whitespace-nowrap mr-3 text-sm md:text-base"},"Sort by:",-1)),l(h,{modelValue:n.value,"onUpdate:modelValue":o[2]||(o[2]=e=>n.value=e),options:C.value},null,8,["modelValue","options"])])]),t("div",ce,[o[10]||(o[10]=t("div",{class:"font-bold mb-3 text-sm md:text-base lg:hidden"},"Actions:",-1)),t("div",me,[o[9]||(o[9]=t("div",{class:"hidden lg:block font-bold mr-2"},"Actions:",-1)),l(y,{icon:"i-heroicons-arrow-path",size:"sm",class:"flex-1 sm:flex-none",onClick:s(r).rerunAll},{default:v(()=>o[6]||(o[6]=[t("span",{class:"hidden sm:inline"},"Rerun All",-1),t("span",{class:"sm:hidden"},"Rerun",-1)])),_:1},8,["onClick"]),l(y,{icon:"i-heroicons-arrow-path",color:"rose",size:"sm",class:"flex-1 sm:flex-none",onClick:s(r).rerunFailed},{default:v(()=>o[7]||(o[7]=[t("span",{class:"hidden sm:inline"},"Rerun Failed Only",-1),t("span",{class:"sm:hidden"},"Failed",-1)])),_:1},8,["onClick"]),l(y,{icon:"i-heroicons-stop",color:"gray",size:"sm",class:"flex-1 sm:flex-none",onClick:s(r).cancelAllRunning},{default:v(()=>o[8]||(o[8]=[t("span",{class:"hidden sm:inline"},"Cancel All",-1),t("span",{class:"sm:hidden"},"Cancel",-1)])),_:1},8,["onClick"])])])]),t("div",pe,[t("div",fe,[t("div",ge,[o[11]||(o[11]=t("div",{class:"border-b-2 dark:border-gray-900 h-16 md:h-20"},null,-1)),(u(!0),m(j,null,z(c.value,(e,a)=>(u(),m("div",{key:e.key,class:_(["text-xs md:text-sm uppercase border-b border-l dark:border-gray-900 min-w-[10rem] md:min-w-[13rem] min-h-[3.5rem] md:min-h-[4rem] flex items-center justify-center px-2",a%2===0?"bg-gray-50 dark:bg-gray-800":"bg-white dark:bg-backdrop-dark"])},[t("span",ye,B(e.label),1)],2))),128))]),t("div",be,[(u(!0),m(j,null,z(F.value,e=>(u(),m("div",{key:e.id,class:"flex flex-col border-r dark:border-gray-900 flex-shrink-0"},[t("div",ke,[l(d,{text:"Rerun","open-delay":500,popper:{arrow:!0}},{default:v(()=>[l(y,{size:"xs",class:"md:mr-2",variant:"ghost",icon:"i-heroicons-arrow-path",disabled:e.status==="running",onClick:a=>s(r).rerun(e.id)},null,8,["disabled","onClick"])]),_:2},1024),l(d,{text:"Go to backtest page","open-delay":500,popper:{arrow:!0}},{default:v(()=>[l(y,{to:`/backtest/${e.id}`,size:"xs",class:"md:mr-2",variant:"ghost",color:"gray",icon:"i-heroicons-arrow-top-right-on-square"},null,8,["to"])]),_:2},1024),l(d,{text:"Duplicate","open-delay":500,popper:{arrow:!0}},{default:v(()=>[l(y,{size:"xs",class:"md:mr-2",variant:"ghost",icon:"i-heroicons-document-duplicate",color:"blue",onClick:a=>s(r).duplicateTab(e.id)},null,8,["onClick"])]),_:2},1024),e.status==="running"?(u(),T(d,{key:0,text:"Cancel","open-delay":500,popper:{arrow:!0}},{default:v(()=>[l(y,{size:"xs",variant:"ghost",icon:"i-heroicons-stop",color:"gray",onClick:a=>s(r).cancel(e.id)},null,8,["onClick"])]),_:2},1024)):(u(),T(d,{key:1,text:"Close tab","open-delay":500,popper:{arrow:!0}},{default:v(()=>[l(y,{size:"xs",variant:"ghost",icon:"i-heroicons-trash",color:"red",disabled:Object.keys(F.value).length==1,onClick:a=>s(r).closeTab(e.id,s($).path)},null,8,["disabled","onClick"])]),_:2},1024))]),(u(!0),m(j,null,z(c.value,(a,E)=>(u(),m("div",{key:a.key,class:_(["border-b dark:border-gray-900 min-w-[6rem] text-center min-h-[3.5rem] md:min-h-[4rem] w-[10em] md:w-[13em]",e.status==="running"?"animate-pulse":""])},[t("div",{class:_(["px-2 md:px-4 py-3 md:py-4 w-full h-full truncate flex items-center justify-center",E%2===0?"bg-gray-50 dark:bg-gray-800":"bg-white dark:bg-backdrop-dark"])},[t("span",xe,B(e[a.key]||"-"),1)],2)],2))),128))]))),128)),l(d,{text:"Add New Tab","open-delay":500,popper:{arrow:!0}},{default:v(()=>[t("button",{class:"w-16 md:w-20 h-full px-2 md:px-4 flex flex-col justify-between items-center border-dashed border-2 dark:border-gray-900 bg-white hover:bg-gray-50 dark:bg-backdrop-dark hover:dark:bg-gray-800 py-8 md:py-10 flex-shrink-0",onClick:o[3]||(o[3]=e=>s(r).addTab())},[l(s(O),{class:"h-5 w-5 md:h-6 md:w-6 text-gray-400 dark:text-gray-100"}),l(s(O),{class:"h-5 w-5 md:h-6 md:w-6 text-gray-400 dark:text-gray-100"}),l(s(O),{class:"h-5 w-5 md:h-6 md:w-6 text-gray-400 dark:text-gray-100"})])]),_:1})])])])])],64)}}});export{Ce as default};
