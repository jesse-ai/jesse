import{a as F}from"./CNlI_mjZ.js";import{_ as G}from"./BAhmbuaU.js";import{z as y,g as n,j as h,d as H,r as k,P as J,a9 as Y,c as Z,aa as A,w as K,i as d,e as c,G as p,f as R,W as _,I as C,J as E,q as S,t as Q,a6 as X}from"./BZBcjETW.js";function V(w,e){return n(),y("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[h("path",{"fill-rule":"evenodd",d:"M12 3.75a.75.75 0 0 1 .75.75v6.75h6.75a.75.75 0 0 1 0 1.5h-6.75v6.75a.75.75 0 0 1-1.5 0v-6.75H4.5a.75.75 0 0 1 0-1.5h6.75V4.5a.75.75 0 0 1 .75-.75Z","clip-rule":"evenodd"})])}const ee={id:"routes-section",class:"select-none"},oe={class:"w-full flex justify-center"},ae=H({__name:"Routes",props:{timeframes:{},symbols:{},form:{},totalRoutesError:{}},setup(w){const e=w,b=k([]),g=k(""),l=J(),D=k({data_routes:e.form.data_routes}),M=k({routes:e.form.routes}),f=Y({uniqueRoutesErrorMessage:"each exchange-symbol pair can be traded only once! More info: https://docs.jesse.trade/docs/routes.html#trading-multiple-routes",maxSymbolLengthErrorMessage:"Maximum symbol length is exceeded!",mustContainDashErrorMessage:'Symbol parameter must contain "-" character!',timeframeMustBeDifferentErrorMessage:"Data routes' timeframe and trading routes' timeframe must be different",emptyParameter:"You must fill all the parameters",invalidSymbol:"Symbol is invalid"}),U=Z(()=>l.strategies);A(()=>{D.value={data_routes:e.form.data_routes},M.value={routes:e.form.routes},z(),O()});function z(){e.form.routes.length||e.form.routes.push({symbol:"",timeframe:l.jesseSupportedTimeframes.includes("4h")?"4h":l.jesseSupportedTimeframes[l.jesseSupportedTimeframes.length-1],strategy:l.strategies[0]})}function O(){e.totalRoutesError.splice(0,e.totalRoutesError.length);for(const s of e.form.routes)x(s);if(e.form.data_routes.length>0)for(const s of e.form.data_routes)x(s);let t=!1;const o=e.form.routes;for(const s of o.slice(0,-1)){if(e.totalRoutesError.includes(f.uniqueRoutesErrorMessage)||t)break;for(const m of o.slice(o.indexOf(s)+1))if(s.strategy===m.strategy&&s.symbol===m.symbol&&s.symbol.length!==0){e.totalRoutesError.push(f.uniqueRoutesErrorMessage),t=!1;break}}let u=!1;const i=e.form.data_routes;for(const s of i.slice(0,-1)){if(e.totalRoutesError.includes(f.uniqueRoutesErrorMessage)||u)break;for(const m of i.slice(i.indexOf(s)+1))if(s.timeframe===m.timeframe&&s.symbol===m.symbol){e.totalRoutesError.push(f.uniqueRoutesErrorMessage),u=!0;break}}if(e.form.data_routes.length>0)for(const s of i){if(e.totalRoutesError.includes(f.timeframeMustBeDifferentErrorMessage)||t)break;for(const m of e.form.routes)if(s.symbol===m.symbol&&s.timeframe===m.timeframe){e.totalRoutesError.push(f.timeframeMustBeDifferentErrorMessage),u=!0;break}}}function x(t){!e.totalRoutesError.includes(f.emptyParameter)&&(t.symbol.length==0||t.timeframe.length==0)&&e.totalRoutesError.push(f.emptyParameter)}function $(){e.form.routes.push({symbol:"",timeframe:l.jesseSupportedTimeframes.includes("4h")?"4h":l.jesseSupportedTimeframes[l.jesseSupportedTimeframes.length-1],strategy:l.strategies[0]})}function j(){e.form.data_routes.push({symbol:"",timeframe:l.jesseSupportedTimeframes.includes("4h")?"4h":l.jesseSupportedTimeframes[l.jesseSupportedTimeframes.length-1]})}function q(t){const o=e.form.routes.indexOf(t);e.form.routes.length!==1&&o>-1&&e.form.routes.splice(o,1)}function B(t){const o=e.form.data_routes.indexOf(t);e.form.data_routes.length!==0&&o>-1&&e.form.data_routes.splice(o,1)}function T(t){const o=e.form.routes.indexOf(t),u={strategy:t.strategy,symbol:"",timeframe:t.timeframe};e.form.routes.splice(o+1,0,u)}function I(t){const o=e.form.data_routes.indexOf(t),u={symbol:"",timeframe:t.timeframe};e.form.data_routes.splice(o+1,0,u)}function L(t){const o=e.form.routes.indexOf(t);o!==0&&(e.form.routes[o]=e.form.routes[o-1],e.form.routes[o-1]=t)}function N(t){const o=e.form.data_routes.indexOf(t);o!==0&&(e.form.data_routes[o]=e.form.data_routes[o-1],e.form.data_routes[o-1]=t)}function P(t){const o=e.form.routes.indexOf(t);o!==e.form.routes.length-1&&(e.form.routes[o]=e.form.routes[o+1],e.form.routes[o+1]=t)}function W(t){const o=e.form.data_routes.indexOf(t);o!==e.form.data_routes.length-1&&(e.form.data_routes[o]=e.form.data_routes[o+1],e.form.data_routes[o+1]=t)}return K(()=>g.value,t=>{if(t.length==0){b.value=[];return}const o=[];for(const u of e.symbols){if(o.length>50)break;u.toLowerCase().startsWith(t.toLowerCase())&&o.push(u)}b.value=o}),(t,o)=>{const u=F,i=G,s=Q,m=X;return n(),y("div",ee,[d(u,{title:"Routes"},{default:R(()=>[h("div",oe,[h("button",{type:"button",class:"inline-flex items-center shadow-sm px-4 py-1.5 border border-gray-300 dark:border-gray-900 text-sm leading-5 font-medium rounded-l-full text-gray-700 dark:text-gray-100 bg-white dark:bg-backdrop-dark hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none",onClick:$},[d(_(V),{class:"-ml-1.5 mr-1 h-5 w-5 text-gray-400","aria-hidden":"true"}),o[4]||(o[4]=h("span",null,"Trading Route",-1))]),h("button",{type:"button",class:"inline-flex items-center shadow-sm px-4 py-1.5 border border-gray-300 dark:border-gray-900 text-sm leading-5 font-medium rounded-r-full text-gray-700 dark:text-gray-100 bg-white dark:bg-backdrop-dark hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none",onClick:j},[d(_(V),{class:"-ml-1.5 mr-1 h-5 w-5 text-gray-400","aria-hidden":"true"}),o[5]||(o[5]=h("span",null,"Data Route",-1))])])]),_:1}),(n(!0),y(C,null,E(t.form.routes,(r,v)=>(n(),y("div",{key:r.symbol+v,class:"flex mt-4"},[d(i,{modelValue:r.symbol,"onUpdate:modelValue":a=>r.symbol=a,query:g.value,"onUpdate:query":o[0]||(o[0]=a=>g.value=a),"clear-search-on-close":"",class:"w-full",ui:{rounded:"rounded-none rounded-l"},searchable:"","searchable-placeholder":"Search symbols...",size:"lg",options:b.value,placeholder:"Select a symbol...",onChange:o[1]||(o[1]=a=>g.value="")},{empty:R(()=>o[6]||(o[6]=[S("Start typing...")])),_:2},1032,["modelValue","onUpdate:modelValue","query","options"]),d(i,{modelValue:r.timeframe,"onUpdate:modelValue":a=>r.timeframe=a,class:"w-full",ui:{rounded:"rounded-none"},size:"lg","value-attribute":"value",options:t.timeframes},null,8,["modelValue","onUpdate:modelValue","options"]),d(i,{modelValue:r.strategy,"onUpdate:modelValue":a=>r.strategy=a,class:"w-full",ui:{rounded:"rounded-none rounded-r"},size:"lg",options:U.value,searchable:""},null,8,["modelValue","onUpdate:modelValue","options"]),t.form.routes.length>1?(n(),c(s,{key:0,class:"",size:"lg",variant:"link",color:"gray",icon:"i-heroicons-trash",disabled:t.form.routes.length===1,onClick:a=>q(r)},null,8,["disabled","onClick"])):p("",!0),t.form.routes.length>1?(n(),c(s,{key:1,class:"",size:"lg",variant:"link",color:"gray",icon:"i-heroicons-document-duplicate",disabled:t.form.routes.length===1,onClick:a=>T(r)},null,8,["disabled","onClick"])):p("",!0),t.form.routes.length>1?(n(),c(s,{key:2,class:"",size:"lg",variant:"link",color:"gray",icon:"i-heroicons-arrow-down",disabled:t.form.routes.indexOf(r)===t.form.routes.length-1,onClick:a=>P(r)},null,8,["disabled","onClick"])):p("",!0),t.form.routes.length>1?(n(),c(s,{key:3,class:"",size:"lg",variant:"link",color:"gray",icon:"i-heroicons-arrow-up",disabled:t.form.routes.indexOf(r)===0,onClick:a=>L(r)},null,8,["disabled","onClick"])):p("",!0),d(s,{class:"",size:"lg",variant:"link",color:"gray",icon:"i-heroicons-code-bracket",to:`/strategies/${r.strategy}`},null,8,["to"])]))),128)),t.form.data_routes.length?(n(),c(m,{key:0,class:"mt-8 mb-4",title:"Data Routes"})):p("",!0),(n(!0),y(C,null,E(t.form.data_routes,(r,v)=>(n(),y("div",{key:r.symbol+v+r.timeframe,class:"flex mt-4"},[d(i,{modelValue:r.symbol,"onUpdate:modelValue":a=>r.symbol=a,query:g.value,"onUpdate:query":o[2]||(o[2]=a=>g.value=a),"clear-search-on-close":"",class:"w-full",ui:{rounded:"rounded-none rounded-l"},searchable:"",size:"lg",options:b.value,placeholder:"Select a symbol...",onChange:o[3]||(o[3]=a=>g.value="")},{empty:R(()=>o[7]||(o[7]=[S("Start typing...")])),_:2},1032,["modelValue","onUpdate:modelValue","query","options"]),d(i,{modelValue:r.timeframe,"onUpdate:modelValue":a=>r.timeframe=a,class:"w-full",ui:{rounded:"rounded-none rounded-r"},size:"lg","value-attribute":"value",options:t.timeframes},null,8,["modelValue","onUpdate:modelValue","options"]),d(s,{size:"lg",variant:"link",color:"gray",icon:"i-heroicons-trash",onClick:a=>B(r)},null,8,["onClick"]),t.form.routes.length>1?(n(),c(s,{key:0,class:"",size:"lg",variant:"link",color:"gray",icon:"i-heroicons-document-duplicate",onClick:a=>I(r)},null,8,["onClick"])):p("",!0),t.form.data_routes.length>1?(n(),c(s,{key:1,class:"",size:"lg",variant:"link",color:"gray",icon:"i-heroicons-arrow-down",disabled:t.form.data_routes.indexOf(r)===t.form.data_routes.length-1,onClick:a=>W(r)},null,8,["disabled","onClick"])):p("",!0),t.form.data_routes.length>1?(n(),c(s,{key:2,class:"",size:"lg",variant:"link",color:"gray",icon:"i-heroicons-arrow-up",disabled:t.form.data_routes.indexOf(r)===0,onClick:a=>N(r)},null,8,["disabled","onClick"])):p("",!0)]))),128))])}}});export{ae as _};
