import{_ as nt}from"./DulHLllv.js";import{_ as it}from"./D70O6DcD.js";import{d as re,r as w,c as M,w as W,n as qe,bg as dt,C as d,g as a,e as F,E as k,i as l,H as Q,j as t,G as y,F as A,O as se,t as Ve,u as Se,f as E,z as He,R as Pe,v as We,x as r,y as ut,_ as Ue,m as $e,a as Je,q as pe,l as ct,p as ft,s as Y,h as mt,I as Ce,J as te,K as fe,ar as ze,bl as Ge,D as ne,a6 as Ye,bs as ee,B as Me,o as gt,a0 as Ee,bt as pt,b as Qe,a5 as vt,a7 as yt,aO as bt,bu as ht,L as wt,bn as me,N as kt,k as xt,ag as _t,M as $t,bq as Ct,aK as Vt,ai as St}from"./B4BPTRlB.js";import{_ as Tt}from"./B55nz3SB.js";import{r as jt,_ as Lt}from"./DoJlG3UZ.js";import{_ as Rt}from"./DVdeiVNj.js";import{_ as Et}from"./D5ef-Ux6.js";import{_ as Ut}from"./CMe2MPRr.js";import{_ as Mt}from"./gsO7P_-7.js";import{_ as Ot}from"./0VzfMacR.js";import{_ as Bt}from"./BBSocZrR.js";import{_ as It}from"./CvWDOg8i.js";import{_ as Nt}from"./BusOdbyj.js";import{_ as Pt}from"./BusspaHq.js";import{T as De}from"./9VOnL4Iz.js";import{s as _e,l as Fe,d as Ae}from"./BS9OwPT8.js";import{u as Ze}from"./C1hERgHN.js";import{u as zt}from"./D-IpUm1J.js";import"./5fD26zkw.js";const Dt={class:"w-full h-full flex flex-col"},Ft={key:0,class:"flex justify-center items-center py-8"},At={class:"w-full relative"},qt={key:0,class:"whitespace-pre-line select-text text-base dark:text-gray-300 w-full mb-1"},Ht={key:3,class:"mt-4 flex justify-center"},ge=1e3,Wt=re({__name:"Logs",props:{logs:{},sections:{},totalLogs:{}},setup(I){const n=I,_=w(""),p=w(!1),m=w(!1),u=w([]),f=w(null),s=w(1),c=w(!1),S=w(ge),b=M(()=>c.value?u.value:u.value.slice(0,S.value));W(()=>n.logs,async g=>{g&&(p.value=!0,await qe(),setTimeout(()=>{u.value=g.slice(0,ge),s.value=1,c.value=g.length<=ge,p.value=!1},0),setTimeout(()=>{_.value=n.logs.join(`
`)},0))},{immediate:!0}),W(s,()=>{S.value=s.value*ge});function R(g){const v=g.target;v.scrollHeight-v.scrollTop<=v.clientHeight+50&&$()}async function $(){m.value||c.value||(m.value=!0,setTimeout(()=>{const g=s.value*ge,v=(s.value+1)*ge;if(g<n.logs.length){const T=n.logs.slice(g,v);u.value=[...u.value,...T],s.value++,c.value=v>=n.logs.length}else c.value=!0;m.value=!1},0))}return(g,v)=>{const T=dt("ULoading"),J=it,q=Ve;return a(),d("div",Dt,[p.value?(a(),d("div",Ft,[l(T,{size:"lg"})])):u.value.length?(a(),d("div",{key:2,ref_key:"logContainer",ref:f,class:Q([c.value?"h-[calc(100vh-120px)]":"h-[calc(100vh-180px)]","w-full overflow-y-scroll rounded border dark:border-gray-600 bg-gray-50 dark:bg-gray-700 px-4 sm:px-6 py-2"]),onScroll:R},[t("div",At,[c.value?(a(),d("pre",qt,"          "+y(_.value)+`
        `,1)):(a(!0),d(A,{key:1},se(b.value,(N,L)=>(a(),d("pre",{key:0+L,class:"whitespace-pre-line select-text text-base dark:text-gray-300 w-full mb-1"},y(N),1))),128))])],34)):(a(),F(J,{key:1})),u.value.length&&!c.value?(a(),d("div",Ht,[l(q,{loading:m.value,class:"w-full flex justify-center",label:`(loaded ${u.value.length} / ${n.logs.length}) Load All Logs`,onClick:v[0]||(v[0]=N=>c.value=!0)},null,8,["loading","label"])])):k("",!0)])}}}),Jt={class:"flex items-center justify-between"},Gt=re({__name:"FullscreenModal",props:{modelValue:{type:Boolean,default:!1},modelModifiers:{}},emits:["update:modelValue"],setup(I){const n=Se(I,"modelValue");return(_,p)=>{const m=We,u=He,f=Ue;return a(),F(f,{modelValue:n.value,"onUpdate:modelValue":p[1]||(p[1]=s=>n.value=s),fullscreen:""},{default:E(()=>[l(u,{ui:{base:"h-full flex flex-col",rounded:"",divide:"divide-y divide-gray-100 dark:divide-gray-800",body:{base:"grow"}}},{header:E(()=>[t("div",Jt,[t("div",null,[Pe(_.$slots,"title")]),l(m,{text:"Close",popper:{arrow:!0,offsetDistance:10}},{default:E(()=>[t("button",{class:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 focus:outline-none transition-all duration-300",onClick:p[0]||(p[0]=s=>n.value=!1)},[l(r(ut),{class:"h-6 w-6","aria-hidden":"true"})])]),_:1})])]),default:E(()=>[Pe(_.$slots,"default")]),_:3})]),_:3},8,["modelValue"])}}}),Yt=ft(Pt),Qt={class:"flex items-center justify-between"},Zt={class:"flex flex-col space-y-4"},Xt={key:0,class:"flex flex-wrap gap-2"},Kt={class:"flex flex-col"},es={class:"flex items-center justify-between mb-2"},ts={class:"flex gap-2"},ss=re({__name:"BacktestStrategyCodeModal",props:$e({routes:{},exchange:{},strategyCodes:{}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:["update:modelValue"],setup(I){const n=I,_=Se(I,"modelValue"),p=w(""),m=w(null),u=w(""),f=w(),s=Je(),c=M(()=>s.value==="light"?"vs-light":"vs-dark"),S=M(()=>({automaticLayout:!0,minimap:{enabled:!1},fontSize:14,lineHeight:21,readOnly:!0}));W(c,g=>{var v,T;(T=(v=f.value)==null?void 0:v.$editor)==null||T.updateOptions({theme:g})}),W(_,async g=>{g&&n.routes.length>0&&(await qe(),setTimeout(()=>{var v;(v=f.value)!=null&&v.$editor&&f.value.$editor.updateOptions({theme:c.value}),b(n.routes[0])},50))}),W(()=>n.strategyCodes,g=>{g&&p.value&&(u.value=g[p.value]||"# No strategy code snapshot available for this route")},{deep:!0,immediate:!0});function b(g){var T;const v=`${n.exchange}-${g.symbol}`;p.value=v,m.value=g,u.value=((T=n.strategyCodes)==null?void 0:T[v])||"# No strategy code snapshot available for this route"}async function R(){try{await navigator.clipboard.writeText(u.value),Y("success","Strategy code copied to clipboard")}catch(g){mt(g)}}function $(){var g;(g=m.value)!=null&&g.strategy?Ce(`/strategies/${m.value.strategy}`):Y("error","No strategy selected")}return(g,v)=>{const T=Ve,J=Yt,q=ct,N=He,L=Ue;return a(),F(L,{modelValue:_.value,"onUpdate:modelValue":v[2]||(v[2]=x=>_.value=x),ui:{width:"sm:max-w-5xl"}},{default:E(()=>[l(N,null,{header:E(()=>[t("div",Qt,[v[3]||(v[3]=t("h3",{class:"text-lg font-semibold"},"Strategy Code Snapshot",-1)),l(T,{color:"gray",variant:"ghost",icon:"i-heroicons-x-mark",size:"sm",onClick:v[0]||(v[0]=x=>_.value=!1)})])]),default:E(()=>[t("div",Zt,[g.routes.length>1?(a(),d("div",Xt,[(a(!0),d(A,null,se(g.routes,x=>(a(),F(T,{key:`${g.exchange}-${x.symbol}`,variant:"soft",color:"gray",disabled:p.value===`${g.exchange}-${x.symbol}`,onClick:Z=>b(x)},{default:E(()=>[pe(y(x.strategy)+" • "+y(x.symbol),1)]),_:2},1032,["disabled","onClick"]))),128))])):k("",!0),t("div",Kt,[t("div",es,[v[4]||(v[4]=t("label",{class:"block text-sm font-medium"},null,-1)),t("div",ts,[l(T,{icon:"i-heroicons-clipboard-document",label:"Copy",variant:"soft",color:"gray",size:"sm",onClick:R}),l(T,{icon:"i-heroicons-pencil-square",label:"Go to Strategy Editor",variant:"soft",color:"primary",size:"sm",onClick:$})])]),l(q,null,{default:E(()=>[l(J,{ref_key:"codeEditorRef",ref:f,modelValue:u.value,"onUpdate:modelValue":v[1]||(v[1]=x=>u.value=x),lang:"python",options:S.value,class:"border border-gray-200 dark:border-gray-800 rounded",style:{height:"500px"}},{default:E(()=>v[5]||(v[5]=[pe(" Loading editor... ")])),_:1},8,["modelValue","options"])]),_:1})])])]),_:1})]),_:1},8,["modelValue"])}}}),os={class:"w-16 overflow-hidden"},rs={class:"w-8 overflow-hidden"},ls={key:0,class:"w-full transition-all overflow-hidden duration-300 bg-gray-50 dark:bg-gray-800"},as=["onClick"],ns={class:"w-16 overflow-hidden text-center"},is={class:"w-12 overflow-hidden text-center"},ds={class:"w-8 overflow-hidden text-center"},us={class:"p-4"},cs={class:"mt-4"},fs={class:"w-full text-sm"},ms={class:"w-full"},gs={class:"w-full flex justify-between bg-gray-50 dark:bg-gray-800 py-2 px-4"},ps={class:"w-full flex justify-between py-2 px-4"},vs={class:"w-full flex justify-between bg-gray-50 dark:bg-gray-800 py-2 px-4"},ys={class:"w-full flex justify-between py-2 px-4"},bs={class:"w-full flex justify-between bg-gray-50 dark:bg-gray-800 py-2 px-4"},hs={class:"w-full flex justify-between py-2 px-4"},ws={class:"w-full flex justify-between bg-gray-50 dark:bg-gray-800 py-2 px-4"},ks={class:"w-full flex justify-between py-2 px-4"},xs={class:"w-full flex justify-between bg-gray-50 dark:bg-gray-800 py-2 px-4"},_s={class:"w-full"},$s={class:"w-full flex justify-between bg-gray-50 dark:bg-gray-800 py-2 px-4"},Cs={class:"w-full flex justify-between py-2 px-4"},Vs={class:"w-full flex justify-between bg-gray-50 dark:bg-gray-800 py-2 px-4"},Ss={key:0,class:"w-full flex justify-between py-2 px-4"},Ts={key:1,class:"w-full flex justify-between bg-gray-50 dark:bg-gray-800 py-2 px-4"},js={key:2,class:"w-full flex justify-between py-2 px-4"},Ls={class:"flex justify-end mt-4"},Rs=re({__name:"ChartOrders",props:{trade:{}},emits:["zoom","hoverbg"],setup(I,{emit:n}){const _=n,p=w(null),m=w(!1),u=w(!1);return(f,s)=>{const c=Ve,S=Ue;return a(),d(A,null,[l(c,{variant:"ghost",color:"gray",class:"w-full flex justify-between hover:bg-gray-100 dark:hover:bg-gray-800 text-xs border-b border-gray-100 dark:border-gray-800 rounded-none p-2",onClick:s[1]||(s[1]=b=>u.value=!r(u)),onMouseover:s[2]||(s[2]=b=>_("hoverbg",f.trade.orders[0].id))},{default:E(()=>[t("div",{class:Q(["w-2 transition-all duration-300",[r(u)?"rotate-90":"rotate-0"]])},s[5]||(s[5]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-4"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"})],-1)]),2),t("div",os,y(r(te).roundPrice(f.trade.entry_price)),1),s[6]||(s[6]=t("div",{class:"w-1 opacity-20"},"|",-1)),t("div",{class:Q(["w-16 overflow-hidden",f.trade.type.toLowerCase()==="long"?"text-green-500":"text-red-500"])},y(r(fe).round(f.trade.qty,2)),3),s[7]||(s[7]=t("div",{class:"w-1 opacity-20"},"|",-1)),t("div",{class:Q([[f.trade.PNL_percentage>0?"text-green-500":"text-red-500"],"w-16 overflow-hidden text-xs"])},y(r(fe).round(f.trade.PNL_percentage,2))+"% ",3),s[8]||(s[8]=t("div",{class:"w-1 opacity-20"},"|",-1)),t("div",rs,[l(c,{icon:"i-heroicons-arrow-right",color:"gray",size:"xs",onClick:s[0]||(s[0]=ze(b=>_("zoom",f.trade.orders[0].id),["stop"]))})])]),_:1}),r(u)?(a(),d("div",ls,[s[13]||(s[13]=Ge('<div class="flex justify-between items-center border-b-2 border-gray-200 dark:border-gray-700 px-1 py-2 text-xs"><div class="w-16 overflow-hidden italic font-bold uppercase text-center">PRICE</div><div class="w-1 opacity-20">|</div><div class="w-10 overflow-hidden italic font-bold uppercase text-center">QTY</div><div class="w-1 opacity-20">|</div><div class="w-12 overflow-hidden italic font-bold uppercase text-center">TYPE</div><div class="w-1 opacity-20">|</div><div class="w-10 overflow-hidden italic font-bold uppercase text-center">SIDE</div><div class="w-1 opacity-20">|</div><div class="w-8 overflow-hidden italic font-bold uppercase text-center"></div></div>',1)),(a(!0),d(A,null,se(f.trade.orders,(b,R)=>(a(),d("div",{key:R,class:"w-full flex justify-between items-center hover:bg-gray-200 dark:hover:bg-gray-900 text-xs py-2 border-b border-gray-200 cursor-pointer dark:border-gray-700 px-1",onClick:$=>{p.value=b,m.value=!0}},[t("div",ns,y(r(te).roundPrice(b.price)),1),s[9]||(s[9]=t("div",{class:"w-1 opacity-20"},"|",-1)),t("div",{class:Q(["w-10 overflow-hidden text-center",b.side==="buy"?"text-green-500":"text-red-500"])},y(r(fe).round(b.qty,2)),3),s[10]||(s[10]=t("div",{class:"w-1 opacity-20"},"|",-1)),t("div",is,y(b.type),1),s[11]||(s[11]=t("div",{class:"w-1 opacity-20"},"|",-1)),t("div",{class:Q([[b.side==="buy"?"text-green-500":"text-red-500"],"w-10 overflow-hidden text-center"])},y(b.side.toUpperCase()),3),s[12]||(s[12]=t("div",{class:"w-1 opacity-20"},"|",-1)),t("div",ds,[l(c,{icon:"i-heroicons-arrow-right",color:"gray",size:"xs",onClick:ze($=>_("zoom",b.id),["stop"])},null,8,["onClick"])])],8,as))),128))])):k("",!0),l(S,{modelValue:r(m),"onUpdate:modelValue":s[4]||(s[4]=b=>ne(m)?m.value=b:null)},{default:E(()=>{var b,R,$,g,v,T,J,q,N,L,x;return[t("div",us,[t("div",cs,[t("div",fs,[s[29]||(s[29]=t("h2",{class:"text-lg mb-2 font-bold italic dark:text-white text-center"}," Trade ",-1)),t("div",ms,[t("div",gs,[s[14]||(s[14]=t("div",{class:"font-bold"},"Entry Price",-1)),t("div",null,y(r(te).roundPrice(f.trade.entry_price)),1)]),t("div",ps,[s[15]||(s[15]=t("div",{class:"font-bold"},"Exit Price",-1)),t("div",null,y(r(te).roundPrice(f.trade.exit_price)),1)]),t("div",vs,[s[16]||(s[16]=t("div",{class:"font-bold"},"Qty",-1)),t("div",null,y(f.trade.qty),1)]),t("div",ys,[s[17]||(s[17]=t("div",{class:"font-bold"},"Size",-1)),t("div",null,y(r(te).roundPrice(f.trade.size)),1)]),t("div",bs,[s[18]||(s[18]=t("div",{class:"font-bold"},"PNL",-1)),t("div",{class:Q([f.trade.PNL>0?"text-green-500":"text-red-500"])},y(r(fe).round(f.trade.PNL,2))+" ("+y(r(fe).round(f.trade.PNL_percentage,2))+"%) ",3)]),t("div",hs,[s[19]||(s[19]=t("div",{class:"font-bold"},"Fee",-1)),t("div",null,y(r(fe).round(f.trade.fee,2)),1)]),t("div",ws,[s[20]||(s[20]=t("div",{class:"font-bold"},"Holding Period",-1)),t("div",null,y(r(te).secondsToHumanReadable(f.trade.holding_period)),1)]),t("div",ks,[s[21]||(s[21]=t("div",{class:"font-bold"},"Opened At",-1)),t("div",null,y(new Date(f.trade.opened_at).toLocaleString()),1)]),t("div",xs,[s[22]||(s[22]=t("div",{class:"font-bold"},"Closed At",-1)),t("div",null,y(new Date(f.trade.closed_at).toLocaleString()),1)])]),s[30]||(s[30]=t("h2",{class:"text-lg font-bold italic dark:text-white mt-6 mb-2 text-center"}," Order ",-1)),t("div",_s,[t("div",$s,[s[23]||(s[23]=t("div",{class:"font-bold"},"Side",-1)),t("div",{class:Q([((b=r(p))==null?void 0:b.side)==="buy"?"text-green-500":"text-red-500"])},y(($=(R=r(p))==null?void 0:R.side)==null?void 0:$.toUpperCase()),3)]),t("div",Cs,[s[24]||(s[24]=t("div",{class:"font-bold"},"Type",-1)),t("div",null,y((g=r(p))==null?void 0:g.type),1)]),t("div",Vs,[s[25]||(s[25]=t("div",{class:"font-bold"},"Qty",-1)),t("div",null,y((v=r(p))==null?void 0:v.qty),1)]),(T=r(p))!=null&&T.created_at?(a(),d("div",Ss,[s[26]||(s[26]=t("div",{class:"font-bold"},"Created At",-1)),t("div",null,y(new Date((J=r(p))==null?void 0:J.created_at).toLocaleString()),1)])):k("",!0),(q=r(p))!=null&&q.executed_at?(a(),d("div",Ts,[s[27]||(s[27]=t("div",{class:"font-bold"},"Executed At",-1)),t("div",null,y(new Date((N=r(p))==null?void 0:N.executed_at).toLocaleString()),1)])):k("",!0),(L=r(p))!=null&&L.canceled_at?(a(),d("div",js,[s[28]||(s[28]=t("div",{class:"font-bold"},"Canceled At",-1)),t("div",null,y(new Date((x=r(p))==null?void 0:x.canceled_at).toLocaleString()),1)])):k("",!0)])]),t("div",Ls,[l(c,{color:"gray",block:"",onClick:s[3]||(s[3]=Z=>m.value=!1)},{default:E(()=>s[31]||(s[31]=[pe(" Close ")])),_:1})])])])]}),_:1},8,["modelValue"])],64)}}}),Es={class:"w-0 sidebar whitespace-nowrap relative transition-all duration-300"},Us={key:1,class:"h-full flex justify-center items-center text-xs text-gray-500"},Ms=re({__name:"ChartSidebar",props:$e({items:{}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:$e(["zoom","hoverbg"],["update:modelValue"]),setup(I,{emit:n}){const _=Se(I,"modelValue"),p=n;return(m,u)=>{const f=Rs;return a(),d("div",Es,[t("div",{class:Q([_.value?"w-96 p-2":"w-0 p-0","absolute h-full overflow-y-auto border-r-2 dark:border-gray-800 transition-all duration-300 z-0"])},[m.items.length>0?(a(),d(A,{key:0},[u[2]||(u[2]=Ge('<div class="flex justify-between items-center border-b-2 p-2 text-xs dark:border-gray-800"><div class="w-2"></div><div class="w-16 overflow-hidden italic font-bold uppercase text-center">ENTRY</div><div class="w-1 opacity-20">|</div><div class="w-16 overflow-hidden italic font-bold uppercase text-center">QTY</div><div class="w-1 opacity-20">|</div><div class="w-16 overflow-hidden italic font-bold uppercase text-center">PNL</div><div class="w-1 opacity-20">|</div><div class="w-8 overflow-hidden italic font-bold uppercase text-center"></div></div>',1)),(a(!0),d(A,null,se(m.items,(s,c)=>(a(),d("div",{key:c,class:"w-full"},[l(f,{trade:s,onZoom:u[0]||(u[0]=S=>p("zoom",S)),onHoverbg:u[1]||(u[1]=S=>p("hoverbg",S))},null,8,["trade"])]))),128))],64)):(a(),d("div",Us," No trades were executed "))],2)])}}}),Os={class:"w-full h-full flex justify-between border-2 border-gray-200 dark:border-gray-800 rounded-lg"},Bs={class:"w-full flex flex-col h-full border dark:border-gray-800"},Is={key:0},Ns=re({__name:"BacktestCandlesChart",props:$e({form:{},results:{}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:["update:modelValue"],setup(I){const n=Je(),_=w(2),p=Se(I,"modelValue"),m=I,u=w(),f=w([]);let s=null,c=null;const S=[],b=[],R=M(()=>Ye().params.id),$=M(()=>ee.extraChartLines[R.value].find(h=>h.symbol===m.results.selectedRoute.symbol)),g=M(()=>n.value),v=M(()=>X());W(g,h=>{x(h)}),W(()=>m.results.selectedRoute.symbol,()=>{L(),setTimeout(async()=>{await T()},100)}),Me(async()=>{setTimeout(async()=>{await T()},200)}),W(p,()=>{setTimeout(()=>{J()},300)});async function T(){var de,ue,ce,H;_e.width=u.value.clientWidth,_e.height=u.value.clientHeight-Object.keys($.value.charts).length*150,s=De(u.value,_e),s.applyOptions({rightPriceScale:{borderColor:g.value==="light"?"#d1d4dc":"#4b5563",minimumWidth:80},watermark:{visible:!0,fontSize:16,horzAlign:"left",vertAlign:"bottom",color:"#888",text:`${m.results.selectedRoute.symbol} • ${m.results.selectedRoute.timeframe}`}}),c=s.addCandlestickSeries();const h=ee.candles[R.value].find(j=>j.symbol===m.results.selectedRoute.symbol).candles;c.setData(h),c.setMarkers(ee.orders[R.value].find(j=>j.symbol===m.results.selectedRoute.symbol).orders);const C=String(h[0].open).indexOf("."),V=C===-1?0:String(h[h.length-1].open).length-C-1;_.value!==V&&(_.value=V,(_.value<0||_.value>100)&&(_.value=0),c.applyOptions({priceFormat:{type:"price",precision:_.value,minMove:Math.pow(10,-_.value).toFixed(_.value)}}));const O=(ue=(de=ee.lines[R.value])==null?void 0:de.find(j=>j.symbol===m.results.selectedRoute.symbol))==null?void 0:ue.lines;if(O)for(const j of Object.keys(O)){const B=O[j];s.addLineSeries({lineWidth:1,title:j}).setData(B.data)}const P=(H=(ce=ee.horizontalLines[R.value])==null?void 0:ce.find(j=>j.symbol===m.results.selectedRoute.symbol))==null?void 0:H.lines;if(P)for(const j of Object.keys(P)){const G=P[j];c.createPriceLine(G)}s.timeScale().fitContent();const le=new Set;Object.keys($.value.charts).forEach((j,B)=>{const G={..._e};G.width=f.value[B].clientWidth,G.height=150;const z=De(f.value[B],G);S.push(z),Object.keys($.value.charts[j]).forEach(D=>{var we,ye;const oe=z.addLineSeries({lineWidth:1,title:D}),ve=(ye=(we=ee.horizontalExtraLines[R.value])==null?void 0:we.find(be=>be.symbol===m.results.selectedRoute.symbol))==null?void 0:ye.lines[j];if(ve&&!le.has(j)){for(const be of Object.keys(ve)){const Te=ve[be];oe.createPriceLine(Te)}le.add(j)}oe.setData($.value.charts[j][D].data),b.push(oe)}),z.applyOptions({rightPriceScale:{borderColor:g.value==="light"?"#d1d4dc":"#4b5563",minimumWidth:80},watermark:{visible:!0,fontSize:16,horzAlign:"left",vertAlign:"bottom",color:"#888",text:j}}),z.timeScale().subscribeVisibleLogicalRangeChange(D=>{s.timeScale().setVisibleLogicalRange(D)}),B!==Object.keys($.value.charts).length-1&&z.timeScale().applyOptions({visible:!1})}),s.subscribeCrosshairMove(j=>{const B=q(c,j);Object.keys($.value.charts).forEach((G,z)=>{N(S[z],b[z],B)})}),Object.keys($.value.charts).forEach((j,B)=>{S[B].subscribeCrosshairMove(G=>{const z=q(b[B],G);N(s,c,z),S.forEach((D,oe)=>{oe!==B&&N(D,b[oe],z)})})}),s.timeScale().subscribeVisibleLogicalRangeChange(j=>{S.forEach(B=>{B.timeScale().setVisibleLogicalRange(j)})}),x(g.value),S.length>0&&s.timeScale().applyOptions({visible:!1})}function J(){var h;s!==null&&(s.applyOptions({width:(h=u.value)==null?void 0:h.clientWidth}),S.forEach(C=>{var V;C.applyOptions({width:(V=u.value)==null?void 0:V.clientWidth})}))}gt(()=>{L()});function q(h,C){return C.time&&C.seriesData.get(h)||null}function N(h,C,V){if(V){h.setCrosshairPosition(V.value,V.time,C);return}h.clearCrosshairPosition()}function L(){s!==null&&(s.remove(),s=null),c!==null&&(c=null),S.length>0&&(S.forEach(h=>{h.remove()}),S.length=0),b.length>0&&(b.length=0)}function x(h){s!==null&&(s.applyOptions(h==="light"?Fe.chart:Ae.chart),S.forEach(C=>{C.applyOptions(h==="light"?Fe.chart:Ae.chart)}))}function Z(h){const C=ee.orders[R.value].find(O=>O.symbol===m.results.selectedRoute.symbol).orders,V=C.find(O=>O.order_id===h);if(V&&s){const O=(typeof V.time=="number",V.time),P=s.timeScale(),le=C[1].time-C[0].time,de=O-le*5,ue=O+le*5,ce=V.color;c==null||c.setMarkers(C.map(H=>H.order_id===h?{...H,color:"#FFA500"}:H)),P.setVisibleRange({from:de,to:ue}),setTimeout(()=>{c==null||c.setMarkers(C.map(H=>H.order_id===h?{...H,color:ce}:H))},2e3)}}function ie(h){const C=ee.orders[R.value].find(O=>O.symbol===m.results.selectedRoute.symbol).orders,V=C.find(O=>O.order_id===h);if(V&&s){const O=V.color;c==null||c.setMarkers(C.map(P=>P.order_id===h?{...P,color:"#FFA500"}:P)),setTimeout(()=>{c==null||c.setMarkers(C.map(P=>P.order_id===h?{...P,color:O}:P))},2e3)}}function X(){return m.results.trades.filter(h=>h.symbol===m.results.selectedRoute.symbol)}return(h,C)=>(a(),d("div",Os,[l(Ms,{modelValue:p.value,"onUpdate:modelValue":C[0]||(C[0]=V=>p.value=V),items:r(v),onHoverbg:C[1]||(C[1]=V=>ie(V)),onZoom:C[2]||(C[2]=V=>Z(V))},null,8,["modelValue","items"]),t("div",{class:Q([[p.value?"w-[calc(100%-384px)]":"w-full"],"h-full transition-all duration-300"])},[t("div",Bs,[t("div",{ref_key:"chartContainer",ref:u,class:"rounded overflow-hidden flex-grow"},null,512),r($)&&Object.keys(r($).charts).length?(a(),d("div",Is,[(a(!0),d(A,null,se(Object.keys(r($).charts),V=>(a(),d("div",{key:V,ref_for:!0,ref_key:"extraChartsRef",ref:f,class:"relative border-t-[1.5px] dark:border-gray-800"}))),128))])):k("",!0)])],2)]))}}),Ps={key:0,class:"flex flex-col items-center justify-center select-none mt-[10%]"},zs=["textContent"],Ds={class:"mt-8"},Fs={class:"mt-8 flex flex-col gap-4"},As={key:0,class:"mt-4"},qs={key:1,class:"mx-auto container mt-8"},Hs={key:0},Ws={class:"mb-4 mt-4"},Js={class:"flex items-center select-none flex-1 my-4"},Gs={class:"grid grid-cols-1 gap-6 mt-8"},Ys={key:1,class:"w-full mx-auto"},Qs={class:"space-y-12"},Zs={key:0},Xs={key:1,class:"bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-lg overflow-hidden"},Ks={key:2,class:"text-yellow-500 border-yellow-400 bg-yellow-50 dark:bg-gray-700 dark:text-yellow-400 mt-16 text-center text-2xl rounded border-2 border-dashed dark:border-gray-800 py-16 select-none"},eo={class:"flex justify-start"},to={key:0,class:"flex h-[800px] border border-gray-200 dark:border-gray-800 rounded overflow-hidden"},so={class:"w-[460px] flex-shrink-0 border-r border-gray-200 dark:border-gray-800 bg-white dark:bg-gray-900"},oo={class:"flex items-center border-b border-gray-200 dark:border-gray-800 px-6 py-3 bg-gray-50 dark:bg-gray-900"},ro={class:"flex gap-16"},lo={class:"overflow-auto"},ao={class:"flex gap-12 flex-1"},no={class:"flex-1 bg-white dark:bg-gray-900"},io={key:0},uo={key:0},co=["href"],fo=["href"],mo=["href"],go={key:5,class:"my-4"},po={key:6,class:"mt-8 bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-lg overflow-hidden select-none"},vo={class:"px-6 py-4 space-y-3"},yo={class:"font-medium text-gray-500 dark:text-gray-400 whitespace-nowrap"},bo={class:"font-semibold text-gray-900 dark:text-gray-100 truncate ml-4"},ho={key:7,class:"mt-8 bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-lg overflow-hidden select-none"},wo={class:"px-6 py-4 space-y-4"},ko={class:"text-sm font-bold text-gray-900 dark:text-gray-100 truncate pr-2"},xo={class:"text-sm text-gray-500 dark:text-gray-400 truncate text-center px-2"},_o={class:"flex justify-end ml-auto"},$o={key:8,class:"mt-8 bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-lg overflow-hidden select-none"},Co={class:"px-6 py-4 space-y-3"},Vo={class:"font-medium text-gray-500 dark:text-gray-400 whitespace-nowrap"},So={class:"font-semibold text-gray-900 dark:text-gray-100 truncate ml-4"},To={key:9,class:"mt-8 bg-white dark:bg-gray-800 border dark:border-gray-700 rounded-lg overflow-hidden select-none"},jo={class:"px-6 py-4 border-b dark:border-gray-700 bg-gray-100 dark:bg-gray-700/50 flex justify-between items-center"},Lo={class:"text-xs font-bold text-gray-900 dark:text-gray-100 uppercase tracking-wider"},Ro={class:"px-6 py-4"},Eo={key:0,class:"text-sm text-gray-600 dark:text-gray-300 whitespace-pre-wrap"},Uo={key:1,class:"text-sm text-gray-400 dark:text-gray-500 italic text-center py-2"},Mo={key:1},Oo=re({__name:"BacktestTab",props:{form:{},results:{}},setup(I){const n=I,_=M(()=>n.results.generalInfo.title?`${n.results.generalInfo.title} - Backtest - Jesse`:"Backtest - Jesse");Ze({title:_});const p=w(!1),m=w(!1),u=w(!0),f=w(!1),s=w([]),c=w([]),S=w(!1),b=w(!1),R=Ee().authToken,$=w(pt().public.apiBaseUrl),g=w(!1),v=w(!1),T=w(!1),J=w(null),q=w(null),N=w(null),L=M(()=>Ye().params.id),x=Qe(),Z=Ee(),ie=vt(),X=w([]),h=M(()=>Z.jesseSupportedTimeframes.map(e=>({label:e,value:e}))),C=M(()=>n.form.routes.map(e=>({label:`${e.strategy} • ${e.symbol}`,value:e})));n.results.selectedRoute=n.form.routes[0],Me(async()=>{setTimeout(async()=>{await Z.initiate(),!n.form.exchange&&Z.backtestingExchangeNames.length&&(n.form.exchange=Z.backtestingExchangeNames[0]),(!n.results.showResults&&n.form.exchange||!X.value.length)&&await V()},50)});async function V(){if(n.form.exchange)try{X.value=await Z.getExchangeSupportedSymbols(n.form.exchange);for(let e=0;e<n.form.routes.length;e++)X.value.includes(n.form.routes[e].symbol)||(n.form.routes[e].symbol=X.value[0]);if(n.form.data_routes.length>0)for(let e=0;e<n.form.data_routes.length;e++)X.value.includes(n.form.data_routes[e].symbol)||(n.form.data_routes[e].symbol=X.value[0])}catch(e){console.error("Error updating supported symbols:",e)}}W(()=>n.form.exchange,async(e,o)=>{e!==o&&await V()}),W(v,async e=>{if(e){const o=await x.getSessionData(L.value);o&&(J.value=o.title||null,q.value=o.description||null,N.value=o.strategy_codes||null)}});function O(e){n.results.generalInfo.title=e.title||null,n.results.generalInfo.description=e.description||null}W(T,async e=>{if(e){const o=await x.getStrategyCode(L.value);o&&(N.value=o)}});const P=yt(()=>{n.results.executing||x.saveStateDraft(L.value)},1e3);W(()=>n.form,()=>{P()},{deep:!0});const{cancel:le,newBacktest:de,retry:ue}=x;function ce(e){if(c.value.length){for(let o=0;o<c.value.length;o++)Y("error",c.value[o]);return}s.value=[],x.start(e)}function H(e){s.value=[],x.rerun(e)}const j=e=>{if(c.value.length){for(let o=0;o<c.value.length;o++)Y("error",c.value[o]);return}s.value=[],x.startInNewTab(e)},B=M(()=>{let e=`/download/backtest/tradingview/${n.results.generalInfo.session_id}?token=${R}`;return $.value!=="/"&&(e=$.value+e),e});M(()=>{let e=`/download/backtest/full-reports/${n.results.generalInfo.session_id}?token=${R}`;return $.value!=="/"&&(e=$.value+e),e});const G=M(()=>{let e=`/download/backtest/csv/${n.results.generalInfo.session_id}?token=${R}`;return $.value!=="/"&&(e=$.value+e),e}),z=M(()=>{let e=`/download/backtest/json/${n.results.generalInfo.session_id}?token=${R}`;return $.value!=="/"&&(e=$.value+e),e}),D=M(()=>x.formattedMetrics(L.value).length>0),oe=M(()=>te.remainingTimeText(n.results.progressbar.estimated_remaining_seconds));function ve(){try{s.value.length>1e6&&Y("success","Copying large log file, please wait..."),setTimeout(()=>{navigator.clipboard.writeText(s.value.join(`
`)),Y("success","Logs copied successfully"),b.value=!0,setTimeout(()=>{b.value=!1},3e3)},0)}catch{Y("error","Failed to copy logs")}}async function we(){const e=x.missingCandlesErrors[L.value];e&&(ie.forms.push({id:te.uuid(),exchange:e.exchange,symbol:e.symbol,start_date:e.start_date,executing:!1,waiting:!1,progressbar:{current:0,estimated_remaining_seconds:0},exception:{error:"",traceback:""},alert:{message:"",type:""}}),await Ce("/candles/"),await ie.start(ie.forms[ie.forms.length-1].id))}async function ye(){s.value.length===0?await be():f.value=!0}async function be(){p.value=!0;try{const{data:e,error:o}=await Ct(`/backtest/logs/${L.value}?token=${R}`,!1);if(o.value){Y("error",o.value.message),p.value=!1;return}const je=e.value;setTimeout(()=>{const Re=te.decompressData(je.content).split(`
`).map(ke=>{const U=ke.match(/\[INFO \| (.*?)\] (.*)/);return U?`[${U[1]}] ${U[2]}`:ke});s.value=Re,p.value=!1,f.value=!0},0)}catch{Y("error","Failed to fetch logs"),p.value=!1}}async function Oe(){let e=`/backtest/download-log/${L.value}?token=${R}`;$.value!=="/"&&(e=$.value+e),window.open(e,"_blank")}async function Te(){if(g.value=!0,!ee.candles[L.value]){m.value=!0;const e=await x.loadChartData(L.value);if(m.value=!1,!e){Y("error","Failed to load chart data"),g.value=!1;return}}}return(e,o)=>{const je=Wt,Le=We,Re=wt,ke=Tt,U=Ve,Xe=Lt,Be=Rt,xe=kt,Ie=Et,Ke=Ut,Ne=xt,ae=_t,et=Mt,tt=$t,K=Ot,st=Gt,ot=Bt,rt=It,lt=Nt,at=ss;return a(),d(A,null,[l(Re,{modelValue:r(f),"onUpdate:modelValue":o[0]||(o[0]=i=>ne(f)?f.value=i:null),title:"Logs"},{default:E(()=>[l(je,{logs:r(s)},null,8,["logs"])]),buttons:E(()=>[l(Le,{text:"Copy",class:"inline-block",popper:{arrow:!0}},{default:E(()=>[t("button",{class:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 focus:outline-none",onClick:ve},[r(b)?(a(),F(r(bt),{key:0,class:"h-6 w-6","aria-hidden":"true"})):k("",!0),!r(b)&&r(s).length!=0?(a(),F(r(jt),{key:1,class:"h-6 w-6","aria-hidden":"true"})):k("",!0)])]),_:1}),l(Le,{text:"Download",class:"inline-block ml-2",popper:{arrow:!0}},{default:E(()=>[t("button",{class:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 focus:outline-none",onClick:Oe},[r(s).length!=0?(a(),F(r(ht),{key:0,class:"h-6 w-6","aria-hidden":"true"})):k("",!0)])]),_:1})]),_:1},8,["modelValue"]),e.results.executing&&!e.results.showResults?(a(),d("div",Ps,[t("div",null,[l(ke,{progress:e.results.progressbar.current},null,8,["progress"])]),e.results.exception.error?k("",!0):(a(),d("h3",{key:0,class:"mt-8 animate-pulse",textContent:y(r(oe))},null,8,zs)),t("div",Ds,[t("div",Fs,[e.results.exception.error?(a(),F(U,{key:0,color:"primary",class:"w-64 flex justify-center",icon:"i-heroicons-arrow-path",variant:"solid",label:"Retry",trailing:!1,onClick:o[1]||(o[1]=i=>r(ue)((e._.provides[me]||e.$route).params.id))})):k("",!0),l(U,{color:"gray",ui:{color:{gray:{soft:"text-rose-500 dark:text-rose-400"}}},class:"w-64 flex justify-center",icon:"i-heroicons-no-symbol",variant:"soft",label:"Cancel",trailing:!1,onClick:o[2]||(o[2]=i=>r(le)((e._.provides[me]||e.$route).params.id))})]),e.form.debug_mode&&e.results.exception.error?(a(),d("div",As,[l(U,{icon:"i-heroicons-clipboard-document-list",label:"Debugging Logs",color:"gray",variant:"solid",trailing:!1,class:"w-64 flex justify-center",onClick:ye})])):k("",!0)]),e.results.exception.error&&e.results.executing?(a(),d("div",qs,[l(Xe,{modelValue:r(S),"onUpdate:modelValue":o[3]||(o[3]=i=>ne(S)?S.value=i:null),title:e.results.exception.error,content:e.results.exception.traceback,mode:"backtest","debug-mode":e.form.debug_mode},null,8,["modelValue","title","content","debug-mode"])])):k("",!0)])):k("",!0),l(rt,null,{left:E(()=>[!e.results.executing&&!e.results.showResults?(a(),d("div",Hs,[r(x).missingCandlesErrors[r(L)]?(a(),F(Be,{key:0,icon:"i-heroicons-exclamation-triangle",color:"rose",variant:"soft",class:"mb-4"},{title:E(()=>o[29]||(o[29]=[t("h3",{class:"text-lg font-semibold"},"Missing Required Warmup Candles",-1)])),description:E(()=>[t("p",Ws,[o[30]||(o[30]=pe(" Your strategy requires ")),o[31]||(o[31]=t("strong",{class:"font-bold"},"warmup candles",-1)),pe(' for "'+y(r(x).missingCandlesErrors[r(L)].symbol)+'" on "'+y(r(x).missingCandlesErrors[r(L)].exchange)+'" starting from "'+y(r(x).missingCandlesErrors[r(L)].start_date)+'". These candles are needed for proper strategy initialization. ',1)]),l(U,{label:"Import Required Candles",icon:"i-heroicons-arrow-down-tray",onClick:we})]),_:1})):k("",!0),l(xe,{class:"mb-4",title:"Exchange"}),l(Ie,{modelValue:e.form.exchange,"onUpdate:modelValue":o[4]||(o[4]=i=>e.form.exchange=i),placeholder:"Select an exchange...",searchable:"",options:r(Ee)().backtestingExchangeNames,class:"mt-2 mb-16"},null,8,["modelValue","options"]),l(Ke,{"total-routes-error":r(c),timeframes:r(h),form:e.form,results:e.results,symbols:r(X),mode:"backtest"},null,8,["total-routes-error","timeframes","form","results","symbols"]),l(xe,{class:"mt-16",title:"Duration"}),t("div",Js,[l(Ne,{modelValue:e.form.start_date,"onUpdate:modelValue":o[5]||(o[5]=i=>e.form.start_date=i),type:"date",variant:"outline",class:"w-full mr-2"},null,8,["modelValue"]),l(Ne,{modelValue:e.form.finish_date,"onUpdate:modelValue":o[6]||(o[6]=i=>e.form.finish_date=i),type:"date",variant:"outline",class:"w-full ml-2"},null,8,["modelValue"])]),l(xe,{class:"mt-16",title:"Options"}),t("div",Gs,[l(ae,{modelValue:e.form.debug_mode,"onUpdate:modelValue":o[7]||(o[7]=i=>e.form.debug_mode=i),title:"Debug Mode",description:"Logs every step of the execution. Very helpful for debugging your strategy but takes a lot longer to execute"},null,8,["modelValue"]),l(ae,{modelValue:e.form.export_chart,"onUpdate:modelValue":o[8]||(o[8]=i=>e.form.export_chart=i),title:"Generate Interactive Charts",description:"Generate interactive charts for backtest results with details."},null,8,["modelValue"]),l(ae,{modelValue:e.form.export_tradingview,"onUpdate:modelValue":o[9]||(o[9]=i=>e.form.export_tradingview=i),title:"Export Tradingview",description:"Exports the executed trades in a format accepted by TradingView's Pine Editor. Useful to look at the executed orders on their chart."},null,8,["modelValue"]),l(ae,{modelValue:e.form.export_csv,"onUpdate:modelValue":o[10]||(o[10]=i=>e.form.export_csv=i),title:"Export CSV",description:"Exports executed trades in a CSV format"},null,8,["modelValue"]),l(ae,{modelValue:e.form.export_json,"onUpdate:modelValue":o[11]||(o[11]=i=>e.form.export_json=i),title:"Export JSON",description:"Exports executed trades in a JSON format"},null,8,["modelValue"]),l(ae,{modelValue:e.form.fast_mode,"onUpdate:modelValue":o[12]||(o[12]=i=>e.form.fast_mode=i),title:"Fast Mode",description:"Runs the backtest faster by using an improved algorithm. This is supposed to yield the same results; however, it's currently experimental, which is why it's an option."},null,8,["modelValue"]),l(ae,{modelValue:e.form.benchmark,"onUpdate:modelValue":o[13]||(o[13]=i=>e.form.benchmark=i),title:"Benchmark",description:"If enabled, the backtest will compare the performance of the strategy against the buy and hold strategy of the market."},null,8,["modelValue"])])])):k("",!0),e.results.showResults?(a(),d("div",Ys,[t("div",Qs,[r(D)?(a(),d("div",Zs,[l(xe,{class:"mb-4",title:"Equity Curve"}),l(et,{data:e.results.charts.equity_curve},null,8,["data"])])):k("",!0),r(D)?(a(),d("div",Xs,[o[32]||(o[32]=t("div",{class:"px-6 py-4 border-b dark:border-gray-700 bg-gray-100 dark:bg-gray-700/50"},[t("h3",{class:"text-xs font-bold text-gray-900 dark:text-gray-100 uppercase tracking-wider"},"Performance")],-1)),l(tt,{data:r(x).formattedMetrics(r(L)),"no-container":""},null,8,["data"])])):k("",!0),r(D)?k("",!0):(a(),d("div",Ks," No trades were executed via this strategy! "))]),l(st,{modelValue:r(g),"onUpdate:modelValue":o[17]||(o[17]=i=>ne(g)?g.value=i:null)},{title:E(()=>[t("div",eo,[l(Ie,{modelValue:e.results.selectedRoute,"onUpdate:modelValue":o[14]||(o[14]=i=>e.results.selectedRoute=i),"value-attribute":"value",options:r(C)},null,8,["modelValue","options"]),l(U,{class:"ml-2",color:"gray",label:r(u)?"Hide Trades":"Show Trades",onClick:o[15]||(o[15]=i=>u.value=!r(u))},null,8,["label"])])]),default:E(()=>[r(m)?(a(),d("div",to,[t("div",so,[t("div",oo,[t("div",ro,[l(K,{class:"h-4 w-12"}),l(K,{class:"h-4 w-12"}),l(K,{class:"h-4 w-12"})])]),t("div",lo,[(a(),d(A,null,se(14,i=>t("div",{key:i,class:"flex items-center px-4 py-3.5 border-b border-gray-200 dark:border-gray-800"},[l(K,{class:"h-4 w-4 mr-4"}),t("div",ao,[l(K,{class:"h-4 w-14"}),l(K,{class:"h-4 w-10"}),l(K,{class:"h-4 w-14"})]),l(K,{class:"h-7 w-7 rounded"})])),64))])]),t("div",no,[l(K,{class:"w-full h-full"})])])):(a(),F(Ns,{key:1,modelValue:r(u),"onUpdate:modelValue":o[16]||(o[16]=i=>ne(u)?u.value=i:null),results:e.results,form:e.form},null,8,["modelValue","results","form"]))]),_:1},8,["modelValue"])])):k("",!0)]),right:E(()=>[e.results.executing?k("",!0):(a(),d("div",io,[e.results.showResults?(a(),d("div",uo,[l(U,{class:"w-full flex justify-center",icon:"i-heroicons-arrow-path",variant:"solid",label:"Rerun",trailing:!1,onClick:o[18]||(o[18]=i=>H((e._.provides[me]||e.$route).params.id))}),l(U,{class:"w-full flex justify-center mt-4",color:"green",icon:"i-heroicons-arrow-uturn-left",variant:"soft",label:"New session",trailing:!1,onClick:o[19]||(o[19]=i=>r(de)((e._.provides[me]||e.$route).params.id))}),l(U,{class:"w-full flex justify-center mt-4",color:"gray",icon:"i-heroicons-code-bracket",variant:"soft",label:"View Strategy Snapshot",trailing:!1,onClick:o[20]||(o[20]=i=>T.value=!0)}),e.form.debug_mode?(a(),F(U,{key:0,class:"w-full flex justify-center mt-4",color:"gray",icon:"i-heroicons-clipboard-document-list",variant:"soft",label:"Debugging Logs",loading:r(p),trailing:!1,onClick:o[21]||(o[21]=i=>ye())},null,8,["loading"])):k("",!0),e.form.export_chart?(a(),F(U,{key:1,class:"mt-4 flex justify-center items-center btn-secondary text-center",color:"gray",icon:"i-heroicons-chart-bar",block:"",variant:"soft",label:"View charts",trailing:!1,onClick:o[22]||(o[22]=i=>Te())})):k("",!0),e.form.export_csv&&r(D)?(a(),d("a",{key:2,href:r(G),target:"_blank",class:"flex justify-center items-center btn-secondary text-center w-full"},[l(U,{class:"w-full flex justify-center mt-4",color:"gray",icon:"i-heroicons-document-arrow-down",variant:"soft",label:"CSV",trailing:!1})],8,co)):k("",!0),e.form.export_json&&r(D)?(a(),d("a",{key:3,href:r(z),target:"_blank",class:"flex justify-center items-center btn-secondary text-center w-full"},[l(U,{class:"w-full flex justify-center mt-4",color:"gray",icon:"i-heroicons-document-arrow-down",variant:"soft",label:"JSON",trailing:!1})],8,fo)):k("",!0),e.form.export_tradingview&&r(D)?(a(),d("a",{key:4,href:r(B),target:"_blank",class:"flex justify-center items-center btn-secondary text-center mb-4 w-full"},[l(U,{class:"w-full flex justify-center mt-4",color:"gray",icon:"i-heroicons-document-arrow-down",variant:"soft",label:"TradingView Pine Editor",trailing:!1})],8,mo)):k("",!0),e.results.showResults&&e.results.alert&&e.results.alert.message?(a(),d("div",go,[l(Be,{color:"teal",icon:"i-heroicons-check-circle",variant:"soft",title:e.results.alert.message,"close-button":{icon:"i-heroicons-x-mark-20-solid",color:"white",variant:"link"},onClose:o[23]||(o[23]=i=>e.results.alert.message="")},null,8,["title"])])):k("",!0),e.results.info&&e.results.info.length?(a(),d("div",po,[o[33]||(o[33]=t("div",{class:"px-6 py-4 border-b dark:border-gray-700 bg-gray-100 dark:bg-gray-700/50"},[t("h3",{class:"text-xs font-bold text-gray-900 dark:text-gray-100 uppercase tracking-wider"},"General Info")],-1)),t("dl",vo,[(a(!0),d(A,null,se(e.results.info,(i,he)=>(a(),d("div",{key:he,class:"flex justify-between items-center text-sm"},[t("dt",yo,y(i[0])+":",1),t("dd",bo,y(i[1]),1)]))),128))])])):k("",!0),e.results.routes_info&&e.results.routes_info.length?(a(),d("div",ho,[o[34]||(o[34]=t("div",{class:"px-6 py-4 border-b dark:border-gray-700 bg-gray-100 dark:bg-gray-700/50"},[t("h3",{class:"text-xs font-bold text-gray-900 dark:text-gray-100 uppercase tracking-wider"},"Routes")],-1)),t("div",wo,[(a(!0),d(A,null,se(e.results.routes_info,(i,he)=>(a(),d("div",{key:he,class:"grid grid-cols-3 items-center"},[t("div",ko,y(i[2].value),1),t("div",xo,y(i[0].value),1),t("div",_o,[l(ot,{color:"gray",variant:"soft",size:"xs"},{default:E(()=>[pe(y(i[1].value),1)]),_:2},1024)])]))),128))])])):k("",!0),e.results.hyperparameters&&e.results.hyperparameters.length?(a(),d("div",$o,[o[35]||(o[35]=t("div",{class:"px-6 py-4 border-b dark:border-gray-700 bg-gray-100 dark:bg-gray-700/50"},[t("h3",{class:"text-xs font-bold text-gray-900 dark:text-gray-100 uppercase tracking-wider"},"Hyperparameters")],-1)),t("dl",Co,[(a(!0),d(A,null,se(e.results.hyperparameters,(i,he)=>(a(),d("div",{key:he,class:"flex justify-between items-center text-sm"},[t("dt",Vo,y(i[0])+":",1),t("dd",So,y(i[1]),1)]))),128))])])):k("",!0),e.results.showResults?(a(),d("div",To,[t("div",jo,[t("h3",Lo,y(e.results.generalInfo.title||"Session Notes"),1),l(U,{variant:"link",color:"gray",icon:"i-heroicons-pencil-square",onClick:o[24]||(o[24]=i=>v.value=!0)})]),t("div",Ro,[e.results.generalInfo.description?(a(),d("div",Eo,y(e.results.generalInfo.description),1)):(a(),d("div",Uo," No notes yet. Click the edit button to add notes. "))])])):k("",!0)])):(a(),d("div",Mo,[l(U,{class:"w-full flex justify-center",icon:"i-heroicons-bolt",variant:"solid",label:"Start",trailing:!1,onClick:o[25]||(o[25]=i=>ce((e._.provides[me]||e.$route).params.id))}),l(U,{class:"w-full flex justify-center mt-4",color:"gray",icon:"i-heroicons-plus",variant:"soft",label:"Start in a new tab",trailing:!1,onClick:o[26]||(o[26]=i=>j((e._.provides[me]||e.$route).params.id))})]))]))]),_:1}),l(lt,{modelValue:r(v),"onUpdate:modelValue":o[27]||(o[27]=i=>ne(v)?v.value=i:null),"session-id":r(L),"initial-title":r(J),"initial-description":r(q),onSaved:O},null,8,["modelValue","session-id","initial-title","initial-description"]),l(at,{modelValue:r(T),"onUpdate:modelValue":o[28]||(o[28]=i=>ne(T)?T.value=i:null),routes:n.form.routes,exchange:n.form.exchange,"strategy-codes":r(N)},null,8,["modelValue","routes","exchange","strategy-codes"])],64)}}}),Bo={class:"w-full"},sr=re({__name:"[id]",setup(I){Ze({title:"Backtest - Jesse"});const n=Qe(),_=Vt(),p=M(()=>n.tabs),m=M(()=>_.params.id),u=M(()=>p.value[m.value]);return St(()=>{const f=m.value;if(!f||u.value||!n.recentlyClosedTabIds.includes(f))return;const s=n.recentlyClosedRedirectTargets[f]||n.tabIds[0];s&&Ce(`/backtest/${s}`)}),n.tabIds.length===0&&n.addTab(),Me(()=>{setTimeout(async()=>{!u.value&&m.value&&(await n.loadSession(m.value)||(n.tabIds.length>0?await Ce(`/backtest/${n.tabIds[0]}`):await n.addTab()))},20)}),zt({w:()=>{u.value&&n.closeTab(u.value.id,_.path)},ArrowLeft:()=>n.goToPrevTab(m.value),ArrowRight:()=>n.goToNextTab(m.value)}),(f,s)=>{const c=nt,S=Oo;return a(),d(A,null,[t("div",Bo,[l(c,{"current-tab":u.value?u.value.id:null,tabs:p.value,onClose:s[0]||(s[0]=b=>r(n).closeTab(b,r(_).path)),onCancel:r(n).cancel},null,8,["current-tab","tabs","onCancel"])]),u.value?(a(),F(S,{key:0,form:u.value.form,results:u.value.results},null,8,["form","results"])):k("",!0)],64)}}});export{sr as default};
