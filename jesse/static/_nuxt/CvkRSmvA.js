import{_ as fe}from"./Dr_JbmT0.js";import{d as ye,A as be,r as _,c,w as K,B as me,C as u,i as d,j as s,x as o,E as N,f as j,G as n,F as Z,O as pe,H as I,q as w,D as Q,t as he,aa as ve,g,ac as _e,s as X}from"./CU_MfyYc.js";import{_ as we}from"./s0YP2YF7.js";import{_ as ke}from"./DPg46dy1.js";import{u as Se}from"./Cwg39VG_.js";import{u as Ce}from"./X3S5orim.js";import"./C6794tGI.js";import"./9VOnL4Iz.js";import"./Cw4FHd9N.js";import"./BuljS_lV.js";import"./DP9I38t9.js";const Ae={class:"bg-gray-50 dark:bg-transparent min-h-screen pb-12"},je={class:"container mx-auto px-4 pt-16 pb-6 max-w-7xl"},Fe={class:"mb-6"},Te={class:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6"},Ne={class:"flex gap-3 flex-wrap"},Ie={class:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-4"},Be={class:"bg-white dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl p-5 flex flex-col justify-between shadow-sm"},qe={class:"flex items-center justify-between mb-3"},Ee={class:"text-3xl font-bold text-gray-900 dark:text-gray-100 leading-none"},Le={class:"bg-white dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl p-5 flex flex-col justify-between shadow-sm"},Oe={class:"flex items-center justify-between mb-3"},Ve={class:"text-3xl font-bold text-gray-900 dark:text-gray-100 leading-none"},$e={class:"bg-white dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl p-5 flex flex-col justify-between shadow-sm"},De={class:"flex items-center justify-between mb-3"},Pe={class:"text-3xl font-bold text-gray-900 dark:text-gray-100 leading-none"},Re={class:"bg-white dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl p-5 flex flex-col justify-between shadow-sm"},Me={class:"flex items-center justify-between mb-3"},Ue={class:"text-3xl font-bold text-gray-900 dark:text-gray-100 leading-none"},We={key:0,class:"flex items-center gap-2 mb-4"},ze={class:"flex gap-2"},Ge=["onClick"],He={class:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-4"},Je={class:"bg-white dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl p-5 flex flex-col justify-between shadow-sm"},Ke={class:"flex items-center justify-between mb-3"},Ze={class:"text-sm font-semibold ml-1 opacity-70"},Qe={key:1,class:"text-2xl font-bold text-gray-400 leading-none"},Xe={class:"bg-white dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl p-5 flex flex-col justify-between shadow-sm"},Ye={class:"flex items-center justify-between mb-3"},et={key:1,class:"text-2xl font-bold text-gray-400 leading-none"},tt={class:"bg-white dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl p-5 flex flex-col justify-between shadow-sm"},st={class:"flex items-center justify-between mb-3"},rt={key:0,class:"text-2xl font-bold text-gray-900 dark:text-gray-100 leading-none"},ot={class:"text-sm font-semibold ml-1 opacity-50"},at={key:1,class:"text-2xl font-bold text-gray-400 leading-none"},nt={class:"bg-white dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl p-5 flex flex-col justify-between shadow-sm"},lt={class:"flex items-center justify-between mb-3"},it={key:0,class:"leading-none"},dt={class:"text-2xl font-bold text-gray-900 dark:text-gray-100"},ct={class:"text-sm font-semibold ml-1 opacity-50"},ut={class:"text-xs text-gray-500 dark:text-gray-400 mt-1.5"},gt={key:1,class:"text-2xl font-bold text-gray-400 leading-none"},xt={class:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8"},ft={class:"bg-white dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl p-5 flex flex-col justify-between shadow-sm"},yt={class:"flex items-center justify-between mb-3"},bt={class:"text-3xl font-bold text-gray-900 dark:text-gray-100 leading-none"},mt={class:"bg-white dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl p-5 flex flex-col justify-between shadow-sm"},pt={class:"flex items-center justify-between mb-3"},ht={class:"text-3xl font-bold text-gray-900 dark:text-gray-100 leading-none"},vt={class:"bg-white dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl p-5 flex flex-col justify-between shadow-sm"},_t={class:"flex items-center justify-between mb-3"},wt={class:"text-3xl font-bold text-gray-900 dark:text-gray-100 leading-none"},kt={class:"bg-white dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl p-5 flex flex-col justify-between shadow-sm"},St={class:"flex items-center justify-between mb-3"},Ct={key:0,class:"leading-none"},At={class:"text-xs text-gray-500 dark:text-gray-400 mt-1.5"},jt={key:1,class:"text-3xl font-bold text-gray-400 leading-none"},Ft={key:0,class:"mb-8"},Tt={class:"bg-white dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl p-6 shadow-sm"},Nt={key:0},It={key:0,class:"mt-4 text-sm text-gray-500 dark:text-gray-400 italic"},Bt={key:1,class:"text-center py-12 text-gray-500 dark:text-gray-400 text-sm"},qt={key:1},Et={key:2,class:"text-center py-20 bg-white dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-lg shadow-sm"},Ht=ye({__name:"overview",setup(Lt){Se({title:"Overview - Jesse"});const f=be(),k=_(!1),S=_(!1),F=_(!1),T=_(!1),b=_("USD"),v=_(new Set),m=c(()=>Object.values(f.tabs)),M=c(()=>m.value.length),x=c(()=>m.value.filter(e=>e.results.phase==="running"));c(()=>m.value.filter(e=>e.results.phase==="starting"));const Y=c(()=>m.value.filter(e=>e.results.phase==="editing")),ee=c(()=>m.value.filter(e=>["ended","error","stopping"].includes(e.results.phase))),B=c(()=>m.value.filter(e=>["running","starting"].includes(e.results.phase))),q=c(()=>m.value.filter(e=>["editing","ended"].includes(e.results.phase))),U=["#818CF8","#34D399","#FBBF24","#F87171","#A78BFA","#60A5FA","#FB923C","#2DD4BF","#FB7185","#C084FC","#4ADE80","#FACC15"];function te(e,t){let r=0;for(let l=0;l<e.length;l++)r=(r<<5)-r+e.charCodeAt(l),r=r&r;return Math.abs(r)%t}function se(e){return U[te(e,U.length)]}function E(e){var l,a,i;const t=(i=(a=(l=e.results.charts)==null?void 0:l.equity_curve)==null?void 0:a[0])==null?void 0:i.name;if(!t)return null;const r=t.match(/\(([A-Z]+)\)/);return r?r[1]:null}function re(e){var l,a,i;if((l=e.results.generalInfo)!=null&&l.title)return e.results.generalInfo.title;const t=e.form.exchange||((a=e.results.generalInfo)==null?void 0:a.exchange)||"",r=(i=e.form.routes)==null?void 0:i[0];return r?`${t} ${r.symbol} ${r.timeframe}`:e.id.substring(0,8)}const L=c(()=>{const e=new Set;for(const t of x.value){const r=E(t);r&&e.add(r)}return Array.from(e).sort()}),p=c(()=>x.value.filter(e=>E(e)===b.value)),O=c(()=>p.value.reduce((e,t)=>{var r;return e+(Number((r=t.results.generalInfo)==null?void 0:r.pnl)||0)},0)),C=c(()=>p.value.reduce((e,t)=>{var r;return e+(Number((r=t.results.generalInfo)==null?void 0:r.started_balance)||0)},0)),V=c(()=>p.value.reduce((e,t)=>{var r;return e+(Number((r=t.results.generalInfo)==null?void 0:r.current_balance)||0)},0)),$=c(()=>C.value===0?0:(V.value-C.value)/C.value*100),oe=c(()=>x.value.reduce((e,t)=>{var r;return e+(Number((r=t.results.generalInfo)==null?void 0:r.open_positions)||0)},0)),ae=c(()=>x.value.reduce((e,t)=>{var r;return e+(Number((r=t.results.generalInfo)==null?void 0:r.count_active_orders)||0)},0)),D=c(()=>x.value.reduce((e,t)=>{var r;return e+(Number((r=t.results.generalInfo)==null?void 0:r.count_trades)||0)},0)),W=c(()=>x.value.reduce((e,t)=>{var r;return e+(Number((r=t.results.generalInfo)==null?void 0:r.count_winning_trades)||0)},0)),ne=c(()=>x.value.reduce((e,t)=>{var r;return e+(Number((r=t.results.generalInfo)==null?void 0:r.count_losing_trades)||0)},0)),P=c(()=>D.value===0?null:W.value/D.value*100);function z(e){return e>0?"text-green-600 dark:text-green-400":e<0?"text-red-600 dark:text-red-400":"text-gray-900 dark:text-gray-100"}function le(e){return e>=55?"text-green-600 dark:text-green-400":e>=45?"text-gray-900 dark:text-gray-100":"text-red-600 dark:text-red-400"}const R=c(()=>{var r,l,a;const e=p.value.slice().sort((i,h)=>i.id.localeCompare(h.id)),t=[];for(const i of e){const h=(l=(r=i.results.charts)==null?void 0:r.equity_curve)==null?void 0:l[0];if(!((a=h==null?void 0:h.data)!=null&&a.length))continue;const A=se(i.id),y=h.data.map(J=>({...J,color:A}));t.push({name:re(i),color:A,data:y})}return t});K(L,e=>{if(e.length>0&&!e.includes(b.value)){const t=new Map;for(const a of x.value){const i=E(a);i&&t.set(i,(t.get(i)||0)+1)}let r=e[0],l=0;for(const[a,i]of t)i>l&&(l=i,r=a);b.value=r}},{immediate:!0}),K(()=>x.value.map(e=>e.id).sort().join(","),async(e,t)=>{if(e===t)return;const r=new Set(x.value.map(a=>a.id)),l=Array.from(r).filter(a=>!v.value.has(a));for(const a of l){v.value.add(a);try{await f.fetchEquityCurve(a,"auto")}catch(i){console.error(`Failed to fetch equity curve for session ${a}:`,i)}}for(const a of v.value)r.has(a)||v.value.delete(a)}),me(async()=>{for(const e of x.value)if(!v.value.has(e.id)){v.value.add(e.id);try{await f.fetchEquityCurve(e.id,"auto")}catch(t){console.error(`Failed to fetch equity curve for session ${e.id}:`,t)}}});function ie(){if(q.value.length===0){X("info","No sessions to start");return}k.value=!0}function de(){if(B.value.length===0){X("info","No running sessions to stop");return}S.value=!0}async function ce(){k.value=!1,F.value=!0;try{await f.startAll()}finally{F.value=!1}}async function ue(){S.value=!1,T.value=!0;try{await f.stopAll()}finally{T.value=!1}}async function ge(e){await f.rerunAndStart(e,{navigate:!1})}function G(e){f.openStopConfirmModal(e)}function H(e){f.closeTab(e)}function xe(){f.addTab()}return Ce({ArrowLeft:()=>f.goToPrevTab(null),ArrowRight:()=>f.goToNextTab(null)}),(e,t)=>{const r=fe,l=he,a=_e,i=we,h=ke,A=ve;return g(),u("div",Ae,[d(r,{"current-tab":null,tabs:o(f).tabs,onClose:H,onCancel:G},null,8,["tabs"]),s("div",je,[s("div",Fe,[s("div",Te,[t[2]||(t[2]=s("h1",{class:"text-2xl font-bold text-gray-900 dark:text-gray-100"}," Overview ",-1)),s("div",Ne,[d(l,{disabled:o(q).length===0||o(F),loading:o(F),icon:"i-heroicons-play",onClick:ie},{default:j(()=>[w(" Start All ("+n(o(q).length)+") ",1)]),_:1},8,["disabled","loading"]),d(l,{disabled:o(B).length===0||o(T),loading:o(T),color:"rose",icon:"i-heroicons-stop",onClick:de},{default:j(()=>[w(" Stop All Running ("+n(o(B).length)+") ",1)]),_:1},8,["disabled","loading"])])]),s("div",Ie,[s("div",Be,[s("div",qe,[t[3]||(t[3]=s("span",{class:"text-xs text-gray-500 dark:text-gray-400 uppercase font-bold tracking-wider"},"Total Sessions",-1)),d(a,{name:"i-heroicons-squares-2x2",class:"w-5 h-5 text-gray-400"})]),s("div",Ee,n(o(M)),1)]),s("div",Le,[s("div",Oe,[t[4]||(t[4]=s("span",{class:"text-xs text-gray-500 dark:text-gray-400 uppercase font-bold tracking-wider"},"Running",-1)),d(a,{name:"i-heroicons-play-circle",class:"w-6 h-6 text-gray-400"})]),s("div",Ve,n(o(x).length),1)]),s("div",$e,[s("div",De,[t[5]||(t[5]=s("span",{class:"text-xs text-gray-500 dark:text-gray-400 uppercase font-bold tracking-wider"},"Drafts",-1)),d(a,{name:"i-heroicons-pencil-square",class:"w-5 h-5 text-gray-400"})]),s("div",Pe,n(o(Y).length),1)]),s("div",Re,[s("div",Me,[t[6]||(t[6]=s("span",{class:"text-xs text-gray-500 dark:text-gray-400 uppercase font-bold tracking-wider"},"Ended/Error",-1)),d(a,{name:"i-heroicons-stop-circle",class:"w-6 h-6 text-gray-400"})]),s("div",Ue,n(o(ee).length),1)])]),o(x).length>0?(g(),u(Z,{key:0},[o(L).length>1?(g(),u("div",We,[t[7]||(t[7]=s("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"Currency:",-1)),s("div",ze,[(g(!0),u(Z,null,pe(o(L),y=>(g(),u("button",{key:y,class:I(["px-3 py-1.5 text-xs font-semibold rounded-lg transition-colors duration-200",[o(b)===y?"bg-primary-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"]]),onClick:J=>b.value=y},n(y),11,Ge))),128))])])):N("",!0),s("div",He,[s("div",Je,[s("div",Ke,[t[8]||(t[8]=s("span",{class:"text-xs text-gray-500 dark:text-gray-400 uppercase font-bold tracking-wider"},"Total P&L",-1)),d(a,{name:"i-heroicons-banknotes",class:"w-5 h-5 text-gray-400"})]),o(p).length>0?(g(),u("div",{key:0,class:I(["text-2xl font-bold leading-none",z(o(O))])},[w(n(o(O)>=0?"+":"")+n(o(O).toFixed(2))+" ",1),s("span",Ze,n(o(b)),1)],2)):(g(),u("div",Qe,"—"))]),s("div",Xe,[s("div",Ye,[t[9]||(t[9]=s("span",{class:"text-xs text-gray-500 dark:text-gray-400 uppercase font-bold tracking-wider"},"P&L %",-1)),d(a,{name:"i-heroicons-arrow-trending-up",class:"w-5 h-5 text-gray-400"})]),o(p).length>0&&o(C)>0?(g(),u("div",{key:0,class:I(["text-2xl font-bold leading-none",z(o($))])},n(o($)>=0?"+":"")+n(o($).toFixed(2))+"% ",3)):(g(),u("div",et,"—"))]),s("div",tt,[s("div",st,[t[10]||(t[10]=s("span",{class:"text-xs text-gray-500 dark:text-gray-400 uppercase font-bold tracking-wider"},"Current Balance",-1)),d(a,{name:"i-heroicons-wallet",class:"w-5 h-5 text-gray-400"})]),o(p).length>0?(g(),u("div",rt,[w(n(o(V).toFixed(2))+" ",1),s("span",ot,n(o(b)),1)])):(g(),u("div",at,"—"))]),s("div",nt,[s("div",lt,[t[11]||(t[11]=s("span",{class:"text-xs text-gray-500 dark:text-gray-400 uppercase font-bold tracking-wider"},"Started Balance",-1)),d(a,{name:"i-heroicons-scale",class:"w-5 h-5 text-gray-400"})]),o(p).length>0?(g(),u("div",it,[s("div",dt,[w(n(o(C).toFixed(2))+" ",1),s("span",ct,n(o(b)),1)]),s("div",ut," Current: "+n(o(V).toFixed(2))+" "+n(o(b)),1)])):(g(),u("div",gt,"—"))])]),s("div",xt,[s("div",ft,[s("div",yt,[t[12]||(t[12]=s("span",{class:"text-xs text-gray-500 dark:text-gray-400 uppercase font-bold tracking-wider"},"Open Positions",-1)),d(a,{name:"i-heroicons-arrow-path",class:"w-5 h-5 text-gray-400"})]),s("div",bt,n(o(oe)),1)]),s("div",mt,[s("div",pt,[t[13]||(t[13]=s("span",{class:"text-xs text-gray-500 dark:text-gray-400 uppercase font-bold tracking-wider"},"Open Orders",-1)),d(a,{name:"i-heroicons-queue-list",class:"w-5 h-5 text-gray-400"})]),s("div",ht,n(o(ae)),1)]),s("div",vt,[s("div",_t,[t[14]||(t[14]=s("span",{class:"text-xs text-gray-500 dark:text-gray-400 uppercase font-bold tracking-wider"},"Total Trades",-1)),d(a,{name:"i-heroicons-chart-bar",class:"w-5 h-5 text-gray-400"})]),s("div",wt,n(o(D)),1)]),s("div",kt,[s("div",St,[t[15]||(t[15]=s("span",{class:"text-xs text-gray-500 dark:text-gray-400 uppercase font-bold tracking-wider"},"Win Rate",-1)),d(a,{name:"i-heroicons-trophy",class:"w-5 h-5 text-gray-400"})]),o(P)!==null?(g(),u("div",Ct,[s("div",{class:I(["text-3xl font-bold",le(o(P))])},n(o(P).toFixed(1))+"% ",3),s("div",At,n(o(W))+"W / "+n(o(ne))+"L ",1)])):(g(),u("div",jt,"—"))])])],64)):N("",!0)]),o(x).length>0?(g(),u("div",Ft,[s("div",Tt,[t[16]||(t[16]=s("div",{class:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6"},[s("h2",{class:"text-lg font-bold text-gray-900 dark:text-gray-100"}," Equity Comparison ")],-1)),o(R).length>0?(g(),u("div",Nt,[d(i,{data:o(R)},null,8,["data"]),o(R).length===1?(g(),u("div",It," This chart is designed to compare multiple sessions simultaneously. For a detailed view of this single session, visit its individual tab instead. ")):N("",!0)])):(g(),u("div",Bt," No equity data yet. Charts will appear shortly after sessions start collecting balance snapshots. "))])])):N("",!0),o(M)>0?(g(),u("div",qt,[d(h,{sessions:o(m),onStart:ge,onStop:G,onClose:H},null,8,["sessions"])])):(g(),u("div",Et,[t[18]||(t[18]=s("div",{class:"text-gray-500 dark:text-gray-400 text-lg mb-6"}," No live sessions found ",-1)),d(l,{size:"lg",variant:"solid",icon:"i-heroicons-plus",onClick:xe},{default:j(()=>t[17]||(t[17]=[w(" Create New Session ")])),_:1})]))]),d(A,{modelValue:o(k),"onUpdate:modelValue":t[0]||(t[0]=y=>Q(k)?k.value=y:null),title:"Start All Sessions",description:"Are you sure you want to start all eligible sessions? This includes both drafts and ended sessions that don't have errors.",type:"info"},{default:j(()=>[d(l,{variant:"solid",color:"green",block:"",class:"sm:w-auto",label:"Start All",onClick:ce})]),_:1},8,["modelValue"]),d(A,{modelValue:o(S),"onUpdate:modelValue":t[1]||(t[1]=y=>Q(S)?S.value=y:null),title:"Stop All Running Sessions",description:"Are you sure you want to terminate all running sessions? This will stop all active trading.",type:"info"},{default:j(()=>[d(l,{variant:"solid",color:"red",block:"",class:"sm:w-auto",label:"Stop All",onClick:ue})]),_:1},8,["modelValue"])])}}});export{Ht as default};
