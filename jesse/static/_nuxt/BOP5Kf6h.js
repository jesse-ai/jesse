import{_ as Ne}from"./DXi_Mqan.js";import{d as de,a as ce,c as b,B as M,r as w,w as O,H as me,F as Ue,z as c,g as n,G as v,j as a,L as f,bj as Fe,ak as Ae,bk as Ee,I as H,J as Y,y as Ie,P as K,n as We,$ as I,i as l,f as k,bc as He,_ as Be,e as U,W as u,t as Pe,Q,Z,a8 as qe,bd as Je,k as Ge,q as X,av as Ke,aw as Qe,bf as y,v as Ze,l as Xe,p as Ye,s as F,h as et}from"./8ZlRMPDN.js";import{_ as tt}from"./CYV3TNj3.js";import{_ as at,a as st}from"./DLRjEvkz.js";import{T as ot}from"./xgbdnDAz.js";import{s as lt,l as nt,d as it,_ as rt}from"./B-tuDgje.js";import{_ as ut}from"./DdCwzkd1.js";import{_ as dt}from"./z0m1xUwO.js";import{_ as ct}from"./BlChX9ZV.js";import{a as mt}from"./DrSmnAZe.js";import{_ as gt}from"./DHAvmtGm.js";import{_ as vt}from"./DOckPrcM.js";import{u as ft}from"./DBmZx7Jq.js";import{r as pt,a as _t}from"./wcSeMKD4.js";import"./9YaUKXEU.js";const yt={key:0,class:"mb-2 p-3 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-200 rounded-md"},bt={class:"text-sm font-medium"},xt={class:"mt-2 flex items-center justify-between"},ht={class:"flex items-center"},kt=["value"],wt=de({__name:"ObjectiveCurveChart",props:{data:{}},setup(ae){const W=ce(),i=b(()=>W.value),o=M(),j=w(null),$=ae,A=b(()=>{const r=o.results.generalInfo.find(C=>C[0]==="Objective Function");return r?{sharpe:"sharpe_ratio",calmar:"calmar_ratio",sortino:"sortino_ratio",omega:"omega_ratio",serenity:"serenity_index","smart sharpe":"smart_sharpe","smart sortino":"smart_sortino"}[r[1].toLowerCase()]||r[1].toLowerCase():"sharpe_ratio"}),T=w(null);let m=null,p=null,S=null;const B=b(()=>$.data.length>0&&$.data[0].training?Object.keys($.data[0].training):[]),h=b({get:()=>o.results.selectedObjectiveMetric,set:r=>{o.results.selectedObjectiveMetric=r}});O(B,r=>{if(!o.results.selectedObjectiveMetric&&r.length){const d=A.value;r.includes(d)?h.value=d:h.value=r[0]}},{immediate:!0});const P=b(()=>$.data.map(d=>({trial:d.trial,training:d.training[h.value]!==void 0?d.training[h.value]:null,testing:d.testing[h.value]!==void 0?d.testing[h.value]:null})));function ee(){if(T.value)try{j.value=null;const r={...lt,width:T.value.clientWidth,height:300,timeScale:{timeVisible:!1,secondsVisible:!1,tickMarkFormatter:d=>Math.floor(d)},localization:{timeFormatter:d=>Math.floor(d)}};m=ot(T.value,r),p=m.addLineSeries({color:"#60A5FA",lineWidth:2,title:"Training"}),S=m.addLineSeries({color:"#F87171",lineWidth:2,title:"Testing"}),L(i.value),D()}catch(r){E(r)}}function D(){if(!(!p||!S))try{j.value=null;const r=P.value.sort((x,te)=>x.trial-te.trial),d=r.filter(x=>x.training!==null).map(x=>({time:x.trial,value:x.training})),C=r.filter(x=>x.testing!==null).map(x=>({time:x.trial,value:x.testing}));p.setData(d),S.setData(C),m==null||m.timeScale().fitContent()}catch(r){E(r)}}function E(r){console.error("Chart error:",r),j.value=`Failed to render chart: ${r.message||"Unknown error"}`,m&&(m.remove(),m=null,p=null,S=null)}function L(r){if(m)try{m.applyOptions(r==="light"?nt.chart:it.chart)}catch(d){E(d)}}function R(){if(m&&T.value)try{m.applyOptions({width:T.value.clientWidth})}catch(r){E(r)}}me(()=>{ee(),window.addEventListener("resize",R)}),Ue(()=>{m&&(m.remove(),m=null),window.removeEventListener("resize",R)}),O(P,D),O(h,D),O(i,L);function q(r){return r.replace(/_/g," ").toUpperCase()}return(r,d)=>(n(),c("div",null,[j.value?(n(),c("div",yt,[a("p",bt,f(j.value),1)])):v("",!0),a("div",{ref_key:"chartContainer",ref:T,class:"rounded overflow-hidden border-2 border-gray-100 dark:border-gray-600",style:{"min-height":"300px"}},null,512),a("div",xt,[d[2]||(d[2]=Fe('<div class="flex items-center" data-v-a7d13feb><span class="text-xs mr-2 rounded bg-white dark:bg-gray-700 p-1" data-v-a7d13feb><span class="inline-block" style="background-color:#60A5FA;width:25px;height:10px;" data-v-a7d13feb></span><span class="ml-2" data-v-a7d13feb>Training</span></span><span class="text-xs mr-2 rounded bg-white dark:bg-gray-700 p-1" data-v-a7d13feb><span class="inline-block" style="background-color:#F87171;width:25px;height:10px;" data-v-a7d13feb></span><span class="ml-2" data-v-a7d13feb>Testing</span></span></div>',1)),a("div",ht,[d[1]||(d[1]=a("label",{class:"text-sm text-gray-700 dark:text-gray-300 mr-2"},"Metric:",-1)),Ae(a("select",{"onUpdate:modelValue":d[0]||(d[0]=C=>h.value=C),class:"text-sm py-1 px-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-800"},[(n(!0),c(H,null,Y(B.value,C=>(n(),c("option",{key:C,value:C},f(q(C)),9,kt))),128))],512),[[Ee,h.value]])])])]))}}),Tt=Ie(wt,[["__scopeId","data-v-a7d13feb"]]),Ct=Ye(vt),$t={key:0,class:"mb-8"},St={key:1,class:"mb-8"},jt={key:2},Vt={key:0,class:"mb-8"},zt={class:"mt-16"},Mt={class:"border border-gray-200 bg-white dark:border-gray-700 rounded-lg overflow-hidden"},Ot={class:"flex justify-between font-semibold p-4 bg-gray-100 dark:bg-gray-900 text-sm"},Dt={class:"w-[33%] text-center"},Lt={key:0},Rt={class:"w-[12%] text-sm font-medium"},Nt={class:"w-[15%] text-sm"},Ut={class:"w-[33%] text-sm text-center"},Ft={class:"w-[24%] text-sm"},At={class:"w-[16%] flex justify-center space-x-1"},Et={key:1,class:"text-center py-4 text-gray-500 dark:text-gray-400 dark:bg-gray-800"},It={key:3},Wt={class:"mb-8"},Ht={class:"flex items-center select-none flex-1 mb-4"},Bt={class:"flex items-center select-none flex-1 mb-4"},Pt={class:"select-none"},qt={class:"grid grid-cols-1 gap-6"},Jt={key:0},Gt={key:1,class:"flex flex-col items-center justify-center select-none"},Kt={class:"mb-8 w-full"},Qt={class:"flex flex-col gap-4 mt-4"},Zt=["textContent"],Xt={key:2},Yt={class:"mb-8 w-full"},ea={class:"flex flex-col gap-4 mt-4"},ta={key:3,class:"mt-8 w-full"},aa={class:"p-4"},sa={class:"mt-4"},oa={class:"w-full text-sm"},la={class:"w-full"},na={class:"w-full flex justify-between bg-gray-50 dark:bg-gray-800 py-2 px-4"},ia={class:"w-full flex justify-between py-2 px-4"},ra={class:"w-full flex justify-between bg-gray-50 dark:bg-gray-800 py-2 px-4"},ua={class:"w-full flex justify-between py-2 px-4"},da={class:"w-full"},ca={class:"font-bold"},ma={class:"w-full"},ga={class:"w-1/3 font-bold italic"},va={class:"w-1/3 text-center"},fa={class:"w-1/3 text-center"},pa={class:"flex justify-end mt-8 space-x-2"},_a={class:"flex items-center justify-between"},ya={key:0,class:"flex flex-col space-y-4"},ba={class:"flex flex-col"},xa={class:"flex items-center justify-between mb-2"},ha={class:"flex gap-2"},ka={key:1,class:"text-center py-8 text-gray-500 dark:text-gray-400"},Fa=de({__name:"index",setup(ae){ft({title:"Optimization - Jesse"});const W=M(),i=b(()=>W.form),o=b(()=>W.results),j=w(!1),$=w(!1),A=w([]),T=w(!1),m=w(!1),p=w(null),S=w(),B=ce(),h=b(()=>B.value==="light"?"vs-light":"vs-dark"),P=b(()=>({automaticLayout:!0,minimap:{enabled:!1},fontSize:14,lineHeight:21,readOnly:!0})),ee=b(()=>{var s;return((s=p.value)==null?void 0:s.strategy_codes)&&Object.keys(p.value.strategy_codes).length>0}),D=b(()=>{var s;return!((s=p.value)!=null&&s.strategy_codes)||Object.keys(p.value.strategy_codes).length===0?"":Object.values(p.value.strategy_codes)[0]||""}),E=b(()=>K().jesseSupportedTimeframes.map(s=>({label:s,value:s})));me(()=>{setTimeout(()=>{q(),L()},50)}),O(()=>o.value.showResults,s=>{s&&L()}),O(h,s=>{var e,V;(V=(e=S.value)==null?void 0:e.$editor)==null||V.updateOptions({theme:s})}),O(m,async s=>{s&&(await We(),setTimeout(()=>{var e;(e=S.value)!=null&&e.$editor&&S.value.$editor.updateOptions({theme:h.value})},50))}),O(T,async s=>{s&&await L()});async function L(){if(i.value.id)try{const s=await W.getSessionData(i.value.id);s&&(p.value=s)}catch(s){console.error("Error fetching session data:",s)}}const R=w([]);async function q(){R.value=await K().getExchangeSupportedSymbols(i.value.exchange);for(let s=0;s<i.value.routes.length;s++)R.value.includes(i.value.routes[s].symbol)||(i.value.routes[s].symbol=R.value[0])}i.value.exchange=i.value.exchange||K().backtestingExchangeNames[0];const r=b(()=>I.remainingTimeText(o.value.progressbar.estimated_remaining_seconds)),d=b(()=>{const s=o.value.generalInfo.find(e=>e[0]==="Objective Function");return s?s[1]:"sharpe"});function C(){if(A.value.length){for(let s=0;s<A.value.length;s++)F("error",A.value[s]);return}if(i.value.routes.length>1){F("error","Optimization mode does not support multiple routes at the moment.");return}M().start()}function x(){I.copyToClipboard(o.value.infoLogs),F("success","Info logs copied successfully"),$.value=!0,setTimeout(()=>{$.value=!1},3e3)}async function te(){await M().terminate()}const J=w(!1),_=w({});async function se(s){(await I.copyToClipboard(s)).success?F("success","DNA copied to clipboard"):F("error","Failed to copy DNA. Please try manually selecting and copying.")}function ge(s){_.value=s,J.value=!0}const oe=b(()=>o.value.status==="terminated");async function ve(){await M().resume()}const fe=s=>{const e=[];return s.forEach(V=>{e.push([{value:V.symbol,style:""},{value:V.timeframe,style:""},{value:V.strategy,style:""}])}),e},pe=s=>[["Training Start Date",s.training_start_date],["Training Finish Date",s.training_finish_date],["Testing Start Date",s.testing_start_date],["Testing Finish Date",s.testing_finish_date]];async function _e(){try{await navigator.clipboard.writeText(D.value),F("success","Strategy code copied to clipboard")}catch(s){et(s)}}function ye(){var e;const s=(e=i.value.routes[0])==null?void 0:e.strategy;s?Q(`/strategies/${s}`):F("error","No strategy selected")}async function be(){await L()}return(s,e)=>{var re,ue;const V=Ne,xe=He,he=tt,ke=st,N=qe,we=Tt,g=Pe,Te=ut,Ce=dt,G=Ge,$e=Ke,Se=Qe,je=ct,le=Je,ne=rt,Ve=at,ze=mt,ie=Be,Me=gt,Oe=Ct,De=Xe,Le=Ze;return n(),c(H,null,[l(xe,{modelValue:o.value.logsModal,"onUpdate:modelValue":e[0]||(e[0]=t=>o.value.logsModal=t),title:"Logs"},{default:k(()=>[l(V,{logs:o.value.infoLogs},null,8,["logs"])]),buttons:k(()=>[a("button",{class:"ml-2 p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 focus:outline-none",onClick:x},[$.value?(n(),U(u(pt),{key:0,class:"h-6 w-6","aria-hidden":"true"})):v("",!0),!$.value&&o.value.infoLogs.length!=0?(n(),U(u(_t),{key:1,class:"h-6 w-6","aria-hidden":"true"})):v("",!0)])]),_:1},8,["modelValue"]),l(ze,null,{left:k(()=>[o.value.alert.message?(n(),c("div",$t,[l(he,{color:"teal",icon:"i-heroicons-check-circle",variant:"soft",title:o.value.alert.message,"close-button":{icon:"i-heroicons-x-mark-20-solid",color:"white",variant:"link"},onClose:e[1]||(e[1]=t=>o.value.alert.message="")},null,8,["title"])])):v("",!0),o.value.exception.error&&o.value.executing?(n(),c("div",St,[l(ke,{modelValue:j.value,"onUpdate:modelValue":e[2]||(e[2]=t=>j.value=t),title:o.value.exception.error,content:o.value.exception.traceback,mode:"optimize"},null,8,["modelValue","title","content"])])):v("",!0),(o.value.executing||o.value.showResults)&&!o.value.exception.error?(n(),c("div",jt,[o.value.objective_curve&&o.value.objective_curve.length?(n(),c("div",Vt,[l(N,{title:"Objective Progress",class:"mb-4"}),l(we,{data:o.value.objective_curve},null,8,["data"])])):v("",!0),a("div",zt,[l(N,{title:"Best Trials",class:"my-4"}),e[34]||(e[34]=a("p",{class:"text-sm text-gray-500 dark:text-gray-400 mb-4"}," Showing top 20 trials sorted by fitness score ",-1)),a("div",Mt,[a("div",Ot,[e[30]||(e[30]=a("div",{class:"w-[12%]"},"Rank",-1)),e[31]||(e[31]=a("div",{class:"w-[15%]"},"Trial",-1)),a("div",Dt,"Training/Testing "+f(d.value),1),e[32]||(e[32]=a("div",{class:"w-[24%]"},"Fitness",-1)),e[33]||(e[33]=a("div",{class:"w-[16%] text-center"},"Actions",-1))]),o.value.best_candidates.length?(n(),c("div",Lt,[(n(!0),c(H,null,Y(o.value.best_candidates,(t,z)=>(n(),c("div",{key:z,class:Z(["flex items-center justify-between border-t border-gray-200 dark:border-gray-700 p-2 dark:bg-gray-700",{"bg-gray-50 dark:bg-gray-800":z%2===0}])},[a("div",Rt,f(t.rank),1),a("div",Nt,f(t.trial),1),a("div",Ut,f(t.objective_metric),1),a("div",Ft,f(t.fitness),1),a("div",At,[l(g,{variant:"ghost",color:"gray",icon:"i-heroicons-clipboard-document-list",onClick:Re=>se(t.dna)},null,8,["onClick"]),l(g,{variant:"ghost",icon:"i-heroicons-information-circle",onClick:Re=>ge(t)},null,8,["onClick"])])],2))),128))])):(n(),c("div",Et," No candidates found yet... "))])])])):v("",!0),!o.value.executing&&!o.value.showResults?(n(),c("div",It,[l(N,{class:"mb-4",title:"Exchange"}),l(Te,{modelValue:i.value.exchange,"onUpdate:modelValue":e[3]||(e[3]=t=>i.value.exchange=t),placeholder:"Select an exchange...",searchable:"",options:u(K)().backtestingExchangeNames,size:"lg",class:"mt-2 mb-16",onChange:q},null,8,["modelValue","options"]),l(Ce,{"total-routes-error":A.value,form:i.value,results:o.value,mode:"optimization",symbols:R.value,timeframes:E.value},null,8,["total-routes-error","form","results","symbols","timeframes"]),l(N,{class:"mt-16 mb-4",title:"Duration"}),a("div",Wt,[e[35]||(e[35]=a("h3",{class:"text-sm font-medium text-gray-700 dark:text-gray-200 mb-2"},"Training Period",-1)),a("div",Ht,[l(G,{modelValue:i.value.training_start_date,"onUpdate:modelValue":e[4]||(e[4]=t=>i.value.training_start_date=t),type:"date",variant:"outline",size:"lg",class:"w-full mr-2"},null,8,["modelValue"]),l(G,{modelValue:i.value.training_finish_date,"onUpdate:modelValue":e[5]||(e[5]=t=>i.value.training_finish_date=t),type:"date",variant:"outline",size:"lg",class:"w-full ml-2"},null,8,["modelValue"])])]),a("div",null,[e[36]||(e[36]=a("h3",{class:"text-sm font-medium text-gray-700 dark:text-gray-200 mb-2"},"Testing Period",-1)),a("div",Bt,[l(G,{modelValue:i.value.testing_start_date,"onUpdate:modelValue":e[6]||(e[6]=t=>i.value.testing_start_date=t),type:"date",variant:"outline",size:"lg",class:"w-full mr-2"},null,8,["modelValue"]),l(G,{modelValue:i.value.testing_finish_date,"onUpdate:modelValue":e[7]||(e[7]=t=>i.value.testing_finish_date=t),type:"date",variant:"outline",size:"lg",class:"w-full ml-2"},null,8,["modelValue"])])]),l(N,{class:"mt-16 mb-4",title:"Optimal Trades"}),a("div",Pt,[e[37]||(e[37]=a("p",{class:"text-sm text-gray-500 dark:text-gray-400"},[X(" The number that tells Jesse how many trades you would find optimal for your strategy in the targeted time period so that it can filter out those DNAs that cause too few trades. "),a("a",{href:"https://docs.jesse.trade/docs/optimize/executing-the-optimize-mode.html",target:"_blank",class:"font-semibold hover:underline italic"},"More Details...")],-1)),e[38]||(e[38]=a("br",null,null,-1)),l($e,{modelValue:i.value.optimal_total,"onUpdate:modelValue":e[8]||(e[8]=t=>i.value.optimal_total=t),title:"Optimal number of trades:"},null,8,["modelValue"])]),l(N,{class:"mt-16 mb-4",title:"Options"}),a("div",qt,[l(Se,{modelValue:i.value.fast_mode,"onUpdate:modelValue":e[9]||(e[9]=t=>i.value.fast_mode=t),title:"Fast Mode",description:"Runs the backtest faster using an improved algorithm."},null,8,["modelValue"])])])):v("",!0)]),right:k(()=>[!o.value.executing&&!o.value.showResults?(n(),c("div",Jt,[a("div",null,[l(g,{class:"w-full flex justify-center",icon:"i-heroicons-bolt",size:"xl",variant:"solid",label:"Start",trailing:!1,onClick:e[10]||(e[10]=t=>C())}),l(g,{class:"w-full flex justify-center mt-4",icon:"i-heroicons-clock",size:"xl",variant:"solid",color:"gray",label:"History",trailing:!1,onClick:e[11]||(e[11]=t=>("navigateTo"in s?s.navigateTo:u(Q))("/optimization/history"))})])])):v("",!0),o.value.executing&&!o.value.showResults?(n(),c("div",Gt,[a("div",Kt,[o.value.exception.error?(n(),U(g,{key:0,class:"w-full flex justify-center mt-4",icon:"i-heroicons-arrow-path",size:"xl",variant:"solid",label:"Rerun",trailing:!1,onClick:e[12]||(e[12]=t=>u(M)().rerun())})):v("",!0),o.value.exception.error?(n(),U(g,{key:1,class:"w-full flex justify-center mt-4",icon:"i-heroicons-arrow-uturn-left",size:"xl",variant:"solid",color:"green",label:"New Session",trailing:!1,onClick:e[13]||(e[13]=t=>u(M)().newSession())})):o.value.showResults?v("",!0):(n(),U(g,{key:2,color:"gray",ui:{color:{gray:{solid:"text-rose-500 dark:text-rose-400"}}},class:"w-full flex justify-center mt-4",icon:"i-heroicons-pause",size:"xl",variant:"solid",label:"Terminate",trailing:!1,onClick:e[14]||(e[14]=t=>te())})),a("div",Qt,[l(g,{class:"w-full flex justify-center",color:"gray",size:"xl",variant:"solid",label:"Logs",icon:"i-heroicons-document-text",trailing:!1,onClick:e[15]||(e[15]=t=>o.value.logsModal=!0)}),l(g,{class:"w-full flex justify-center",color:"gray",size:"xl",variant:"solid",label:"History",icon:"i-heroicons-clock",trailing:!1,onClick:e[16]||(e[16]=t=>("navigateTo"in s?s.navigateTo:u(Q))("/optimization/history"))})])]),a("div",null,[l(je,{progress:o.value.progressbar.current},null,8,["progress"])]),!o.value.exception.error&&!o.value.best_candidates.length?(n(),c("h3",{key:0,class:"mt-8 animate-pulse",textContent:f(r.value)},null,8,Zt)):v("",!0)])):v("",!0),o.value.showResults?(n(),c("div",Xt,[a("div",Yt,[oe.value?(n(),U(g,{key:0,class:"w-full flex justify-center",icon:"i-heroicons-play",size:"xl",variant:"solid",color:"primary",label:"Resume",trailing:!1,onClick:e[17]||(e[17]=t=>ve())})):v("",!0),l(g,{class:Z(["w-full flex justify-center",{"mt-4":oe.value}]),icon:"i-heroicons-arrow-uturn-left",size:"xl",variant:"solid",color:"green",label:"New Session",trailing:!1,onClick:e[18]||(e[18]=t=>u(M)().newSession())},null,8,["class"]),a("div",ea,[l(g,{class:"w-full flex justify-center",color:"gray",size:"xl",variant:"solid",label:"Logs",icon:"i-heroicons-document-text",trailing:!1,onClick:e[19]||(e[19]=t=>o.value.logsModal=!0)}),l(g,{class:"w-full flex justify-center",color:"gray",size:"xl",variant:"solid",label:"History",icon:"i-heroicons-clock",trailing:!1,onClick:e[20]||(e[20]=t=>("navigateTo"in s?s.navigateTo:u(Q))("/optimization/history"))}),l(g,{class:"w-full flex justify-center",color:"gray",size:"xl",variant:"solid",label:"Title & Notes",icon:"i-heroicons-pencil-square",trailing:!1,onClick:e[21]||(e[21]=t=>T.value=!0)}),ee.value?(n(),U(g,{key:0,class:"w-full flex justify-center",color:"gray",size:"xl",variant:"solid",label:"View Strategy",icon:"i-heroicons-code-bracket",trailing:!1,onClick:e[22]||(e[22]=t=>m.value=!0)})):v("",!0)])])])):v("",!0),(o.value.executing||o.value.showResults)&&o.value.generalInfo.length?(n(),c("div",ta,[l(N,{title:"Info",class:"mb-4"}),l(le,{data:o.value.generalInfo},null,8,["data"]),l(ne,{class:"mt-8 mb-4",size:"lg",label:"Duration"}),l(le,{data:pe(i.value)},null,8,["data"]),l(ne,{class:"mt-8 mb-4",size:"lg",label:"Routes"}),l(Ve,{data:fe(i.value.routes),"header-items":["Symbol","Timeframe","Strategy"],header:""},null,8,["data"])])):v("",!0)]),_:1}),l(ie,{modelValue:J.value,"onUpdate:modelValue":e[25]||(e[25]=t=>J.value=t)},{default:k(()=>[a("div",aa,[a("div",sa,[a("div",oa,[e[45]||(e[45]=a("h2",{class:"text-lg mb-2 font-bold italic dark:text-white text-center"}," Candidate Info ",-1)),a("div",la,[a("div",na,[e[39]||(e[39]=a("div",{class:"font-bold"},"Rank",-1)),a("div",null,f(_.value.rank),1)]),a("div",ia,[e[40]||(e[40]=a("div",{class:"font-bold"},"Trial",-1)),a("div",null,f(_.value.trial),1)]),a("div",ra,[e[41]||(e[41]=a("div",{class:"font-bold"},"Fitness",-1)),a("div",null,f(_.value.fitness),1)]),a("div",ua,[e[43]||(e[43]=a("div",{class:"font-bold"},"DNA",-1)),l(g,{size:"xs",color:"primary",onClick:e[23]||(e[23]=t=>se(_.value.dna))},{default:k(()=>e[42]||(e[42]=[X(" Copy DNA ")])),_:1})])]),e[46]||(e[46]=a("h2",{class:"text-lg font-bold italic dark:text-white mt-6 mb-2 text-center"}," Parameters ",-1)),a("div",da,[(n(!0),c(H,null,Y(Object.keys(_.value.params),(t,z)=>(n(),c("div",{key:t,class:Z([{"bg-gray-50 dark:bg-gray-800":z%2===0},"w-full flex justify-between py-2 px-4"])},[a("div",ca,f(t),1),a("div",null,f(typeof _.value.params[t]=="number"?u(y).round(_.value.params[t],6):_.value.params[t]),1)],2))),128))]),e[47]||(e[47]=a("h2",{class:"text-lg font-bold italic dark:text-white mt-6 mb-2 text-center"}," Metrics Comparison ",-1)),a("div",ma,[e[44]||(e[44]=a("div",{class:"flex justify-between py-2 px-4 bg-gray-100 dark:bg-gray-800 font-bold text-sm"},[a("div",{class:"w-1/3 font-bold"},"Metric"),a("div",{class:"w-1/3 text-center font-bold"},"Training"),a("div",{class:"w-1/3 text-center font-bold"},"Testing")],-1)),(n(!0),c(H,null,Y([{key:"total",label:"Total Closed Trades"},{key:"net_profit",label:"Total Net Profit",format:t=>`${u(y).round(t.net_profit,2)} (${u(y).round(t.net_profit_percentage,2)}%)`},{key:"starting_balance",label:"Starting => Finishing Balance",format:t=>`${u(y).round(t.starting_balance,2)} => ${u(y).round(t.finishing_balance,2)}`},{key:"total_open_trades",label:"Open Trades"},{key:"fee",label:"Total Paid Fees",round:2},{key:"max_drawdown",label:"Max Drawdown",round:2},{key:"annual_return",label:"Annual Return",format:t=>`${u(y).round(t.annual_return,2)}%`},{key:"expectancy",label:"Expectancy",format:t=>`${u(y).round(t.expectancy,2)} (${u(y).round(t.expectancy_percentage,2)}%)`},{key:"average_win",label:"Avg Win | Avg Loss",format:t=>`${u(y).round(t.average_win,2)} | ${u(y).round(t.average_loss,2)}`},{key:"ratio_avg_win_loss",label:"Ratio Avg Win / Avg Loss",round:2},{key:"win_rate",label:"Win-rate",format:t=>`${u(y).round(t.win_rate*100,2)}%`},{key:"longs_percentage",label:"Longs | Shorts",format:t=>`${u(y).round(t.longs_percentage,2)}% | ${u(y).round(t.shorts_percentage,2)}%`},{key:"average_holding_period",label:"Avg Holding Time",format:t=>u(I).secondsToHumanReadable(t.average_holding_period)},{key:"average_winning_holding_period",label:"Winning Trades Avg Holding Time",format:t=>u(I).secondsToHumanReadable(t.average_winning_holding_period)},{key:"average_losing_holding_period",label:"Losing Trades Avg Holding Time",format:t=>u(I).secondsToHumanReadable(t.average_losing_holding_period)},{key:"sharpe_ratio",label:"Sharpe Ratio",round:2},{key:"calmar_ratio",label:"Calmar Ratio",round:2},{key:"sortino_ratio",label:"Sortino Ratio",round:2},{key:"omega_ratio",label:"Omega Ratio",round:2},{key:"winning_streak",label:"Winning Streak"},{key:"losing_streak",label:"Losing Streak"},{key:"largest_winning_trade",label:"Largest Winning Trade",round:2},{key:"largest_losing_trade",label:"Largest Losing Trade",round:2},{key:"total_winning_trades",label:"Total Winning Trades"},{key:"total_losing_trades",label:"Total Losing Trades"}],(t,z)=>(n(),c("div",{key:t.key,class:Z([{"bg-gray-50 dark:bg-gray-800":z%2===0},"w-full flex justify-between py-2 px-4"])},[a("div",ga,f(t.label),1),a("div",va,f(t.format?t.format(_.value.training_metrics):t.round?u(y).round(_.value.training_metrics[t.key],t.round):_.value.training_metrics[t.key]),1),a("div",fa,f(t.format?t.format(_.value.testing_metrics):t.round?u(y).round(_.value.testing_metrics[t.key],t.round):_.value.testing_metrics[t.key]),1)],2))),128))])])]),a("div",pa,[l(g,{color:"gray",block:"",onClick:e[24]||(e[24]=t=>J.value=!1)},{default:k(()=>e[48]||(e[48]=[X(" Close ")])),_:1})])])]),_:1},8,["modelValue"]),l(Me,{modelValue:T.value,"onUpdate:modelValue":e[26]||(e[26]=t=>T.value=t),"session-id":i.value.id,"initial-title":(re=p.value)==null?void 0:re.title,"initial-description":(ue=p.value)==null?void 0:ue.description,onSaved:be},null,8,["modelValue","session-id","initial-title","initial-description"]),l(ie,{modelValue:m.value,"onUpdate:modelValue":e[29]||(e[29]=t=>m.value=t),ui:{width:"sm:max-w-5xl"}},{default:k(()=>[l(Le,null,{header:k(()=>[a("div",_a,[e[49]||(e[49]=a("h3",{class:"text-lg font-semibold"},"Strategy Code Snapshot",-1)),l(g,{color:"gray",variant:"ghost",icon:"i-heroicons-x-mark",size:"sm",onClick:e[27]||(e[27]=t=>m.value=!1)})])]),default:k(()=>{var t;return[(t=p.value)!=null&&t.strategy_codes&&Object.keys(p.value.strategy_codes).length>0?(n(),c("div",ya,[a("div",ba,[a("div",xa,[e[50]||(e[50]=a("label",{class:"block text-sm font-medium"},null,-1)),a("div",ha,[l(g,{icon:"i-heroicons-clipboard-document",label:"Copy",variant:"soft",color:"gray",size:"sm",onClick:_e}),l(g,{icon:"i-heroicons-pencil-square",label:"Go to Strategy Editor",variant:"soft",color:"primary",size:"sm",onClick:ye})])]),l(De,null,{default:k(()=>[l(Oe,{ref_key:"codeEditorRef",ref:S,modelValue:D.value,"onUpdate:modelValue":e[28]||(e[28]=z=>D.value=z),lang:"python",options:P.value,class:"border border-gray-200 dark:border-gray-800 rounded",style:{height:"500px"}},{default:k(()=>e[51]||(e[51]=[X(" Loading editor... ")])),_:1},8,["modelValue","options"])]),_:1})])])):(n(),c("div",ka," No strategy code snapshot available for this session. "))]}),_:1})]),_:1},8,["modelValue"])],64)}}});export{Fa as default};
