import{c as y,o as l,b as a,g as Z,r as w,a3 as xe,d as r,F as G,p as ce,k as S,w as T,a4 as pe,m as de,D as n,t as H,a5 as ge,a6 as Re,H as Ae,S as Oe,q as le,K as q,aW as we,b4 as Q,O as X,a0 as N,a8 as Be,h as V,E as D,e as $e,a$ as De,b0 as Te,Z as Ne,b5 as ze,aX as Fe,a as qe,aG as He,aH as We,aI as Ye,b6 as Ze,aT as Ge,aD as Qe,aE as ve,s as Je,M as Ke,i as Y,v as Ce,n as Xe,x as et,G as ye,l as C,V as tt,T as be,W as K,Y as st,$ as ot}from"./5gBRjOdc.js";import{a as rt,r as nt}from"./PK4hkpqp.js";import{b as Ve,T as lt,r as he,_ as at,a as it,c as ut,e as dt,d as ct}from"./BdBWGAVm.js";import{_ as mt}from"./DdtJ7qhd.js";import{_ as ft}from"./8J4h3xJL.js";import{_ as pt}from"./B-V_BbKM.js";import{l as gt,d as vt,s as _e,_ as yt,u as bt}from"./Cf8Upy1B.js";import{u as ht}from"./nmXziDto.js";import"./C6eXxs0_.js";function ke(P,s){return l(),y("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 0 0 2.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 0 0-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75 2.25 2.25 0 0 0-.1-.664m-5.8 0A2.251 2.251 0 0 1 13.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25ZM6.75 12h.008v.008H6.75V12Zm0 3h.008v.008H6.75V15Zm0 3h.008v.008H6.75V18Z"})])}function _t(P,s){return l(),y("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 6.878V6a2.25 2.25 0 0 1 2.25-2.25h7.5A2.25 2.25 0 0 1 18 6v.878m-12 0c.235-.083.487-.128.75-.128h10.5c.263 0 .515.045.75.128m-12 0A2.25 2.25 0 0 0 4.5 9v.878m13.5-3A2.25 2.25 0 0 1 19.5 9v.878m0 0a2.246 2.246 0 0 0-.75-.128H5.25c-.263 0-.515.045-.75.128m15 0A2.25 2.25 0 0 1 21 12v6a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 18v-6c0-.98.626-1.813 1.5-2.122"})])}const kt={base:"animate-pulse",background:"bg-gray-100 dark:bg-gray-800",rounded:"rounded-md"},xt={class:"mb-4"},wt={class:""},$t={class:"relative rounded-lg shadow flex divide-x divide-gray-200 dark:divide-gray-700","aria-label":"Tabs"},Tt=["to","onClick"],Ct=["onClick"],Vt=["onClick"],Lt={class:"absolute right-[1em] focus:outline-none"},St=Z({__name:"LiveTabs",props:{currentTab:{},tabs:{}},emits:["close","cancel"],setup(P,{emit:s}){const $=xe(),b=w($.params.id),h=w(!1),o=w(!1),L=w(null),v=w(null),m=s;function u(i){if(Object.keys(Q().tabs).length>=X().planLimits.live_trading_tabs){N("error",`You have reached the limit of "${X().planLimits.live_trading_tabs}" tabs for your "${X().plan}" plan. Please upgrade your plan to add more tabs.`);return}Q().addTab(i)}function x(i){Be().push(`/live/${i}`)}function M(i){if(!i.form.routes.length)return"New Tab";if(i.results.exception.error&&i.results.monitoring)return"ðŸ”´ Error";const f=i.form.routes[0];let g="";const U=i.form.exchange;return U&&(g+=`${U} â€¢ `),f.strategy&&(g+=`${f.strategy} â€¢ `),f.symbol&&(g+=`${f.symbol} â€¢ `),f.timeframe&&(g+=`${f.timeframe}`),g=g.endsWith(" â€¢ ")?g.slice(0,-3):g,i.results.monitoring&&!i.results.finished?`ðŸŸ¢ ${g}`:i.results.exception.error&&i.results.monitoring?`ðŸ”´ ${g}`:i.results.showResults?`${g} | Results`:g}function A(i){L.value=i.id,i.results.exception.error||i.results.finished||i.results.booting?h.value=!0:m("close",L.value)}return(i,f)=>{const g=Oe,U=le,z=we;return l(),y("div",xt,[a("div",wt,[a("nav",$t,[(l(!0),y(G,null,ce(i.tabs,k=>(l(),S(g,{key:k.id,class:"relative group min-w-0 flex-1 overflow-hidden text-center flex items-center",text:M(k),"open-delay":700,onMouseup:Ae(F=>A(k),["middle"])},{default:T(()=>[a("div",{to:`/live/${k.id}`,class:de([k.id===n(b)?"text-gray-900 dark:text-gray-100 font-bold ":"text-gray-500 dark:text-gray-300 hover:text-gray-700 font-medium ","whitespace-nowrap py-3 px-4 inline-block select-none cursor-pointer focus:outline-none w-full text-xs bg-gray-50 dark:bg-backdrop-dark"]),onClick:F=>x(k.id)},[a("span",null,H(M(k)),1),a("span",{"aria-hidden":"true",class:de([k.id===n(b)&&Object.keys(i.tabs).length>1?"bg-indigo-400":"bg-transparent dark:bg-gray-600","absolute inset-x-0 bottom-0 h-0.5"])},null,2)],10,Tt),(k.results.booting||k.results.monitoring)&&!k.results.finished?pe((l(),y("button",{key:0,class:"absolute right-[0.5em] focus:outline-none",onClick:F=>{o.value=!0,v.value=k.id}},[r(n(rt),{class:"h-5 w-5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 hover:bg-gray-200 bg-gray-100 dark:bg-gray-700 rounded-full","aria-hidden":"true"})],8,Ct)),[[ge,Object.keys(i.tabs).length>1]]):pe((l(),y("button",{key:1,class:"hidden md:block absolute right-[0.5em] focus:outline-none",onClick:F=>A(k)},[r(n(Re),{class:"h-5 w-5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 hover:bg-gray-200 bg-gray-100 dark:bg-gray-700 rounded-full","aria-hidden":"true"})],8,Vt)),[[ge,Object.keys(i.tabs).length>1]])]),_:2},1032,["text","onMouseup"]))),128)),r(g,{text:"New Tab",popper:{arrow:!0}},{default:T(()=>[a("div",{class:"select-none cursor-pointer text-gray-400 dark:text-gray-100 hover:text-gray-600 focus:outline-none group relative w-14 overflow-hidden bg-gray-50 dark:bg-backdrop-dark py-3 px-4 font-medium hover:bg-gray-50 dark:hover:bg-gray-800 flex items-center justify-center",onClick:f[0]||(f[0]=k=>u(i.currentTab))},[a("button",Lt,[r(n(nt),{class:"h-6 w-6 rounded-full","aria-hidden":"true"})]),f[5]||(f[5]=a("span",{"aria-hidden":"true",class:"absolute inset-x-0 bottom-0 h-0.5 bg-transparent dark:bg-gray-600"},null,-1))])]),_:1})])]),r(z,{modelValue:n(o),"onUpdate:modelValue":f[2]||(f[2]=k=>q(o)?o.value=k:null),title:"Termination Confirm",description:"Are you sure you want to terminate this session?",type:"info"},{default:T(()=>[r(U,{variant:"solid",color:"red",class:"flex justify-center",label:"Terminate",onClick:f[1]||(f[1]=k=>{m("cancel",n(v)),o.value=!1})})]),_:1},8,["modelValue"]),r(z,{modelValue:n(h),"onUpdate:modelValue":f[4]||(f[4]=k=>q(h)?h.value=k:null),title:"Close Live Tab Confirm",description:"Are you sure you want to close this tab?","cancel-btn-content":"cancel",type:"info"},{default:T(()=>[r(U,{variant:"solid",color:"red",class:"flex justify-center",label:"Close",onClick:f[3]||(f[3]=k=>{m("close",n(L)),h.value=!1})})]),_:1},8,["modelValue"])])}}}),Pt=Z({__name:"LiveOrders",props:{orders:{}},setup(P){const s=P,$=V(()=>{if(!s.orders.length)return[];const b=[];for(let h=s.orders.length-1;h>=0;h--){const o=s.orders[h];b.push([{value:o.id.slice(-12),style:"text-xs",tooltip:o.id,tag:"code"},{value:D.timestampToTimeOnly(o.created_at),style:"text-xs",tooltip:D.timestampToTime(o.created_at)},{value:o.symbol,style:"text-xs"},{value:o.type,style:"text-xs"},{value:o.side,style:D.colorBasedOnSide(o.side)},{value:o.price,style:"text-xs"},{value:o.qty,style:D.colorBasedOnSide(o.side)},{value:o.status,style:"text-xs"}])}return b});return(b,h)=>{const o=Ve,L=mt;return n($).length?(l(),S(o,{key:0,data:n($),"header-items":["ID","Created","Symbol","Type","Side","Price","QTY","Status"],header:""},null,8,["data"])):(l(),S(L,{key:1}))}}}),It={class:"flex justify-end item-center"},Et={class:"flex justify-end"},jt=Z({__name:"ReportLiveSession",props:{session:{}},emits:["close"],setup(P,{emit:s}){const $=s,b=w(!1),h=P,o=w({description:"",email:""}),L=()=>{$("close")},v=async()=>{if(b.value=!0,!o.value.description){N("error","Please enter a description."),b.value=!1;return}const{data:m,error:u}=await Fe("/system/report-exception",{description:o.value.description,email:o.value.email,traceback:"manual report",mode:"live",attach_logs:!0,session_id:h.session},!0);if(b.value=!1,u.value&&u.value.statusCode!==200){N("error",`[${u.value.statusCode}]: ${u.value.statusText}`);return}const x=m.value;x.status==="success"?(o.value.description="",o.value.email="",N("success",x.message),L()):x.status==="error"&&N("error",x.message)};return(m,u)=>{const x=Ne,M=Te,A=ze,i=le,f=De;return l(),y(G,null,[u[5]||(u[5]=a("p",null," If you think something is wrong with your running live session, you can submit a report. By submitting this form, the logs of this session will be sent to Jesse's developers so we can see what's going on. ",-1)),u[6]||(u[6]=a("br",null,null,-1)),u[7]||(u[7]=a("p",null,[$e("Your exchange API keys and strategies are safe and "),a("b",null,"are never sent to us.")],-1)),u[8]||(u[8]=a("br",null,null,-1)),r(f,{state:n(o),class:"space-y-4",onSubmit:v},{default:T(()=>[r(M,{label:"Email (optional)",help:"Enter your email address for us to know who sent the email and possibly reply back to you."},{default:T(()=>[r(x,{modelValue:n(o).email,"onUpdate:modelValue":u[0]||(u[0]=g=>n(o).email=g),placeholder:"Email address...",type:"email"},null,8,["modelValue"])]),_:1}),u[3]||(u[3]=a("br",null,null,-1)),r(M,{label:"Description:",name:"Description"},{default:T(()=>[r(A,{modelValue:n(o).description,"onUpdate:modelValue":u[1]||(u[1]=g=>n(o).description=g),rows:10,placeholder:"Describe what you think is wrong in this session..."},null,8,["modelValue"])]),_:1}),u[4]||(u[4]=a("br",null,null,-1)),a("div",It,[a("div",Et,[r(i,{color:"gray",variant:"link",class:"mr-8",label:"Cancel",onClick:u[2]||(u[2]=g=>L())}),r(i,{type:"submit",class:"w-48 flex justify-center",label:"Submit",loading:n(b),disabled:n(b)},null,8,["loading","disabled"])])])]),_:1},8,["state"])],64)}}}),Mt=Qe(ve.ui.strategy,ve.ui.skeleton,kt),Ut=Z({inheritAttrs:!1,props:{class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},setup(P){const{ui:s,attrs:$}=We("skeleton",Ye(P,"ui"),Mt),b=V(()=>Ze(Ge(s.value.base,s.value.background,s.value.rounded),P.class));return{ui:s,attrs:$,skeletonClass:b}}});function Rt(P,s,$,b,h,o){return l(),y("div",He({class:P.skeletonClass},P.attrs),null,16)}const At=qe(Ut,[["render",Rt]]),Ot={class:"mb-16"},Bt={key:0,class:"rounded overflow-hidden border-2 border-gray-100 dark:border-gray-600 p-4"},Dt={key:1},Nt=Z({__name:"CandlesChart",props:{form:{},results:{}},setup(P){const s=Je(),$=V(()=>Ke().params.id),b=w(!0),h=w(2),o=P,L=w();let v=null,m=null;const u={orderEntries:{},positionEntry:null};let x=null,M=null;const A=V(()=>s.value),i=o.form.exchange,f=V(()=>`${i}-${o.results.selectedRoute.symbol}-${o.results.selectedRoute.timeframe}`),g=V(()=>o.results.currentCandles),U=V(()=>{const d=o.results.positions.find(p=>p[0].value===o.results.selectedRoute.symbol);return d===void 0?[]:d}),z=V(()=>U.value[2].value),k=V(()=>Number(U.value[1].value)>0?"long":Number(U.value[1].value)<0?"short":"close");Y(A,d=>{re(d)}),Y(z,(d,p)=>{m!==null&&d!==p&&te()}),Y(()=>o.results.orders,()=>{m!==null&&se()},{deep:!0}),Y(g,(d,p)=>{m!==null&&oe(d[f.value],d[f.value])}),Ce(async()=>{M=setTimeout(async()=>{await F()},200)});async function F(){b.value=!0,await Q().fetchCandles($.value),b.value=!1,await Xe();const d=L.value;if(!d)return;_e.width=d.clientWidth,v=lt(d,_e),v.applyOptions({watermark:{visible:!0,fontSize:16,horzAlign:"left",vertAlign:"bottom",color:"#888",text:`${o.results.selectedRoute.symbol} â€¢ ${o.results.selectedRoute.timeframe}`}}),m=v.addCandlestickSeries();const p=(o.results.candles||[]).map(_=>{const O=ne(_==null?void 0:_.time);return O===null?null:{..._,time:O}}).filter(Boolean);if(m.setData(p),p.length>0){const _=p[p.length-1];x=_==null?void 0:_.time}else x=null;v.timeScale().fitContent(),m.applyOptions({priceFormat:{type:"price",precision:h.value,minMove:.01}}),oe(o.results.candles[0],o.results.candles[1]),te(),se(),re(A.value)}et(()=>{ee(),M&&(clearTimeout(M),M=null)});function ee(){v!==null&&(v.remove(),v=null),m&&(m=null),x=null}function te(){const d=k.value==="long"?"#00AB5C":"#FF497D";if(u.positionEntry&&m.removePriceLine(u.positionEntry),Number(z.value)>0){const p={price:Number(z.value),color:d,lineWidth:1,lineStyle:0,axisLabelVisible:!0,title:"Entry Price"};u.positionEntry=m.createPriceLine(p)}}function se(){const d=U.value[0].value;for(const p in u.orderEntries)m.removePriceLine(u.orderEntries[p]),delete u.orderEntries[p];o.results.orders.forEach(p=>{const _=p.side==="buy"?"#00AB5C":"#FF497D",O=ye.startCase(ye.lowerCase(`${p.side} ${p.type}`));if((p.status==="ACTIVE"||p.status==="QUEUED")&&p.symbol===d){const R={price:Number(p.price),color:_,lineWidth:1,lineStyle:0,axisLabelVisible:!0,title:O};u.orderEntries[p.id]=m.createPriceLine(R)}})}function oe(d,p){if(d===void 0)throw new TypeError("candle is undefined!");if(o.results.candles.length===0)return;const _=String(d.open).indexOf("."),O=_===-1?0:String(d.open).length-_-1,R=String(p.open).indexOf("."),e=R===-1?0:String(p.open).length-R-1,t=O>e?O:e;h.value=t,(h.value<0||h.value>100)&&(h.value=0),m.applyOptions({priceFormat:{type:"price",precision:h.value,minMove:Math.pow(10,-t).toFixed(t)}});const E=o.results.currentCandles[f.value];if(!E)return;const I=ne(E.time);if(I===null||x!==null&&I<x)return;const W={...E,time:I};m.update(W),x=I}function re(d){v!==null&&v.applyOptions(d==="light"?gt.chart:vt.chart)}function ae(d){o.results.selectedRoute=d,ee(),F()}function ne(d){if(typeof d=="number")return d;if(d&&typeof d=="object"){if("year"in d&&"month"in d&&"day"in d){const{year:p,month:_,day:O}=d;return Math.floor(Date.UTC(p,_-1,O)/1e3)}if(d instanceof Date)return Math.floor(d.getTime()/1e3)}return null}return(d,p)=>{const _=At,O=le;return l(),y("div",Ot,[n(b)?(l(),y("div",Bt,[r(_,{class:"h-4 w-full mb-4"}),r(_,{class:"h-4 w-2/3 mb-4"}),r(_,{class:"h-4 w-1/2 mb-4"}),r(_,{class:"h-4 w-full mb-4"}),r(_,{class:"h-4 w-full mb-4"}),r(_,{class:"h-4 w-2/3 mb-4"}),r(_,{class:"h-4 w-full mb-4"}),r(_,{class:"h-4 w-full"})])):C("",!0),a("div",{ref_key:"chartContainer",ref:L,class:de({"rounded overflow-hidden border-2 border-gray-100 dark:border-gray-600":!n(b)})},null,2),o.form.routes.length>1?(l(),y("div",Dt,[(l(!0),y(G,null,ce(o.form.routes,R=>(l(),S(O,{key:R.symbol,variant:"soft",color:"gray",disabled:d.results.selectedRoute.symbol===R.symbol&&d.results.selectedRoute.timeframe===R.timeframe,class:"mt-2 mr-2",onClick:e=>ae(R)},{default:T(()=>[$e(H(R.symbol)+" â€¢ "+H(R.timeframe),1)]),_:2},1032,["disabled","onClick"]))),128))])):C("",!0)])}}}),zt={key:0,class:"flex flex-col items-center justify-center select-none mt-[10%]"},Ft=["textContent"],qt={class:"mt-8"},Ht={key:1,class:"mx-auto container mt-8"},Wt={key:0,"data-cy":"live-page-content"},Yt={class:"flex justify-between items-center"},Zt={class:"grid grid-cols-1 gap-6"},Gt={class:"flex justify-between items-center"},Qt={key:1},Jt={key:0,class:"mb-8"},Kt={key:0},Xt={key:0,class:"mt-8 lg:mt-0"},es={key:1,"data-cy":"live-action-button"},ts={key:1,class:"my-8 border-2 dark:border-gray-600 rounded-full"},ss={key:2,class:"bg-white dark:bg-gray-700 grid grid-cols-1 gap-6 border dark:border-gray-600 rounded py-4 px-6 select-none"},os={class:"text-sm font-medium text-gray-500 dark:text-gray-400 truncate"},rs={class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},ns={class:"flex justify-between items-center"},ls={class:"flex justify-start items-center"},as={class:"focus:outline-none flex justify-start items-center"},is={class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},us={class:"flex justify-between items-center"},ds={class:"flex justify-start items-center"},cs={class:"focus:outline-none flex justify-start items-center"},ms={class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},fs={key:3},ps=Z({__name:"LiveTab",props:{form:{},results:{},session:{},tabs:{}},setup(P){const s=P,$=w([]),b=w(!1),h=w(!1),o=w(!1),L=w(!1),v=w(!1),m=w(!1),u=w(!1),x=w(!1),M=w(!1),A=w(!1),i=X(),f=Q(),g=w([]);async function U(){if(!(s.results.monitoring||s.results.booting)){if(!s.form.paper_mode){const e=i.exchangeApiKeys.find(t=>t.id===s.form.exchange_api_key_id);e&&(s.form.exchange=e.exchange)}try{g.value=await X().getExchangeSupportedSymbols(s.form.exchange);for(let e=0;e<s.form.routes.length;e++)g.value.includes(s.form.routes[e].symbol)||(s.form.routes[e].symbol=g.value[0]);if(s.form.data_routes.length>0)for(let e=0;e<s.form.data_routes.length;e++)g.value.includes(s.form.data_routes[e].symbol)||(s.form.data_routes[e].symbol=g.value[0])}catch(e){console.error("Error updating supported symbols:",e)}}}Ce(async()=>{setTimeout(async()=>{s.form.exchange&&(!s.results.monitoring&&!s.results.booting||!g.value.length)&&await U()},200)}),Y(()=>s.form.exchange,async(e,t)=>{e!==t&&await U()}),Y(()=>s.results.monitoring,async e=>{e==!1&&await U()},{deep:!0}),Y(()=>s.form.exchange_api_key_id,async(e,t)=>{e!==t&&await U()});const z=V(()=>{const e=[{label:"Exchange",value:s.results.generalInfo.exchange},{label:"Current Time",value:D.timestampToTime(s.results.generalInfo.current_time)},{label:"Debug Mode",value:s.results.generalInfo.debug_mode},{label:"Paper Trade",value:s.results.generalInfo.paper_mode},{label:"PNL",value:`${s.results.generalInfo.pnl} (${s.results.generalInfo.pnl_perc}%)`},{label:"Started",value:D.timestampToTime(s.results.generalInfo.started_at)},{label:"Started/Current Balance",value:`${s.results.generalInfo.started_balance} / ${s.results.generalInfo.current_balance}`},{label:"Trades",value:`${s.results.generalInfo.count_trades}`}];return s.results.generalInfo.leverage_type!=="spot"&&(e.push({label:"Available Margin",value:`${s.results.generalInfo.available_margin}`}),e.push({label:"Leverage",value:`${s.results.generalInfo.leverage}x (${s.results.generalInfo.leverage_type})`})),e}),k=V(()=>i.notificationApiKeys.map(e=>({label:`${e.name} - ${e.driver}`,value:e.id}))),F=V(()=>Math.round(s.results.progressbar.estimated_remaining_seconds)===0?"Please wait...":`${Math.round(s.results.progressbar.estimated_remaining_seconds)} seconds remaining...`),ee=V(()=>{if(!s.results.orders)return[];const e=[],t=5,E=s.results.orders.length,I=E-t>=0?E-t:0;for(let W=E-1;W>=I;W--){const j=s.results.orders[W],B=j.status==="PARTIALLY FILLED"?`${j.filled_qty}/${j.qty}`:j.qty;e.push([{value:D.timestampToTimeOnly(j.created_at),style:"text-xs",tooltip:D.timestampToTime(j.created_at)},{value:j.symbol,style:"text-xs"},{value:j.type,style:"text-xs"},{value:j.side,style:D.colorBasedOnSide(j.side)},{value:j.price,style:"text-xs"},{value:B,style:D.colorBasedOnSide(j.side)},{value:j.status,style:"text-xs"}])}return e}),te=V(()=>{let e=[];const t=i.jesseSupportedTimeframes;return i.settings.live.generate_candles_from_1m||!s.form.exchange?e=t.map(E=>i.planLimits.timeframes.includes(E)?{label:E,value:E,disabled:!1}:{label:`${E} (Upgrade required)`,value:E,disabled:!0}):e=i.exchangeInfo[s.form.exchange].supported_timeframes.map(I=>i.planLimits.timeframes.includes(I)?{label:I,value:I,disabled:!1}:{label:`${I} (Upgrade required)`,value:I,disabled:!0}),e}),se=V(()=>i.liveTradingExchangeNames.map(e=>i.planLimits.exchanges.includes(e)?{label:e,value:e,disabled:!1}:{label:`${e} (Upgrade required)`,value:e,disabled:!0})),oe=V(()=>i.exchangeApiKeys.map(e=>i.planLimits.exchanges.includes(e.exchange)?{label:`${e.exchange} - ${e.name}`,value:e.id,disabled:!1}:{label:`${e.exchange} - ${e.name} (Upgrade required)`,value:e.id,disabled:!0})),re=f.cancel,ae=f.newLive;function ne(e){if($.value.length){for(let t=0;t<$.value.length;t++)N("error",$.value[t]);return}if(s.form.paper_mode&&!s.form.exchange||!s.form.paper_mode&&s.form.exchange_api_key_id===""){N("error","Please select an exchange");return}f.start(e)}function d(e){f.closeTab(e)}function p(e){A.value=!1,f.stop(e)}function _(){h.value=!0,navigator.clipboard.writeText(s.results.infoLogs),N("success","Logs copied successfully"),L.value=!0,setTimeout(()=>{L.value=!1},3e3)}function O(){o.value=!0,navigator.clipboard.writeText(s.results.errorLogs),N("success","Logs copied successfully"),v.value=!0,setTimeout(()=>{v.value=!1},3e3)}const R=V(()=>["basic","pro","enterprise","basic-lifetime","pro-lifetime","enterprise-lifetime","lifetime"].includes(i.plan));return(e,t)=>{const E=Pt,I=tt,W=jt,j=ft,B=le,Le=we,Se=at,me=it,J=st,ie=pt,Pe=ut,fe=ot,Ie=Te,Ee=Nt,ue=Ve,je=dt,Me=yt,Ue=ct;return l(),y(G,null,[r(I,{modelValue:n(m),"onUpdate:modelValue":t[0]||(t[0]=c=>q(m)?m.value=c:null),size:"ultra",title:"Orders"},{default:T(()=>[r(E,{orders:e.results.orders},null,8,["orders"])]),_:1},8,["modelValue"]),r(I,{modelValue:n(u),"onUpdate:modelValue":t[2]||(t[2]=c=>q(u)?u.value=c:null),size:"small",title:"Report An Issue"},{default:T(()=>[r(W,{session:e.session,onClose:t[1]||(t[1]=c=>u.value=!1)},null,8,["session"])]),_:1},8,["modelValue"]),r(I,{modelValue:n(x),"onUpdate:modelValue":t[3]||(t[3]=c=>q(x)?x.value=c:null),title:"Info Logs"},{default:T(()=>[r(j,{logs:e.results.infoLogs},null,8,["logs"])]),buttons:T(()=>[a("button",{class:"ml-2 p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 focus:outline-none",onClick:_},[n(L)?(l(),S(n(be),{key:0,class:"h-6 w-6","aria-hidden":"true"})):C("",!0),!n(L)&&e.results.infoLogs.length!=0?(l(),S(n(he),{key:1,class:"h-6 w-6","aria-hidden":"true"})):C("",!0)])]),_:1},8,["modelValue"]),r(I,{modelValue:n(M),"onUpdate:modelValue":t[4]||(t[4]=c=>q(M)?M.value=c:null),title:"Error Logs"},{default:T(()=>[r(j,{logs:e.results.errorLogs},null,8,["logs"])]),buttons:T(()=>[a("button",{class:"ml-2 p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 focus:outline-none",onClick:O},[n(v)?(l(),S(n(be),{key:0,class:"h-6 w-6","aria-hidden":"true"})):C("",!0),!n(v)&&e.results.errorLogs.length!=0?(l(),S(n(he),{key:1,class:"h-6 w-6","aria-hidden":"true"})):C("",!0)])]),_:1},8,["modelValue"]),r(Le,{modelValue:n(A),"onUpdate:modelValue":t[6]||(t[6]=c=>q(A)?A.value=c:null),title:"Termination Confirm",description:"Are you sure you want to terminate this session?",type:"info"},{default:T(()=>[r(B,{variant:"solid",color:"red",class:"flex justify-center",label:"Terminate",onClick:t[5]||(t[5]=c=>p((e._.provides[K]||e.$route).params.id))})]),_:1},8,["modelValue"]),e.results.booting?(l(),y("div",zt,[a("div",null,[r(Se,{progress:e.results.progressbar.current},null,8,["progress"])]),e.results.exception.error?C("",!0):(l(),y("h3",{key:0,class:"mt-8 animate-pulse",textContent:H(n(F))},null,8,Ft)),a("div",qt,[e.form.debug_mode?(l(),S(B,{key:0,icon:"i-heroicons-clipboard-document-list",variant:"solid",label:"View Logs",size:"xl",class:"flex justify-center w-64",onClick:t[7]||(t[7]=c=>x.value=!0)})):C("",!0),r(B,{color:"gray",class:"w-64 flex justify-center mt-4",size:"xl",ui:{color:{gray:{solid:"text-rose-500 dark:text-rose-400"}}},icon:"i-heroicons-no-symbol",variant:"solid",label:"Cancel",trailing:!1,onClick:t[8]||(t[8]=c=>n(re)((e._.provides[K]||e.$route).params.id))})]),e.results.exception.error?(l(),y("div",Ht,[r(me,{modelValue:n(b),"onUpdate:modelValue":t[9]||(t[9]=c=>q(b)?b.value=c:null),title:e.results.exception.error,content:e.results.exception.traceback,mode:"live","debug-mode":e.form.debug_mode},null,8,["modelValue","title","content","debug-mode"])])):C("",!0)])):(l(),S(Ue,{key:1},{left:T(()=>[!e.results.booting&&!e.results.monitoring&&!e.results.showResults?(l(),y("div",Wt,[r(J,{class:"mb-4",title:"Exchange"}),e.form.paper_mode?(l(),S(ie,{key:0,modelValue:e.form.exchange,"onUpdate:modelValue":t[10]||(t[10]=c=>e.form.exchange=c),placeholder:"Select an exchange...",searchable:"",options:n(se),"value-attribute":"value",size:"lg",class:"mt-2 mb-16"},null,8,["modelValue","options"])):(l(),S(ie,{key:1,modelValue:e.form.exchange_api_key_id,"onUpdate:modelValue":t[11]||(t[11]=c=>e.form.exchange_api_key_id=c),placeholder:"Select an exchange...",searchable:"",options:n(oe),"value-attribute":"value",size:"lg",class:"mt-2 mb-16"},{empty:T(()=>[a("div",Yt,[t[23]||(t[23]=a("span",null," No exchange API keys found. Please add at least one: ",-1)),r(B,{to:"/exchange-api-keys",icon:"i-heroicons-plus",type:"link",variant:"solid",size:"sm",label:"Add Exchange API Key"})])]),_:1},8,["modelValue","options"])),r(Pe,{"total-routes-error":n($),form:e.form,results:e.results,mode:"live",symbols:n(g),timeframes:n(te)},null,8,["total-routes-error","form","results","symbols","timeframes"]),r(J,{class:"mt-16 mb-4",title:"Options"}),a("div",Zt,[r(fe,{modelValue:e.form.debug_mode,"onUpdate:modelValue":t[12]||(t[12]=c=>e.form.debug_mode=c),title:"Debug Mode",description:"Logs more details, helpful for debugging."},null,8,["modelValue"]),r(fe,{modelValue:e.form.paper_mode,"onUpdate:modelValue":t[13]||(t[13]=c=>e.form.paper_mode=c),title:"Paper Trade",disabled:!n(R),"disabled-guide":n(R)?"":"Premium plan required",description:"Trade in real-time using actual exchange data with PAPER money."},null,8,["modelValue","disabled","disabled-guide"]),r(Ie,{label:"Notifications:",help:"Select a notification driver to receive notifications"},{default:T(()=>[r(ie,{modelValue:e.form.notification_api_key_id,"onUpdate:modelValue":t[14]||(t[14]=c=>e.form.notification_api_key_id=c),placeholder:"Select a notification driver",size:"lg",options:n(k),"value-attribute":"value"},{empty:T(()=>[a("div",Gt,[t[24]||(t[24]=a("span",null," No notification API keys found. Please add at least one: ",-1)),r(B,{to:"/notification-api-keys",icon:"i-heroicons-plus",type:"link",variant:"solid",size:"sm",label:"Add Notification API Key"})])]),_:1},8,["modelValue","options"])]),_:1})])])):C("",!0),e.results.monitoring?(l(),y("div",Qt,[e.results.exception.error?(l(),y("div",Jt,[r(me,{title:e.results.exception.error,content:e.results.exception.traceback,mode:"live","debug-mode":e.form.debug_mode},null,8,["title","content","debug-mode"])])):C("",!0),e.results.displayTab&&e.results.monitoring&&!e.results.finished&&!e.results.exception.error?(l(),S(Ee,{key:1,results:e.results,form:e.form,exchange:e.form.exchange},null,8,["results","form","exchange"])):C("",!0),r(J,{class:"mb-4",title:"Routes"}),r(ue,{data:e.results.routes,"header-items":["Symbol","Timeframe","Strategy"],header:""},null,8,["data"]),r(J,{class:"mt-12 mb-4",title:"Positions"}),r(ue,{data:e.results.positions,"header-items":["Symbol","QTY","Entry","Price","Liq Price","PNL"],header:""},null,8,["data"]),r(je,{class:"mt-12 mb-4",title:"Orders"},{default:T(()=>[a("button",{type:"button",class:"inline-flex items-center shadow-sm px-4 py-1.5 border border-gray-300 dark:border-gray-900 text-sm leading-5 font-medium rounded-full text-gray-700 dark:text-gray-100 bg-white dark:bg-backdrop-dark hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none",onClick:t[15]||(t[15]=c=>m.value=!0)},[r(n(_t),{class:"-ml-1.5 mr-1 h-5 w-5 text-gray-400","aria-hidden":"true"}),t[25]||(t[25]=a("span",null,"More",-1))])]),_:1}),r(ue,{data:n(ee),"header-items":["Created","Symbol","Type","Side","Price","QTY","Status"],header:""},null,8,["data"])])):C("",!0)]),right:T(()=>[e.results.booting?C("",!0):(l(),y("div",Kt,[e.results.monitoring?(l(),y("div",Xt,[e.results.finished?(l(),S(B,{key:0,class:"w-full flex justify-center",variant:"solid",icon:"i-heroicons-plus",size:"xl",label:"New session",onClick:t[16]||(t[16]=c=>n(ae)((e._.provides[K]||e.$route).params.id))})):(l(),S(B,{key:1,class:"w-full flex justify-center",variant:"solid",color:"gray",icon:"i-heroicons-no-symbol",size:"xl",label:e.results.terminating?"Terminating...":"Terminate",ui:{color:{gray:{solid:"text-rose-500 dark:text-rose-400"}}},onClick:t[17]||(t[17]=c=>A.value=!0)},null,8,["label"])),e.results.monitoring||e.results.finished?(l(),S(B,{key:2,class:"w-full flex justify-center mt-4",variant:"solid",color:"gray",icon:"i-heroicons-flag",size:"xl",label:"Report",onClick:t[18]||(t[18]=c=>u.value=!0)})):C("",!0)])):(l(),y("div",es,[r(B,{class:"w-full flex justify-center",icon:"i-heroicons-bolt",size:"xl",variant:"solid",label:"Start",trailing:!1,onClick:t[19]||(t[19]=c=>ne((e._.provides[K]||e.$route).params.id))}),Object.keys(e.tabs).length>1?(l(),S(B,{key:0,class:"w-full md:hidden flex justify-center mt-2",icon:"i-heroicons-x-mark",size:"xl",variant:"solid",color:"gray",label:"Close Tab",trailing:!1,onClick:t[20]||(t[20]=c=>d((e._.provides[K]||e.$route).params.id))})):C("",!0)]))])),e.results.monitoring?(l(),y("hr",ts)):C("",!0),e.results.monitoring?(l(),y("dl",ss,[(l(!0),y(G,null,ce(n(z),c=>(l(),y("div",{key:c.label,class:"flex justify-between items-center"},[a("div",os,H(c.label)+":",1),a("div",rs,H(c.value),1)]))),128)),a("div",ns,[a("div",ls,[a("button",{class:"text-sm font-medium text-gray-500 hover:text-gray-600 dark:text-gray-400 dark:hover:text-gray-300 truncate flex items-center hover:underline cursor-pointer focus:outline-none",onClick:t[21]||(t[21]=c=>x.value=!0)},[t[26]||(t[26]=a("span",null,"Info Logs:",-1)),a("span",as,[r(n(ke),{class:"w-6 h-6 ml-2"})])])]),a("div",is,H(e.results.generalInfo.count_info_logs),1)]),a("div",us,[a("div",ds,[a("button",{class:"text-sm font-medium text-gray-500 hover:text-gray-600 dark:text-gray-400 dark:hover:text-gray-300 truncate flex items-center hover:underline cursor-pointer focus:outline-none",onClick:t[22]||(t[22]=c=>M.value=!0)},[t[27]||(t[27]=a("span",null,"Error Logs:",-1)),a("span",cs,[r(n(ke),{class:"w-6 h-6 ml-2 cursor-pointer"})])])]),a("div",ms,H(e.results.generalInfo.count_error_logs),1)])])):C("",!0),e.results.monitoring&&Object.keys(e.results.watchlist).length?(l(),y("div",fs,[r(J,{class:"mt-8 mb-4",title:"Watch List"}),r(Me,{data:e.results.watchlist[`${s.form.exchange}-${e.results.selectedRoute.symbol}-${e.results.selectedRoute.timeframe}`]||[]},null,8,["data"])])):C("",!0)]),_:1}))],64)}}}),gs={class:"w-full"},Ts=Z({__name:"[id]",setup(P){ht({title:"Live/Paper trading - Jesse"});const s=Q(),$=V(()=>s.tabs),b=xe(),h=V(()=>b.params.id),o=V(()=>$.value[h.value]);(!Object.keys(o.value).includes("selectedRoute")||Object.keys(o.value.results.selectedRoute).length==0||L(o.value.results.selectedRoute,o.value.form.routes[0]))&&(o.value.results.selectedRoute=o.value.form.routes[0]),o.value.form.exchange==""&&(o.value.form.exchange=o.value.results.generalInfo.exchange),Object.keys($.value).length===0&&Q().addTab();function L(v,m){return!v||!m?!1:v.symbol===m.symbol&&v.timeframe===m.timeframe&&v.strategy===m.strategy}return bt({w:()=>{const v=b.params.id;v&&s.closeTab(v)},ArrowLeft:()=>s.goToPrevTab(h.value),ArrowRight:()=>s.goToNextTab(h.value)}),(v,m)=>{const u=St,x=ps;return l(),y(G,null,[a("div",gs,[r(u,{"current-tab":o.value?o.value.id:null,tabs:$.value,onClose:n(s).closeTab,onCancel:n(s).cancel},null,8,["current-tab","tabs","onClose","onCancel"])]),o.value?(l(),S(x,{key:0,form:o.value.form,results:o.value.results,session:h.value,tabs:$.value},null,8,["form","results","session","tabs"])):C("",!0)],64)}}});export{Ts as default};
