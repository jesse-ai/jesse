import{d as G,a3 as J,x as P,c as k,r as y,P as x,H as W,w as N,e as q,f as c,g as v,j as o,i as s,t as O,z as h,G as w,a6 as A,W as K,k as Q,aw as X,a7 as Y,q as V,I as Z,J as ee,L as C,a8 as ae,s as z,y as te}from"./BZBcjETW.js";import{_ as le}from"./BAhmbuaU.js";import{_ as se}from"./bNiC0h8c.js";import{_ as oe}from"./CroKzFWd.js";import{_ as ne}from"./CNlI_mjZ.js";import{u as ie}from"./D-92rLZE.js";const ue={class:"flex items-center select-none flex-1 mb-4"},re={class:"space-y-4"},me={class:"flex items-center"},de={class:"flex items-center"},ce={key:0},pe={class:"space-y-4"},ve={class:"flex items-center gap-2 mb-2"},_e={class:"flex justify-between"},fe={class:"flex gap-2 mb-3 flex-wrap"},ge={class:"text-xs text-gray-500 dark:text-gray-400 mt-1"},be={key:0},ye={key:0,class:"space-y-4"},xe={class:"grid grid-cols-1 gap-6"},he=G({__name:"index",setup(Ve){ie({title:"Monte Carlo - Jesse"});const M=J(),D=P(),a=k(()=>D.form),_=y(!1),f=y([]),S=[{label:"1 Day",value:1440},{label:"3 Days",value:4320},{label:"7 Days",value:10080},{label:"14 Days",value:20160}],i=y("custom"),B=k(()=>{var l;return typeof a.value.pipeline_type=="string"?a.value.pipeline_type:((l=a.value.pipeline_type)==null?void 0:l.value)||"moving_block_bootstrap"}),I=k(()=>x().jesseSupportedTimeframes.map(l=>({label:l,value:l})));W(()=>{setTimeout(()=>{$(),R()},50)});function R(){const l=a.value.pipeline_params.batch_size,e=S.find(n=>n.value===l);i.value=e?e.value:"custom"}function U(l){i.value=l,l!=="custom"&&(a.value.pipeline_params.batch_size=l)}N(()=>a.value.pipeline_params.batch_size,l=>{const e=S.find(n=>n.value===l);e&&i.value!==e.value?i.value=e.value:!e&&i.value!=="custom"&&(i.value="custom")}),N(()=>B.value,l=>{if(l==="gaussian"){const e=a.value.pipeline_params;(e.close_sigma===void 0||e.close_sigma===null)&&(e.close_sigma=.001),(e.high_sigma===void 0||e.high_sigma===null)&&(e.high_sigma=1e-4),(e.low_sigma===void 0||e.low_sigma===null)&&(e.low_sigma=1e-4)}});const g=y([]);async function $(){g.value=await x().getExchangeSupportedSymbols(a.value.exchange);for(let l=0;l<a.value.routes.length;l++)g.value.includes(a.value.routes[l].symbol)||(a.value.routes[l].symbol=g.value[0])}a.value.exchange=a.value.exchange||x().backtestingExchangeNames[0];function E(l){const e=l.slice(-1),n=parseInt(l.slice(0,-1));switch(e){case"m":return n;case"h":return n*60;case"D":return n*24*60;default:return 0}}async function L(){if(f.value.length){for(let u=0;u<f.value.length;u++)z("error",f.value[u]);return}if(!a.value.run_trades&&!a.value.run_candles){z("error","Please select at least one simulation type (Trades or Candles).");return}const l=a.value.pipeline_params.batch_size,e=1440;if(l<e){z("error",`Batch size must be at least ${e} minutes (1 day). Current: ${l} minutes.`);return}const b=[...a.value.routes,...a.value.data_routes].map(u=>u.timeframe);let m=1/0;for(const u of b){const r=E(u);r>0&&r<m&&(m=r)}if(m===1/0&&(m=1),l%m!==0){z("error",`Batch size (${l} minutes) must be a multiple of the minimum timeframe (${m} minutes).`);return}_.value=!0;const d=await P().start();d&&d.status&&d.status==="success"&&T(`/monte-carlo/${d.id}?status=running`),_.value=!1}function T(l){M.push(l)}return(l,e)=>{const n=A,b=le,m=se,d=Q,u=X,r=Y,p=O,j=oe,F=ae,H=ne;return v(),q(H,null,{left:c(()=>[s(n,{class:"mb-4",title:"Exchange"}),s(b,{modelValue:a.value.exchange,"onUpdate:modelValue":e[0]||(e[0]=t=>a.value.exchange=t),placeholder:"Select an exchange...",searchable:"",options:K(x)().backtestingExchangeNames,size:"lg",class:"mt-2 mb-16",onChange:$},null,8,["modelValue","options"]),s(m,{"total-routes-error":f.value,form:a.value,symbols:g.value,timeframes:I.value},null,8,["total-routes-error","form","symbols","timeframes"]),s(n,{class:"mt-16 mb-4",title:"Duration"}),o("div",ue,[s(d,{modelValue:a.value.start_date,"onUpdate:modelValue":e[1]||(e[1]=t=>a.value.start_date=t),type:"date",variant:"outline",size:"lg",class:"w-full mr-2"},null,8,["modelValue"]),s(d,{modelValue:a.value.finish_date,"onUpdate:modelValue":e[2]||(e[2]=t=>a.value.finish_date=t),type:"date",variant:"outline",size:"lg",class:"w-full ml-2"},null,8,["modelValue"])]),s(n,{class:"mt-16 mb-4",title:"Simulation Types"}),o("div",re,[o("div",me,[s(u,{modelValue:a.value.run_trades,"onUpdate:modelValue":e[3]||(e[3]=t=>a.value.run_trades=t),label:"Run Trades Simulation"},null,8,["modelValue"])]),o("div",de,[s(u,{modelValue:a.value.run_candles,"onUpdate:modelValue":e[4]||(e[4]=t=>a.value.run_candles=t),label:"Run Candles Simulation"},null,8,["modelValue"])])]),s(n,{class:"mt-16 mb-4",title:"Scenarios"}),s(r,{modelValue:a.value.num_scenarios,"onUpdate:modelValue":e[5]||(e[5]=t=>a.value.num_scenarios=t),title:"Number of scenarios:"},null,8,["modelValue"]),a.value.run_candles?(v(),h("div",ce,[s(n,{class:"mt-16 mb-4",title:"Pipeline Configuration"}),o("div",pe,[o("div",null,[e[15]||(e[15]=o("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-200 mb-2 block"},"Pipeline Type",-1)),s(b,{modelValue:a.value.pipeline_type,"onUpdate:modelValue":e[6]||(e[6]=t=>a.value.pipeline_type=t),options:[{label:"Moving Block Bootstrap",value:"moving_block_bootstrap"},{label:"Gaussian Noise",value:"gaussian"}],size:"lg"},null,8,["modelValue"])]),o("div",null,[o("div",ve,[e[17]||(e[17]=o("label",{class:"text-sm font-medium text-gray-700 dark:text-gray-200"}," Batch Size ",-1)),s(j,{mode:"hover",popper:{placement:"top"}},{panel:c(()=>e[16]||(e[16]=[o("div",{class:"p-4 max-w-sm"},[o("h3",{class:"font-semibold text-sm mb-2"},"What is Batch Size?"),o("p",{class:"text-xs text-gray-600 dark:text-gray-400 mb-2"}," The batch size controls how many 1-minute candles are processed together in each regeneration cycle. "),o("p",{class:"text-xs text-gray-600 dark:text-gray-400 mb-2"},[o("strong",null,"Larger values"),V(" (e.g., 7-14 days) preserve longer-term market patterns and trends, making simulations more realistic. ")]),o("p",{class:"text-xs text-gray-600 dark:text-gray-400"},[o("strong",null,"Smaller values"),V(" (e.g., 1-3 days) create more variation between scenarios but may lose longer-term dependencies. ")])],-1)])),default:c(()=>[s(p,{icon:"i-heroicons-information-circle",size:"2xs",color:"gray",variant:"ghost",ui:{rounded:"rounded-full"}})]),_:1})]),o("div",_e,[o("div",fe,[(v(),h(Z,null,ee(S,t=>s(p,{key:t.value,color:i.value===t.value?"primary":"gray",variant:i.value===t.value?"solid":"soft",size:"sm",onClick:ze=>U(t.value)},{default:c(()=>[V(C(t.label),1)]),_:2},1032,["color","variant","onClick"])),64)),s(p,{color:i.value==="custom"?"primary":"gray",variant:i.value==="custom"?"solid":"soft",size:"sm",onClick:e[7]||(e[7]=t=>U("custom"))},{default:c(()=>e[18]||(e[18]=[V(" Custom ")])),_:1},8,["color","variant"])]),o("div",null,[o("p",ge,C(a.value.pipeline_params.batch_size)+" minutes ("+C(Number((a.value.pipeline_params.batch_size/(24*60)).toFixed(1)))+" days) ",1)])]),i.value==="custom"?(v(),h("div",be,[s(r,{modelValue:a.value.pipeline_params.batch_size,"onUpdate:modelValue":e[8]||(e[8]=t=>a.value.pipeline_params.batch_size=t),title:"Batch Size (in minutes):",min:1,step:60},null,8,["modelValue"])])):w("",!0)]),B.value==="gaussian"?(v(),h("div",ye,[s(r,{modelValue:a.value.pipeline_params.close_sigma,"onUpdate:modelValue":e[9]||(e[9]=t=>a.value.pipeline_params.close_sigma=t),title:"Close Sigma:"},null,8,["modelValue"]),s(r,{modelValue:a.value.pipeline_params.high_sigma,"onUpdate:modelValue":e[10]||(e[10]=t=>a.value.pipeline_params.high_sigma=t),title:"High Sigma:"},null,8,["modelValue"]),s(r,{modelValue:a.value.pipeline_params.low_sigma,"onUpdate:modelValue":e[11]||(e[11]=t=>a.value.pipeline_params.low_sigma=t),title:"Low Sigma:"},null,8,["modelValue"])])):w("",!0)])])):w("",!0),s(n,{class:"mt-16 mb-4",title:"Options"}),o("div",xe,[s(F,{modelValue:a.value.fast_mode,"onUpdate:modelValue":e[12]||(e[12]=t=>a.value.fast_mode=t),title:"Fast Mode",description:"Runs the simulation faster using an improved algorithm."},null,8,["modelValue"])])]),right:c(()=>[o("div",null,[s(p,{class:"w-full flex justify-center",icon:"i-heroicons-bolt",size:"xl",variant:"solid",label:"Start",disabled:_.value,loading:_.value,trailing:!1,onClick:e[13]||(e[13]=t=>L())},null,8,["disabled","loading"]),s(p,{class:"w-full flex justify-center mt-4",icon:"i-heroicons-clock",size:"xl",variant:"solid",color:"gray",label:"History",trailing:!1,onClick:e[14]||(e[14]=t=>T("/monte-carlo/history"))})])]),_:1})}}}),$e=te(he,[["__scopeId","data-v-e3add9b7"]]);export{$e as default};
