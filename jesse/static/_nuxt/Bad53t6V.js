import{d as R,r as g,a0 as T,e as b,g as _,at as ae,f as n,j as s,i as l,G as y,t as z,x as t,au as te,C as D,E as A,D as B,aa as G,a8 as F,h as Y,s as c,ah as W,c as N,av as se,q as S,aw as le,ab as oe,k as ne,F as re,O as ie,ax as de,_ as ue,z as pe,ac as ce}from"./CU_MfyYc.js";import{_ as me}from"./CqvT4tPC.js";import{_ as ye}from"./D35nYK_C.js";import{S as fe}from"./CRzUWN8h.js";import{u as _e}from"./Cwg39VG_.js";const ve={class:"flex justify-between items-center mb-2"},xe={class:"text-xl font-bold"},ge={class:"text-sm text-gray-500 dark:text-gray-400"},he={class:"mt-4"},ke={class:"flex justify-between"},we={class:"font-medium"},be={class:"flex justify-between"},Ae={class:"font-medium"},Pe={key:0},Ke={class:"flex justify-between"},Ve={class:"flex justify-between"},Ie={class:"flex justify-between"},Ce=R({__name:"ExchangeApiKey",props:{apiKey:{}},setup(H){const P=H,f=g(!1),a=g(!1),h=T();async function K(){a.value=!0;const{data:i,error:r}=await F("/exchange/api-keys/delete",{id:P.apiKey.id},!0);if(a.value=!1,r.value&&r.value.statusCode!==200){Y(r);return}f.value=!1,c("success","API Key deleted successfully"),h.exchangeApiKeys=h.exchangeApiKeys.filter(k=>k.id!==P.apiKey.id)}return(i,r)=>{const k=z,x=G,V=ae;return _(),b(V,{class:"mb-4 p-4 bg-white"},{default:n(()=>[s("div",ve,[s("h2",xe,y(i.apiKey.name)+" â€¢ "+y(i.apiKey.exchange),1),l(k,{icon:"i-heroicons-trash",color:"red",label:"Delete",variant:"link",onClick:r[0]||(r[0]=I=>f.value=!0)})]),s("p",ge,y(t(te)(i.apiKey.created_at).value),1),s("div",he,[s("div",ke,[s("span",we,y(i.apiKey.exchange.includes("Hyperliquid")?"Wallet Address:":"API Key:"),1),s("span",null,y(i.apiKey.api_key),1)]),s("div",be,[s("span",Ae,y(i.apiKey.exchange.includes("Hyperliquid")?"Private Key:":"API Secret:"),1),s("span",null,y(i.apiKey.api_secret),1)]),i.apiKey.exchange.startsWith("Apex")?(_(),D("div",Pe,[s("div",Ke,[r[2]||(r[2]=s("span",{class:"font-medium"},"API Passphrase:",-1)),s("span",null,y(i.apiKey.api_passphrase),1)]),s("div",Ve,[r[3]||(r[3]=s("span",{class:"font-medium"},"Wallet Address:",-1)),s("span",null,y(i.apiKey.wallet_address),1)]),s("div",Ie,[r[4]||(r[4]=s("span",{class:"font-medium"},"Omni/Stark Key:",-1)),s("span",null,y(i.apiKey.stark_private_key),1)])])):A("",!0)]),l(x,{modelValue:t(f),"onUpdate:modelValue":r[1]||(r[1]=I=>B(f)?f.value=I:null),title:"Delete API Key",description:`Are you sure you want to delete '${i.apiKey.name}' API key?`,type:"info"},{default:n(()=>[l(k,{variant:"solid",color:"red",block:"",class:"sm:w-auto",label:"Delete",loading:t(a),onClick:K},null,8,["loading"])]),_:1},8,["modelValue","description"])]),_:1})}}}),Se={class:"flex justify-between items-start mb-4"},Ue={class:"flex gap-2 mt-1"},Ee={class:"flex justify-end"},$e={class:"mt-8"},qe={key:0},je={class:"flex items-center gap-2"},Fe={class:"space-y-4"},Me={class:"border-2 border-dashed border-gray-300 dark:border-gray-700 rounded-lg p-6 text-center hover:border-primary-400 dark:hover:border-primary-600 transition-colors"},Ne={for:"csv-file",class:"cursor-pointer flex flex-col items-center gap-3"},De={class:"text-sm font-medium text-gray-700 dark:text-gray-300"},Be={class:"flex justify-end gap-3"},Te=R({__name:"exchange-api-keys",setup(H){_e({title:"Exchange API Keys"});const P=g(!1),f=T(),a=W({exchange:f.liveTradingExchangeNames[0],name:"",apiKey:"",apiSecret:"",apiPassphrase:"",walletAddress:"",stark_private_key:""}),h=N(()=>f.exchangeApiKeys),K=N(()=>a.exchange.startsWith("Apex")),i=g(!1),r=g(!1),k=g(!1),x=g(null),V=g(!1),I=g(""),C=W({password:""}),L=N(()=>a.exchange.startsWith("Apex")?a.exchange&&a.apiKey&&a.apiSecret&&a.apiPassphrase&&a.walletAddress&&a.stark_private_key:a.exchange&&a.apiKey&&a.apiSecret);async function J(){if(!L.value){c("error","Please fill in all required fields");return}P.value=!0;const m={name:a.name,exchange:a.exchange,api_key:a.apiKey,api_secret:a.apiSecret};K.value&&(m.additional_fields={api_passphrase:a.apiPassphrase,wallet_address:a.walletAddress,stark_private_key:a.stark_private_key});const{data:e,error:d}=await F("/exchange/api-keys/store",m,!0);P.value=!1,d.value&&d.value.statusCode!==200&&Y(d);const u=e.value;u.status==="success"?(c("success","Successfully added API key"),h.value.push(u.data),Z()):u.status==="error"&&c("error",u.message)}async function O(){var m,e,d,u;if(!C.password){c("error","Please fill password!");return}V.value=!0;try{const{data:U,error:p}=await F("/download/download-api-keys",{password:C.password},!0);if(p!=null&&p.value){p.value.statusCode===401?c("error","Incorrect password"):c("error",((m=p.value.data)==null?void 0:m.message)||"Failed to download API keys"),V.value=!1;return}const v=(u=(d=(e=p.value)==null?void 0:e.data)==null?void 0:d.headers)==null?void 0:u.get("Content-Disposition");let q="api-keys.csv";if(v){const E=v.match(/filename="?(.+)"?/i);E&&E[1]&&(q=decodeURIComponent(E[1].replace(/['"]/g,"")))}const M=new Blob([U.value],{type:"text/csv"}),j=window.URL.createObjectURL(M),w=document.createElement("a");w.href=j,w.download=q,document.body.appendChild(w),w.click(),window.URL.revokeObjectURL(j),document.body.removeChild(w),c("success","API keys downloaded successfully"),i.value=!1,C.password=""}catch(U){c("error",`Failed to download API keys: ${U.message}`)}finally{V.value=!1}}async function Q(m){var d;const e=(d=m.target.files)==null?void 0:d[0];e&&e.type==="text/csv"?(I.value=e.name,x.value=await e.text()):alert("Please select a valid CSV file")}async function X(){if(x.value){k.value=!0;try{const{data:m,error:e}=await F("/download/import-api-keys",{content:x.value},!0);if(e.value){c("error",e.value);return}f.fetchExchangeApiKeys();const d=m.value;if(d.success){c("success",`${d.imported_count} API keys imported successfully`),r.value=!1,$();return}c("error",d.error)}catch(m){c("error",m)}finally{k.value=!1}}}function $(){x.value=null,I.value=""}function Z(){a.exchange=f.liveTradingExchangeNames[0],a.name="",a.apiKey="",a.apiSecret="",a.apiPassphrase="",a.walletAddress="",a.stark_private_key=""}return(m,e)=>{const d=se,u=z,U=me,p=oe,v=ne,q=le,M=ye,j=G,w=ce,E=pe,ee=ue;return _(),b(fe,null,{default:n(()=>[s("div",Se,[l(d,null,{default:n(()=>e[13]||(e[13]=[S(" Exchange API Keys ")])),_:1}),s("div",Ue,[l(u,{icon:"i-heroicons-arrow-down-tray",color:"white",size:"sm",label:"Export",onClick:e[0]||(e[0]=o=>i.value=!0)}),l(u,{icon:"i-heroicons-arrow-up-tray",color:"white",size:"sm",label:"Import",onClick:e[1]||(e[1]=o=>r.value=!0)})])]),e[20]||(e[20]=s("p",null,[S(" Here you can add your API keys for various exchanges. API keys are used to connect your account to the exchange and allow the bot to trade on your behalf. "),s("br"),s("br"),S("Please note that for security reasons, once created, API keys cannot be modified or seen again. ")],-1)),e[21]||(e[21]=s("br",null,null,-1)),l(q,{state:t(a),class:"space-y-4",onSubmit:J},{default:n(()=>[l(p,{label:"Exchange name:",required:""},{default:n(()=>[l(U,{modelValue:t(a).exchange,"onUpdate:modelValue":e[2]||(e[2]=o=>t(a).exchange=o),searchable:"",options:t(f).liveTradingExchangeNames},null,8,["modelValue","options"])]),_:1}),l(p,{label:"Name:",required:""},{default:n(()=>[l(v,{modelValue:t(a).name,"onUpdate:modelValue":e[3]||(e[3]=o=>t(a).name=o),type:"text",placeholder:"Give a name to this API key (e.g. subaccount1)"},null,8,["modelValue"])]),_:1}),l(p,{label:t(a).exchange.includes("Hyperliquid")?"Wallet Address":"API Key:",required:""},{default:n(()=>[l(v,{modelValue:t(a).apiKey,"onUpdate:modelValue":e[4]||(e[4]=o=>t(a).apiKey=o),placeholder:t(a).exchange.includes("Hyperliquid")?"Enter your wallet address here (0x123...)":"Enter your API key here",type:"text"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),l(p,{label:t(a).exchange.includes("Hyperliquid")?"Private Key":"API Secret:",required:""},{default:n(()=>[l(v,{modelValue:t(a).apiSecret,"onUpdate:modelValue":e[5]||(e[5]=o=>t(a).apiSecret=o),placeholder:t(a).exchange.includes("Hyperliquid")?"Enter your private key here":"Enter your API secret here",type:"text"},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(K)?(_(),b(p,{key:0,label:"API Passphrase:",required:""},{default:n(()=>[l(v,{modelValue:t(a).apiPassphrase,"onUpdate:modelValue":e[6]||(e[6]=o=>t(a).apiPassphrase=o),placeholder:"Enter your API passphrase here",type:"text"},null,8,["modelValue"])]),_:1})):A("",!0),t(K)?(_(),b(p,{key:1,label:"Wallet Address:",required:""},{default:n(()=>[l(v,{modelValue:t(a).walletAddress,"onUpdate:modelValue":e[7]||(e[7]=o=>t(a).walletAddress=o),placeholder:"Enter your wallet address here",type:"text"},null,8,["modelValue"])]),_:1})):A("",!0),t(K)?(_(),b(p,{key:2,label:"Omni/Stark Key:",required:""},{default:n(()=>[l(v,{modelValue:t(a).stark_private_key,"onUpdate:modelValue":e[8]||(e[8]=o=>t(a).stark_private_key=o),placeholder:"Enter your Omni key (for Apex Omni) or Stark key (for Apex Pro) here",type:"text"},null,8,["modelValue"])]),_:1})):A("",!0),s("div",Ee,[l(u,{type:"submit",icon:"i-i-heroicons-x-mark-plus",class:"w-48 flex justify-center",label:"Create",loading:t(P),disabled:!t(L)},null,8,["loading","disabled"])])]),_:1},8,["state"]),s("div",$e,[l(d,null,{default:n(()=>[e[14]||(e[14]=S(" Previously Added ")),t(h).length?(_(),D("span",qe,"("+y(t(h).length)+")",1)):A("",!0)]),_:1}),t(h).length?A("",!0):(_(),b(M,{key:0},{default:n(()=>e[15]||(e[15]=[S(" No API keys added yet ")])),_:1})),(_(!0),D(re,null,ie(t(h),o=>(_(),b(Ce,{key:o.id,"api-key":o},null,8,["api-key"]))),128))]),l(j,{modelValue:t(i),"onUpdate:modelValue":e[10]||(e[10]=o=>B(i)?i.value=o:null),title:"Export API Keys",type:"warning",description:"You are about to export all your exchange API keys to a CSV file. This file will contain sensitive credentials in plain text. Please enter your password to confirm."},{fields:n(()=>[l(p,{label:"Password",required:"",class:"mt-2"},{default:n(()=>[l(v,{modelValue:t(C).password,"onUpdate:modelValue":e[9]||(e[9]=o=>t(C).password=o),type:"password",placeholder:"Enter your password",class:"w-full",ui:{icon:{trailing:{color:"text-gray-500 dark:text-gray-400"}}},onKeyup:de(O,["enter"])},null,8,["modelValue"])]),_:1})]),default:n(()=>[l(u,{variant:"solid",color:"primary",block:"",class:"sm:w-auto",label:"Export API Keys",loading:t(V),disabled:!t(C).password,onClick:O},null,8,["loading","disabled"])]),_:1},8,["modelValue"]),l(ee,{modelValue:t(r),"onUpdate:modelValue":e[12]||(e[12]=o=>B(r)?r.value=o:null),onClose:$},{default:n(()=>[l(E,null,{header:n(()=>[s("div",je,[l(w,{name:"i-heroicons-arrow-up-tray",class:"w-5 h-5"}),e[16]||(e[16]=s("h3",{class:"text-lg font-semibold"},"Import API Keys from CSV",-1))])]),footer:n(()=>[s("div",Be,[l(u,{color:"gray",variant:"ghost",label:"Cancel",onClick:e[11]||(e[11]=o=>{r.value=!1,$()})}),l(u,{icon:"i-heroicons-arrow-up-tray",color:"primary",label:"Import API Keys",loading:t(k),disabled:!t(x),onClick:X},null,8,["loading","disabled"])])]),default:n(()=>[s("div",Fe,[e[19]||(e[19]=s("p",{class:"text-sm text-gray-600 dark:text-gray-400"}," Select a CSV file containing your API keys. ",-1)),s("div",Me,[s("input",{id:"csv-file",type:"file",class:"hidden",accept:".csv",onChange:Q},null,32),s("label",Ne,[l(w,{name:"i-heroicons-document-arrow-up",class:"w-12 h-12 text-gray-400"}),s("div",null,[s("p",De,y(t(x)?t(I):"Click to select a CSV file"),1),e[17]||(e[17]=s("p",{class:"text-xs text-gray-500 dark:text-gray-400 mt-1"}," or drag and drop ",-1))])]),t(x)?(_(),b(u,{key:0,icon:"i-heroicons-x-mark",color:"red",variant:"soft",size:"xs",class:"mt-3",onClick:$},{default:n(()=>e[18]||(e[18]=[S(" Clear file ")])),_:1})):A("",!0)])])]),_:1})]),_:1},8,["modelValue"])]),_:1})}}});export{Te as default};
