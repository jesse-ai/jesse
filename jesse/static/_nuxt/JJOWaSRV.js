import{_ as C}from"./DummNIKF.js";import{d as E,a4 as I,S as b,c as w,r as p,a0 as _,B as M,e as O,f as V,g as i,C as f,i as e,t as j,j as o,N as D,x as L,k as P,q as F,af as J,ag as q,s as S}from"./CtRP3raE.js";import{_ as A}from"./BsTwEtox.js";import{_ as H}from"./BftU8cE_.js";import{_ as G}from"./CJIcHR_m.js";import{u as K}from"./B71Uh9Gv.js";const Q={key:0,class:"space-y-6"},W={class:"mb-4"},X={class:"space-y-4"},Y={class:"space-y-4"},Z={class:"space-y-3"},ee={class:"flex gap-2"},te={class:"flex gap-2"},se={class:"space-y-4"},ae={class:"space-y-2"},oe={class:"space-y-4"},le={key:1},ne={class:"mb-8"},ie={class:"flex items-center select-none flex-1 mb-4"},ue={class:"flex items-center select-none flex-1 mb-4"},re={class:"select-none"},me={class:"grid grid-cols-1 gap-6"},de={key:0,class:"space-y-4"},ce={key:1},ye=E({__name:"index",setup(pe){K({title:"Optimization - Jesse"});const k=I(),h=b(),a=w(()=>h.form),u=p(!1),v=p(!0),r=p([]),z=w(()=>_().jesseSupportedTimeframes.map(l=>({label:l,value:l})));M(()=>{setTimeout(async()=>{x();try{const t=(sessionStorage.getItem("previousRoute")||"").match(/\/optimization\/[^\/]+$/);if(sessionStorage.removeItem("previousRoute"),!t){const s=await h.getRunningSession();if(s){g(`/optimization/${s}`);return}}}finally{v.value=!1}},50)});const m=p([]);async function x(){m.value=await _().getExchangeSupportedSymbols(a.value.exchange);for(let l=0;l<a.value.routes.length;l++)m.value.includes(a.value.routes[l].symbol)||(a.value.routes[l].symbol=m.value[0])}a.value.exchange=a.value.exchange||_().backtestingExchangeNames[0];async function U(){if(r.value.length){for(let t=0;t<r.value.length;t++)S("error",r.value[t]);return}if(a.value.routes.length>1){S("error","Optimization mode does not support multiple routes at the moment.");return}u.value=!0;const l=await b().start();l&&l.status==="success"&&g(`/optimization/${l.id}?status=running`),u.value=!1}function g(l){k.push(l)}return(l,t)=>{const s=C,d=D,N=A,R=H,c=P,T=J,$=q,y=j,B=G;return i(),O(B,null,{left:V(()=>[v.value?(i(),f("div",Q,[o("div",W,[e(s,{class:"h-4 w-20 mb-2"}),e(s,{class:"h-12 w-full"})]),o("div",X,[e(s,{class:"h-4 w-24"}),e(s,{class:"h-32 w-full"})]),o("div",Y,[e(s,{class:"h-4 w-20"}),o("div",Z,[e(s,{class:"h-4 w-32"}),o("div",ee,[e(s,{class:"h-12 flex-1"}),e(s,{class:"h-12 flex-1"})]),e(s,{class:"h-4 w-32"}),o("div",te,[e(s,{class:"h-12 flex-1"}),e(s,{class:"h-12 flex-1"})])])]),o("div",se,[e(s,{class:"h-4 w-32"}),o("div",ae,[e(s,{class:"h-3 w-full"}),e(s,{class:"h-3 w-3/4"}),e(s,{class:"h-3 w-1/2"})]),e(s,{class:"h-12 w-full"})]),o("div",oe,[e(s,{class:"h-4 w-16"}),e(s,{class:"h-16 w-full"})])])):(i(),f("div",le,[e(d,{class:"mb-4",title:"Exchange"}),e(N,{modelValue:a.value.exchange,"onUpdate:modelValue":t[0]||(t[0]=n=>a.value.exchange=n),placeholder:"Select an exchange...",searchable:"",options:L(_)().backtestingExchangeNames,size:"lg",class:"mt-2 mb-16",onChange:x},null,8,["modelValue","options"]),e(R,{"total-routes-error":r.value,form:a.value,mode:"optimization",symbols:m.value,timeframes:z.value},null,8,["total-routes-error","form","symbols","timeframes"]),e(d,{class:"mt-16 mb-4",title:"Duration"}),o("div",ne,[t[9]||(t[9]=o("h3",{class:"text-sm font-medium text-gray-700 dark:text-gray-200 mb-2"},"Training Period",-1)),o("div",ie,[e(c,{modelValue:a.value.training_start_date,"onUpdate:modelValue":t[1]||(t[1]=n=>a.value.training_start_date=n),type:"date",variant:"outline",size:"lg",class:"w-full mr-2"},null,8,["modelValue"]),e(c,{modelValue:a.value.training_finish_date,"onUpdate:modelValue":t[2]||(t[2]=n=>a.value.training_finish_date=n),type:"date",variant:"outline",size:"lg",class:"w-full ml-2"},null,8,["modelValue"])])]),o("div",null,[t[10]||(t[10]=o("h3",{class:"text-sm font-medium text-gray-700 dark:text-gray-200 mb-2"},"Testing Period",-1)),o("div",ue,[e(c,{modelValue:a.value.testing_start_date,"onUpdate:modelValue":t[3]||(t[3]=n=>a.value.testing_start_date=n),type:"date",variant:"outline",size:"lg",class:"w-full mr-2"},null,8,["modelValue"]),e(c,{modelValue:a.value.testing_finish_date,"onUpdate:modelValue":t[4]||(t[4]=n=>a.value.testing_finish_date=n),type:"date",variant:"outline",size:"lg",class:"w-full ml-2"},null,8,["modelValue"])])]),e(d,{class:"mt-16 mb-4",title:"Optimal Trades"}),o("div",re,[t[11]||(t[11]=o("p",{class:"text-sm text-gray-500 dark:text-gray-400"},[F(" The number that tells Jesse how many trades you would find optimal for your strategy in the targeted time period so that it can filter out those DNAs that cause too few trades. "),o("a",{href:"https://docs.jesse.trade/docs/optimize/executing-the-optimize-mode.html",target:"_blank",class:"font-semibold hover:underline italic"},"More Details...")],-1)),t[12]||(t[12]=o("br",null,null,-1)),e(T,{modelValue:a.value.optimal_total,"onUpdate:modelValue":t[5]||(t[5]=n=>a.value.optimal_total=n),title:"Optimal number of trades:"},null,8,["modelValue"])]),e(d,{class:"mt-16 mb-4",title:"Options"}),o("div",me,[e($,{modelValue:a.value.fast_mode,"onUpdate:modelValue":t[6]||(t[6]=n=>a.value.fast_mode=n),title:"Fast Mode",description:"Runs the backtest faster using an improved algorithm."},null,8,["modelValue"])])]))]),right:V(()=>[v.value?(i(),f("div",de,[e(s,{class:"h-16 w-full"}),e(s,{class:"h-16 w-full"})])):(i(),f("div",ce,[e(y,{class:"w-full flex justify-center",icon:"i-heroicons-bolt",size:"xl",variant:"solid",label:"Start",disabled:u.value,loading:u.value,trailing:!1,onClick:t[7]||(t[7]=n=>U())},null,8,["disabled","loading"]),e(y,{class:"w-full flex justify-center mt-4",icon:"i-heroicons-clock",size:"xl",variant:"solid",color:"gray",label:"History",trailing:!1,onClick:t[8]||(t[8]=n=>g("/optimization/history"))})]))]),_:1})}}});export{ye as default};
