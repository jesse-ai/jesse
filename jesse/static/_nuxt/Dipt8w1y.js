import{d as I,m as _,u as O,A as E,r as c,w as y,c as f,J as a,K as x,e as g,f as M,L as N,g as s,C as d,E as F,x as l,j as L,i as m,M as q,N as z,G as A}from"./CtRP3raE.js";import{_ as j}from"./XB2synLH.js";import{_ as K}from"./BnM2Nhbm.js";const Q={key:0,class:"flex justify-center items-center py-12"},G={key:1},H={key:0},J={key:2,class:"text-center py-12 text-red-600 dark:text-red-400"},W=I({__name:"ClosedTradeDetailsSlideOver",props:_({tradeId:{}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:_(["order-click"],["update:modelValue"]),setup(v,{emit:T}){const i=O(v,"modelValue"),n=v,h=T,k=E(),u=c(!1),o=c(""),e=c(null);y(()=>n.tradeId,async t=>{t&&i.value&&await p()}),y(i,async t=>{t&&n.tradeId&&await p()});async function p(){if(n.tradeId){u.value=!0,o.value="",e.value=null;try{const t=await k.fetchTradeDetails(n.tradeId);t?e.value=t:o.value="Failed to load trade details"}catch(t){o.value=t.message||"Failed to load trade details"}finally{u.value=!1}}}const S=f(()=>e.value?[["ID",e.value.id],["Symbol",e.value.symbol],["Exchange",e.value.exchange],["Strategy",e.value.strategy_name],["Type",e.value.type],["Timeframe",e.value.timeframe],["Leverage",`${e.value.leverage}x`],["Entry Price",a.roundPrice(e.value.entry_price)],["Exit Price",e.value.exit_price?a.roundPrice(e.value.exit_price):"-"],["Quantity",e.value.qty],["Size",a.roundPrice(e.value.size)],["Fee",e.value.fee!==null?a.roundPrice(e.value.fee):"-"],["PNL",e.value.pnl!==null&&e.value.pnl_percentage!==null?`${x.round(e.value.pnl,2)} (${x.round(e.value.pnl_percentage,2)}%)`:"-"],["Opened At",a.timestampToTime(e.value.opened_at)],["Closed At",e.value.closed_at?a.timestampToTime(e.value.closed_at):"-"],["Holding Period",e.value.holding_period!==null?`${Math.round(e.value.holding_period)}s`:"-"],["Status",e.value.status]]:[]),b=f(()=>!e.value||!e.value.orders?[]:e.value.orders.map(t=>[{value:t.id.slice(-12),style:"text-xs font-mono",tooltip:t.id,tag:"code"},{value:t.side,style:a.colorBasedOnSide(t.side)},{value:t.type,style:"text-xs"},{value:t.price?a.roundPrice(t.price):"-",style:"text-xs"},{value:t.qty,style:"text-xs"},{value:t.filled_qty,style:"text-xs"},{value:t.status,style:"text-xs"},{value:a.timestampToTimeOnly(t.created_at),style:"text-xs",tooltip:a.timestampToTime(t.created_at)}]));function V(t){e.value&&e.value.orders&&e.value.orders[t]&&h("order-click",e.value.orders[t].id)}return(t,r)=>{const P=q,C=z,D=j,$=K,w=N;return s(),g(w,{modelValue:i.value,"onUpdate:modelValue":r[0]||(r[0]=B=>i.value=B),size:"big",title:"Trade Details"},{default:M(()=>[l(u)?(s(),d("div",Q,r[1]||(r[1]=[L("div",{class:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600"},null,-1)]))):l(e)?(s(),d("div",G,[m(P,{data:l(S)},null,8,["data"]),m(C,{class:"mt-8 mb-4",title:"Orders"}),l(e).orders&&l(e).orders.length?(s(),d("div",H,[m(D,{data:l(b),"header-items":["ID","Side","Type","Price","QTY","Filled","Status","Created"],header:"",clickable:!0,onRowClick:V},null,8,["data"])])):(s(),g($,{key:1}))])):l(o)?(s(),d("div",J,A(l(o)),1)):F("",!0)]),_:1},8,["modelValue"])}}});export{W as _};
