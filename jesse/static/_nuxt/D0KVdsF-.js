import{u as b,S as O}from"./wDR_2eJJ.js";import{aD as W,aE as K,aF as M,d as P,r as _,c as h,a6 as j,a as A,w,B as G,o as J,a0 as T,aG as q,C as I,j as g,i as n,f as u,x as v,D as E,F as Q,s as $,l as X,aa as Y,g as Z,G as ee,t as te,q as f,p as oe,J as ae,a4 as ne}from"./B4BPTRlB.js";import{_ as se}from"./BusspaHq.js";import{u as ie}from"./C1hERgHN.js";function re(){const{$connectPyrightLsp:k}=W();function p(o,l,d){var c;const i=K.parse(`file:///${l}`);let a=M.getModel(i);return a?a.setValue(d.value):a=M.createModel(d.value,"python",i),(c=o.getModel())==null||c.dispose(),o.setModel(a),a.onDidChangeContent(()=>{d.value=a.getValue()}),a}return{onEditorLoaded:async(o,l,d,i,a)=>{const c=await b().getStrategy(l);return i.value=c,p(o,d,i),a&&o.updateOptions(a),k(o),c}}}const le=oe(se),de={class:"grid items-start lg:grid-cols-5"},ce={class:"grid grid-cols-1 lg:col-span-4 bg-backdrop dark:bg-backdrop-dark"},ue={class:"h-10 flex items-center justify-between px-4"},pe={class:"font-semibold"},ge={class:"flex items-center select-none"},me={class:"overflow-hidden border-l border-t dark:border-gray-600"},he=P({__name:"[name]",setup(k){const p=_(!1),s=h(()=>j().params.name),o=_(""),l=_(""),d=A(),i=h(()=>d.value==="light"?"vs-light":"vs-dark"),a=_(),{onEditorLoaded:c}=re();ie({title:`${s.value} - Jesse`}),w(i,t=>{a.value.$editor.updateOptions({theme:t})});async function B(t){const e=`strategies/${s.value}/__init__.py`,S=await c(t,s.value,e,o,{theme:i.value});l.value=S}G(async()=>{window.addEventListener("keydown",L)}),J(()=>{window.removeEventListener("keydown",L)});const C=h(()=>o.value!==l.value),r=h(()=>T().settings.editor),D={automaticLayout:!0,minimap:{enabled:r.value.minimap},fontSize:r.value.fontSize,padding:{top:16,bottom:16},cursorStyle:r.value.cursorStyle,cursorWidth:r.value.cursorWidth,lineHeight:r.value.lineHeight,cursorBlinking:r.value.cursorBlinking,renderLineHighlight:r.value.renderLineHighlight};w(r,t=>{a.value.$editor.updateOptions({minimap:{enabled:t.minimap},fontSize:t.fontSize,cursorStyle:t.cursorStyle,cursorWidth:t.cursorWidth,lineHeight:t.lineHeight,cursorBlinking:t.cursorBlinking,renderLineHighlight:t.renderLineHighlight})},{deep:!0});function z(){ae.copyToClipboard(o.value),$("success","Code copied to clipboard")}async function x(){if(C.value){if(o.value===""){$("error","Code cannot be empty");return}await b().saveStrategy(s.value,o.value),l.value=o.value}}const H=q.debounce(async()=>{await x()},300);function L(t){t.key==="s"&&(navigator.platform.match("Mac")?t.metaKey:t.ctrlKey)&&(t.preventDefault(),H())}function U(){a.value.$editor.trigger("source","actions.find",{})}function N(){b().deleteStrategy(s.value),ne().push("/strategies")}return(t,e)=>{const S=O,m=te,R=le,V=X,F=Y;return Z(),I(Q,null,[g("section",de,[n(S),g("div",ce,[n(V,null,{default:u(()=>[g("div",ue,[g("h2",pe,ee(v(s)),1),g("div",ge,[n(m,{size:"xs",icon:"i-heroicons-trash",color:"gray",variant:"ghost",class:"ml-2",onClick:e[0]||(e[0]=y=>p.value=!0)},{default:u(()=>e[3]||(e[3]=[f(" Delete ")])),_:1}),n(m,{size:"xs",icon:"i-heroicons-clipboard",color:"gray",variant:"ghost",class:"ml-2",onClick:z},{default:u(()=>e[4]||(e[4]=[f(" Copy ")])),_:1}),n(m,{size:"xs",icon:"i-heroicons-magnifying-glass",class:"ml-2",color:"gray",variant:"ghost",onClick:U},{default:u(()=>e[5]||(e[5]=[f(" Find ")])),_:1}),n(m,{size:"xs",icon:"i-heroicons-check",class:"ml-2",color:"teal",variant:"ghost",disabled:!v(C),onClick:x},{default:u(()=>e[6]||(e[6]=[f(" Save ")])),_:1},8,["disabled"])])]),g("div",me,[n(R,{ref_key:"editorRef",ref:a,modelValue:v(o),"onUpdate:modelValue":e[1]||(e[1]=y=>E(o)?o.value=y:null),lang:"python",options:D,style:{height:"calc(100vh - 4rem - 4px - 2.5rem)"},onLoad:B},{default:u(()=>e[7]||(e[7]=[f(" Loading editor... ")])),_:1},8,["modelValue"])])]),_:1})])]),n(F,{modelValue:v(p),"onUpdate:modelValue":e[2]||(e[2]=y=>E(p)?p.value=y:null),title:"Delete strategy",description:`Are you sure you want to delete the strategy '${v(s)}'?`,type:"info"},{default:u(()=>[n(m,{variant:"solid",color:"red",block:"",class:"sm:w-auto",label:"Delete",onClick:N})]),_:1},8,["modelValue","description"])],64)}}});export{he as default};
