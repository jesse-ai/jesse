import{d as O,m as x,u as U,r as c,a as $,c as k,w as p,n as z,o as B,B as L,s as S,h as j,e as I,f as u,_ as K,g as R,i as l,j as o,k as q,l as A,p as H,q as W,t as F,v as G}from"./BZBcjETW.js";import{_ as J}from"./CBtiHpmx.js";const P=H(J),Q={class:"flex items-center justify-between"},X={class:"space-y-4"},Y={class:"flex justify-end gap-3"},te=O({__name:"OptimizationNotesModal",props:x({sessionId:{},initialTitle:{},initialDescription:{}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:x(["saved"],["update:modelValue"]),setup(y,{emit:b}){const n=y,V=b,i=U(y,"modelValue"),s=c(n.initialTitle||""),d=c(n.initialDescription||""),v=c(!1),m=c(),h=$(),g=k(()=>h.value==="light"?"vs-light":"vs-dark"),C={automaticLayout:!0,minimap:{enabled:!1},fontSize:15,lineHeight:21,wordWrap:"on"},w=k(()=>s.value!==(n.initialTitle||"")||d.value!==(n.initialDescription||""));p(g,t=>{var e,r;(r=(e=m.value)==null?void 0:e.$editor)==null||r.updateOptions({theme:t})}),p(()=>n.initialTitle,t=>{s.value=t||""}),p(()=>n.initialDescription,t=>{d.value=t||""}),p(i,async t=>{t?(await z(),setTimeout(()=>{var e;(e=m.value)!=null&&e.$editor&&(m.value.$editor.updateOptions({theme:g.value}),m.value.$editor.addCommand(2051,()=>{_()}))},100),window.addEventListener("keydown",f)):window.removeEventListener("keydown",f)}),B(()=>{window.removeEventListener("keydown",f)});function f(t){(t.metaKey||t.ctrlKey)&&t.key==="Enter"&&(t.preventDefault(),_())}async function _(){if(w.value){v.value=!0;try{await L().updateSessionNotes(n.sessionId,s.value,d.value),S("success","Notes saved successfully"),V("saved",{title:s.value,description:d.value}),i.value=!1}catch(t){j(t)}finally{v.value=!1}}}return(t,e)=>{const r=F,T=q,E=P,N=A,D=G,M=K;return R(),I(M,{modelValue:i.value,"onUpdate:modelValue":e[4]||(e[4]=a=>i.value=a),ui:{width:"sm:max-w-3xl"}},{default:u(()=>[l(D,null,{header:u(()=>[o("div",Q,[e[5]||(e[5]=o("h3",{class:"text-lg font-semibold"},"Add Title & Notes",-1)),l(r,{color:"gray",variant:"ghost",icon:"i-heroicons-x-mark",size:"sm",onClick:e[0]||(e[0]=a=>i.value=!1)})])]),footer:u(()=>[o("div",Y,[l(r,{color:"gray",variant:"ghost",label:"Cancel",onClick:e[3]||(e[3]=a=>i.value=!1)}),l(r,{color:"primary",label:"Save",icon:"i-heroicons-check",disabled:!w.value,loading:v.value,onClick:_},null,8,["disabled","loading"])])]),default:u(()=>[o("div",X,[o("div",null,[e[6]||(e[6]=o("label",{class:"block text-sm font-medium mb-2"},"Title",-1)),l(T,{modelValue:s.value,"onUpdate:modelValue":e[1]||(e[1]=a=>s.value=a),placeholder:"Enter a title for this optimization",maxlength:"255",size:"lg"},null,8,["modelValue"])]),o("div",null,[e[8]||(e[8]=o("label",{class:"block text-sm font-medium mb-2"},"Description",-1)),l(N,null,{default:u(()=>[l(E,{ref_key:"descriptionEditorRef",ref:m,modelValue:d.value,"onUpdate:modelValue":e[2]||(e[2]=a=>d.value=a),lang:"markdown",options:C,class:"border border-gray-200 dark:border-gray-800 rounded",style:{height:"400px"}},{default:u(()=>e[7]||(e[7]=[W(" Loading editor... ")])),_:1},8,["modelValue"])]),_:1})])])]),_:1})]),_:1},8,["modelValue"])}}});export{te as _};
