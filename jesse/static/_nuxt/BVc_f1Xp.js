import{d as ne,B as re,r as c,H as de,w as O,U as ce,h as b,z as v,j as e,i as l,e as ue,G as E,W as o,I as q,J as G,L as u,f as k,X as U,t as me,k as ve,Y as _e,_ as pe,g as m,$ as J,a0 as j,a1 as fe,a2 as ge,V as ye,s as W,Q as xe}from"./BZBcjETW.js";import{_ as he}from"./BfP20kJa.js";import{_ as we}from"./DMf59DGq.js";import{_ as be}from"./QzQJeclP.js";import{u as ke}from"./D-92rLZE.js";import"./CBtiHpmx.js";const ze={class:"mt-4 md:mt-8 p-3 md:p-4"},Se={class:"mb-6 flex flex-col gap-4 md:flex-row md:items-center md:justify-between"},Ve={class:"flex items-center gap-3"},Ce={class:"flex flex-col gap-3 sm:flex-row sm:items-center"},Ue={key:0,class:"space-y-4"},je={class:"bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden"},De={class:"divide-y divide-gray-200 dark:divide-gray-700"},Ne={class:"hidden md:grid md:grid-cols-12 gap-4 items-center"},Te={class:"col-span-3"},Me={class:"col-span-2 text-center"},$e={class:"col-span-2 text-center"},Oe={class:"col-span-2 text-center"},Re={class:"col-span-2"},Ae={class:"col-span-1 flex justify-end gap-2"},Pe={class:"md:hidden space-y-3"},Be={class:"flex items-start justify-between"},Fe={class:"flex-1"},He={class:"flex items-center justify-between"},Ie={class:"flex items-center justify-between"},Le={class:"flex gap-1"},Ee={key:1,class:"space-y-4"},qe={class:"bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden"},Ge={class:"divide-y divide-gray-200 dark:divide-gray-700"},Je=["onClick"],We={class:"hidden md:grid md:grid-cols-12 gap-4 items-center"},Qe={class:"col-span-3"},Xe={class:"font-medium text-gray-900 dark:text-white truncate"},Ye={class:"text-sm text-gray-500 dark:text-gray-400"},Ke={class:"col-span-2 text-center"},Ze={class:"text-sm font-medium text-gray-900 dark:text-white"},et={class:"col-span-2 flex justify-center"},tt={class:"col-span-2 text-center"},st={key:0,class:"text-sm font-medium text-gray-900 dark:text-white"},lt={key:1,class:"text-sm text-gray-400 dark:text-gray-500"},at={class:"col-span-2"},ot={class:"text-sm text-gray-500 dark:text-gray-400"},it={class:"col-span-1 flex justify-end gap-2"},nt={class:"md:hidden space-y-3"},rt={class:"flex items-start justify-between"},dt={class:"flex-1"},ct={class:"font-medium text-gray-900 dark:text-white truncate"},ut={class:"text-sm text-gray-500 dark:text-gray-400"},mt={class:"flex items-center justify-between text-sm"},vt={class:"font-medium text-gray-900 dark:text-white"},_t={class:"flex items-center justify-between text-sm"},pt={key:0,class:"font-medium text-gray-900 dark:text-white"},ft={key:1,class:"text-gray-400 dark:text-gray-500"},gt={class:"flex items-center justify-between"},yt={class:"text-xs text-gray-500 dark:text-gray-400"},xt={class:"flex gap-1"},ht={key:0,class:"flex justify-center"},wt={key:2,class:"text-center py-12"},bt={class:"text-gray-400 dark:text-gray-500 text-sm"},kt={class:"p-6"},zt={class:"flex justify-end gap-3"},St={class:"p-6"},Vt={class:"mb-6"},Ct={class:"flex justify-end gap-3"},z=50,Ot=ne({__name:"history",setup(Ut){ke({title:"Optimization History - Jesse"});const D=re(),d=c([]),g=c(!1),h=c(null),N=c(!1),T=c(!1),f=c(!0),p=c(0),S=c(!1),_=c(null),y=c(!1),M=c(!1),x=c(30),r=c({title:"",status:"all",dateRange:"all_time"}),Q=[{label:"All Statuses",value:"all"},{label:"Running",value:"running"},{label:"Finished",value:"finished"},{label:"Terminated",value:"terminated"},{label:"Stopped",value:"stopped"}],X=[{label:"All Time",value:"all_time"},{label:"Last 7 Days",value:"7_days"},{label:"Last 30 Days",value:"30_days"},{label:"Last 90 Days",value:"90_days"}],Y=[{label:"1 day",value:1},{label:"7 days",value:7},{label:"30 days",value:30},{label:"3 months",value:90},{label:"6 months",value:180},{label:"1 year",value:365},{label:"2 years",value:730},{label:"All existing sessions",value:-1}];de(()=>{setTimeout(()=>{w()},20)});const K=ce(()=>{p.value=0,d.value=[],f.value=!0,w()},300);O(()=>r.value.title,()=>{K()}),O(()=>r.value.status,()=>{p.value=0,d.value=[],f.value=!0,w()}),O(()=>r.value.dateRange,()=>{p.value=0,d.value=[],f.value=!0,w()});async function w(){N.value=!0;try{const a=await D.getSessions(z,p.value,{title_search:r.value.title||void 0,status_filter:r.value.status,date_filter:r.value.dateRange});p.value===0?d.value=a:d.value.push(...a),f.value=a.length===z}catch(a){b(a)}finally{N.value=!1}}async function Z(){T.value=!0,p.value+=z;try{const a=await D.getSessions(z,p.value,{title_search:r.value.title||void 0,status_filter:r.value.status,date_filter:r.value.dateRange});d.value.push(...a),f.value=a.length===z}catch(a){b(a)}finally{T.value=!1}}function R(a){h.value=a,g.value=!0}async function ee(){if(h.value)try{const{data:a,error:t}=await ye(`/optimization/sessions/${h.value}/remove`,{},!0);if(t.value){b(t.value);return}d.value=d.value.filter(i=>i.id!==h.value),W("success","Session deleted successfully"),g.value=!1,h.value=null}catch(a){b(a)}}async function te(a){await xe(`/optimization/${a}`)}function A(a){switch(a){case"finished":return"green";case"running":return"blue";case"stopped":return"red";case"terminated":return"yellow";default:return"gray"}}function P(a){var t,i;return(i=(t=a.state)==null?void 0:t.form)!=null&&i.routes&&a.state.form.routes.length>0?a.state.form.routes[0].strategy:"N/A"}function B(a){var t,i;return((i=(t=a.state)==null?void 0:t.form)==null?void 0:i.exchange)||"N/A"}function F(a){_.value=a,S.value=!0}async function se(a){if(_.value){_.value.title=a.title,_.value.description=a.description;const t=d.value.findIndex(i=>{var V;return i.id===((V=_.value)==null?void 0:V.id)});t!==-1&&(d.value[t]={..._.value})}}async function le(){M.value=!0;try{const a=x.value===-1?null:x.value,t=await D.purgeOptimizationSessions(a);t.success&&(W("success",`Successfully purged ${t.deleted_count} session(s)`),y.value=!1,p.value=0,d.value=[],f.value=!0,await w())}catch(a){b(a)}finally{M.value=!1}}function ae(){y.value=!1,x.value=30}return(a,t)=>{const i=me,V=ve,$=_e,n=he,H=we,I=fe,L=pe,oe=be,ie=ge;return m(),v("div",null,[t[19]||(t[19]=e("div",{class:"w-full"},null,-1)),e("div",ze,[e("div",Se,[e("div",Ve,[t[9]||(t[9]=e("h1",{class:"text-xl md:text-2xl font-bold text-gray-900 dark:text-white"}," Optimization History ",-1)),l(i,{icon:"i-heroicons-trash",color:"red",variant:"soft",size:"sm",label:"Purge",onClick:t[0]||(t[0]=s=>y.value=!0)})]),e("div",Ce,[l(V,{modelValue:o(r).title,"onUpdate:modelValue":t[1]||(t[1]=s=>o(r).title=s),placeholder:"Search by title...",icon:"i-heroicons-magnifying-glass",size:"sm",class:"w-full sm:w-64"},null,8,["modelValue"]),l($,{modelValue:o(r).status,"onUpdate:modelValue":t[2]||(t[2]=s=>o(r).status=s),options:Q,size:"sm",class:"w-full sm:w-40"},null,8,["modelValue"]),l($,{modelValue:o(r).dateRange,"onUpdate:modelValue":t[3]||(t[3]=s=>o(r).dateRange=s),options:X,size:"sm",class:"w-full sm:w-40"},null,8,["modelValue"])])]),o(N)?(m(),v("div",Ue,[e("div",je,[e("div",De,[(m(),v(q,null,G(5,s=>e("div",{key:s,class:"p-4"},[e("div",Ne,[e("div",Te,[l(n,{class:"h-4 w-full mb-2"}),l(n,{class:"h-3 w-2/3"})]),e("div",Me,[l(n,{class:"h-4 w-full mb-2"}),l(n,{class:"h-3 w-2/3 mx-auto"})]),e("div",$e,[l(n,{class:"h-6 w-20 mx-auto"})]),e("div",Oe,[l(n,{class:"h-4 w-16 mx-auto"})]),e("div",Re,[l(n,{class:"h-4 w-full"})]),e("div",Ae,[l(n,{class:"h-8 w-8"}),l(n,{class:"h-8 w-8"}),l(n,{class:"h-8 w-8"})])]),e("div",Pe,[e("div",Be,[e("div",Fe,[l(n,{class:"h-4 w-3/4 mb-2"}),l(n,{class:"h-3 w-1/2"})]),l(n,{class:"h-6 w-16 ml-2"})]),e("div",He,[l(n,{class:"h-4 w-24"}),l(n,{class:"h-4 w-16"})]),e("div",Ie,[l(n,{class:"h-3 w-32"}),e("div",Le,[l(n,{class:"h-8 w-8"}),l(n,{class:"h-8 w-8"}),l(n,{class:"h-8 w-8"})])])])])),64))])])])):o(d).length>0?(m(),v("div",Ee,[e("div",qe,[e("div",Ge,[(m(!0),v(q,null,G(o(d),s=>(m(),v("div",{key:s.id,class:"p-4 hover:bg-gray-50 dark:hover:bg-gray-700 transition-colors cursor-pointer",onClick:C=>te(s.id)},[e("div",We,[e("div",Qe,[e("div",Xe,u(s.title||P(s)||"Untitled"),1),e("div",Ye,u(B(s)),1)]),e("div",Ke,[e("div",Ze,u(s.completed_trials||0)+" / "+u(s.total_trials||0),1),t[10]||(t[10]=e("div",{class:"text-xs text-gray-500 dark:text-gray-400"}," trials ",-1))]),e("div",et,[l(H,{color:A(s.status),label:s.status,variant:"soft",size:"sm"},null,8,["color","label"])]),e("div",tt,[s.best_score!==null&&s.best_score!==void 0?(m(),v("div",st,u(typeof s.best_score=="number"?s.best_score.toFixed(2):s.best_score),1)):(m(),v("div",lt," N/A "))]),e("div",at,[e("div",ot,u(o(J).timestampToReadableDateTime(s.updated_at)),1)]),e("div",it,[l(I,{text:"Add Note",popper:{arrow:!0}},{default:k(()=>[l(i,{icon:"i-heroicons-pencil-square",variant:"ghost",size:"sm",color:"gray",onClick:j(C=>F(s),["stop"])},null,8,["onClick"])]),_:2},1024),l(I,{text:"Delete",popper:{arrow:!0}},{default:k(()=>[l(i,{icon:"i-heroicons-trash",variant:"ghost",size:"sm",color:"red",onClick:j(C=>R(s.id),["stop"])},null,8,["onClick"])]),_:2},1024)])]),e("div",nt,[e("div",rt,[e("div",dt,[e("div",ct,u(s.title||P(s)||"Untitled"),1),e("div",ut,u(B(s)),1)]),l(H,{color:A(s.status),label:s.status,variant:"soft",size:"xs",class:"ml-2"},null,8,["color","label"])]),e("div",mt,[t[11]||(t[11]=e("span",{class:"text-gray-500 dark:text-gray-400"},"Progress:",-1)),e("span",vt,u(s.completed_trials||0)+" / "+u(s.total_trials||0)+" trials ",1)]),e("div",_t,[t[12]||(t[12]=e("span",{class:"text-gray-500 dark:text-gray-400"},"Best Score:",-1)),s.best_score!==null&&s.best_score!==void 0?(m(),v("span",pt,u(typeof s.best_score=="number"?s.best_score.toFixed(2):s.best_score),1)):(m(),v("span",ft,"N/A"))]),e("div",gt,[e("span",yt,u(o(J).timestampToReadableDateTime(s.updated_at)),1),e("div",xt,[l(i,{icon:"i-heroicons-pencil-square",variant:"ghost",size:"sm",color:"gray",onClick:j(C=>F(s),["stop"])},null,8,["onClick"]),l(i,{icon:"i-heroicons-trash",variant:"ghost",size:"sm",color:"red",onClick:j(C=>R(s.id),["stop"])},null,8,["onClick"])])])])],8,Je))),128))])]),o(f)?(m(),v("div",ht,[l(i,{label:"Load More",icon:"i-heroicons-arrow-down",color:"gray",variant:"soft",size:"lg",loading:o(T),onClick:Z},null,8,["loading"])])):E("",!0)])):(m(),v("div",wt,[t[13]||(t[13]=e("div",{class:"text-gray-400 dark:text-gray-500 text-lg mb-2"}," No optimization sessions found ",-1)),e("div",bt,u(o(r).title||o(r).status!=="all"||o(r).dateRange!=="all_time"?"Try adjusting your filters":"Start an optimization to see results here"),1)])),l(L,{modelValue:o(g),"onUpdate:modelValue":t[5]||(t[5]=s=>U(g)?g.value=s:null)},{default:k(()=>[e("div",kt,[t[14]||(t[14]=e("h3",{class:"text-lg font-semibold mb-4"},"Delete Optimization Session",-1)),t[15]||(t[15]=e("p",{class:"text-gray-600 dark:text-gray-400 mb-6"}," Are you sure you want to delete this optimization session? This action cannot be undone. ",-1)),e("div",zt,[l(i,{color:"gray",variant:"ghost",label:"Cancel",onClick:t[4]||(t[4]=s=>g.value=!1)}),l(i,{color:"red",label:"Delete",onClick:ee})])])]),_:1},8,["modelValue"]),o(_)?(m(),ue(oe,{key:3,modelValue:o(S),"onUpdate:modelValue":t[6]||(t[6]=s=>U(S)?S.value=s:null),"session-id":o(_).id,"initial-title":o(_).title,"initial-description":o(_).description,onSaved:se},null,8,["modelValue","session-id","initial-title","initial-description"])):E("",!0),l(L,{modelValue:o(y),"onUpdate:modelValue":t[8]||(t[8]=s=>U(y)?y.value=s:null)},{default:k(()=>[e("div",St,[e("div",Vt,[t[16]||(t[16]=e("h3",{class:"text-lg font-semibold mb-2"},"Purge Optimization Sessions",-1)),t[17]||(t[17]=e("div",{class:"bg-yellow-50 dark:bg-yellow-900/20 border border-yellow-200 dark:border-yellow-800 rounded-lg p-4 mb-4"},[e("div",{class:"flex"},[e("div",{class:"flex-shrink-0"},[e("svg",{class:"h-5 w-5 text-yellow-400",viewBox:"0 0 20 20",fill:"currentColor"},[e("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"})])]),e("div",{class:"ml-3"},[e("h3",{class:"text-sm font-medium text-yellow-800 dark:text-yellow-200"},"Warning"),e("p",{class:"mt-1 text-sm text-yellow-700 dark:text-yellow-300"}," This action will permanently delete optimization sessions and cannot be undone. "),e("p",null,"Deleted sessions cannot be recovered. Please select carefully.")])])],-1)),l(ie,{label:"Delete sessions older than:",class:"mb-4"},{default:k(()=>[l($,{modelValue:o(x),"onUpdate:modelValue":t[7]||(t[7]=s=>U(x)?x.value=s:null),options:Y,size:"md"},null,8,["modelValue"])]),_:1}),t[18]||(t[18]=e("p",{class:"text-sm text-gray-600 dark:text-gray-400"}," This will permanently delete all optimization sessions that match your criteria. ",-1))]),e("div",Ct,[l(i,{color:"gray",variant:"ghost",label:"Cancel",onClick:ae}),l(i,{color:"red",label:"Purge Sessions",loading:o(M),onClick:le},null,8,["loading"])])])]),_:1},8,["modelValue"])])])}}});export{Ot as default};
