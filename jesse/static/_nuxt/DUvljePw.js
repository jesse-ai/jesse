import{c as p,o as n,b as a,g as Y,r as x,a3 as ke,d as r,F as Z,p as ie,k as L,w,a5 as fe,m as ae,D as l,t as q,a6 as pe,a7 as Ae,H as Re,S as Oe,q as se,K as F,aW as xe,b4 as G,O as X,a0 as z,a4 as $e,h as T,E as N,e as we,a$ as Be,b0 as Ce,Z as Ne,b5 as ze,aX as De,a as Fe,aG as qe,aH as He,aI as We,b6 as Ye,aT as Ze,aD as Ge,aE as ge,s as Qe,M as Je,i as W,v as Ke,x as Xe,G as ve,l as C,V as et,T as ye,W as K,Y as tt,$ as st}from"./DpunGGx_.js";import{a as ot,r as rt}from"./B0rFKjAV.js";import{b as Te,T as lt,r as be,_ as nt,a as at,c as it,e as ut,d as dt}from"./B2N3yLEa.js";import{_ as ct}from"./BRQDyyvL.js";import{_ as mt}from"./BOnuJPsp.js";import{_ as ft}from"./Uzz73lFa.js";import{l as pt,d as gt,s as he,_ as vt}from"./BOy1hMEW.js";import{u as yt}from"./Cq8ArPxc.js";import"./DR8l8gr8.js";function _e(S,o){return n(),p("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 0 0 2.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 0 0-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75 2.25 2.25 0 0 0-.1-.664m-5.8 0A2.251 2.251 0 0 1 13.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m0 0H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V9.375c0-.621-.504-1.125-1.125-1.125H8.25ZM6.75 12h.008v.008H6.75V12Zm0 3h.008v.008H6.75V15Zm0 3h.008v.008H6.75V18Z"})])}function bt(S,o){return n(),p("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[a("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 6.878V6a2.25 2.25 0 0 1 2.25-2.25h7.5A2.25 2.25 0 0 1 18 6v.878m-12 0c.235-.083.487-.128.75-.128h10.5c.263 0 .515.045.75.128m-12 0A2.25 2.25 0 0 0 4.5 9v.878m13.5-3A2.25 2.25 0 0 1 19.5 9v.878m0 0a2.246 2.246 0 0 0-.75-.128H5.25c-.263 0-.515.045-.75.128m15 0A2.25 2.25 0 0 1 21 12v6a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 18v-6c0-.98.626-1.813 1.5-2.122"})])}const ht={base:"animate-pulse",background:"bg-gray-100 dark:bg-gray-800",rounded:"rounded-md"},_t={class:"mb-4"},kt={class:""},xt={class:"relative rounded-lg shadow flex divide-x divide-gray-200 dark:divide-gray-700","aria-label":"Tabs"},$t=["to","onClick"],wt=["onClick"],Ct=["onClick"],Tt={class:"absolute right-[1em] focus:outline-none"},Vt=Y({__name:"LiveTabs",props:{currentTab:{},tabs:{}},emits:["close","cancel"],setup(S,{emit:o}){const _=ke(),y=x(_.params.id),g=x(!1),s=x(!1),V=x(null),b=x(null),m=o;function i(u){if(Object.keys(G().tabs).length>=X().planLimits.live_trading_tabs){z("error",`You have reached the limit of "${X().planLimits.live_trading_tabs}" tabs for your "${X().plan}" plan. Please upgrade your plan to add more tabs.`);return}G().addTab(u)}function $(u){$e().push(`/live/${u}`)}function P(u){if(!u.form.routes.length)return"New Tab";if(u.results.exception.error&&u.results.monitoring)return"Error";const f=u.form.routes[0];let c="";const U=u.form.exchange;return U&&(c+=`${U} â€¢ `),f.strategy&&(c+=`${f.strategy} â€¢ `),f.symbol&&(c+=`${f.symbol} â€¢ `),f.timeframe&&(c+=`${f.timeframe}`),c=c.endsWith(" â€¢ ")?c.slice(0,-3):c,u.results.monitoring&&!u.results.finished?`ðŸŸ¢ ${c}`:u.results.exception.error&&u.results.monitoring?`ðŸ”´ ${c}`:u.results.showResults?`${c} | Results`:c}function j(u){V.value=u.id,u.results.exception.error||u.results.finished||u.results.booting?g.value=!0:m("close",V.value)}return(u,f)=>{const c=Oe,U=se,H=xe;return n(),p("div",_t,[a("div",kt,[a("nav",xt,[(n(!0),p(Z,null,ie(u.tabs,h=>(n(),L(c,{key:h.id,class:"relative group min-w-0 flex-1 overflow-hidden text-center flex items-center",text:P(h),"open-delay":700,onMouseup:Re(D=>j(h),["middle"])},{default:w(()=>[a("div",{to:`/live/${h.id}`,class:ae([h.id===l(y)?"text-gray-900 dark:text-gray-100 font-bold ":"text-gray-500 dark:text-gray-300 hover:text-gray-700 font-medium ","whitespace-nowrap py-3 px-4 inline-block select-none cursor-pointer focus:outline-none w-full text-xs bg-gray-50 dark:bg-backdrop-dark"]),onClick:D=>$(h.id)},[a("span",null,q(P(h)),1),a("span",{"aria-hidden":"true",class:ae([h.id===l(y)&&Object.keys(u.tabs).length>1?"bg-indigo-400":"bg-transparent dark:bg-gray-600","absolute inset-x-0 bottom-0 h-0.5"])},null,2)],10,$t),(h.results.booting||h.results.monitoring)&&!h.results.finished?fe((n(),p("button",{key:0,class:"absolute right-[0.5em] focus:outline-none",onClick:D=>{s.value=!0,b.value=h.id}},[r(l(ot),{class:"h-5 w-5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 hover:bg-gray-200 bg-gray-100 dark:bg-gray-700 rounded-full","aria-hidden":"true"})],8,wt)),[[pe,Object.keys(u.tabs).length>1]]):fe((n(),p("button",{key:1,class:"hidden md:block absolute right-[0.5em] focus:outline-none",onClick:D=>j(h)},[r(l(Ae),{class:"h-5 w-5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200 hover:bg-gray-200 bg-gray-100 dark:bg-gray-700 rounded-full","aria-hidden":"true"})],8,Ct)),[[pe,Object.keys(u.tabs).length>1]])]),_:2},1032,["text","onMouseup"]))),128)),r(c,{text:"New Tab",popper:{arrow:!0}},{default:w(()=>[a("div",{class:"select-none cursor-pointer text-gray-400 dark:text-gray-100 hover:text-gray-600 focus:outline-none group relative w-14 overflow-hidden bg-gray-50 dark:bg-backdrop-dark py-3 px-4 font-medium hover:bg-gray-50 dark:hover:bg-gray-800 flex items-center justify-center",onClick:f[0]||(f[0]=h=>i(u.currentTab))},[a("button",Tt,[r(l(rt),{class:"h-6 w-6 rounded-full","aria-hidden":"true"})]),f[5]||(f[5]=a("span",{"aria-hidden":"true",class:"absolute inset-x-0 bottom-0 h-0.5 bg-transparent dark:bg-gray-600"},null,-1))])]),_:1})])]),r(H,{modelValue:l(s),"onUpdate:modelValue":f[2]||(f[2]=h=>F(s)?s.value=h:null),title:"Termination Confirm",description:"Are you sure you want to terminate this session?",type:"info"},{default:w(()=>[r(U,{variant:"solid",color:"red",class:"flex justify-center",label:"Terminate",onClick:f[1]||(f[1]=h=>{m("cancel",l(b)),s.value=!1})})]),_:1},8,["modelValue"]),r(H,{modelValue:l(g),"onUpdate:modelValue":f[4]||(f[4]=h=>F(g)?g.value=h:null),title:"Close Live Tab Confirm",description:"Are you sure you want to close this tab?",cancelBtnContent:"cancel",type:"info"},{default:w(()=>[r(U,{variant:"solid",color:"red",class:"flex justify-center",label:"Close",onClick:f[3]||(f[3]=h=>{m("close",l(V)),g.value=!1})})]),_:1},8,["modelValue"])])}}}),Lt=Y({__name:"LiveOrders",props:{orders:{}},setup(S){const o=S,_=T(()=>{if(!o.orders.length)return[];const y=[];for(let g=o.orders.length-1;g>=0;g--){const s=o.orders[g];y.push([{value:s.id.slice(-12),style:"text-xs",tooltip:s.id,tag:"code"},{value:N.timestampToTimeOnly(s.created_at),style:"text-xs",tooltip:N.timestampToTime(s.created_at)},{value:s.symbol,style:"text-xs"},{value:s.type,style:"text-xs"},{value:s.side,style:N.colorBasedOnSide(s.side)},{value:s.price,style:"text-xs"},{value:s.qty,style:N.colorBasedOnSide(s.side)},{value:s.status,style:"text-xs"}])}return y});return(y,g)=>{const s=Te,V=ct;return l(_).length?(n(),L(s,{key:0,data:l(_),"header-items":["ID","Created","Symbol","Type","Side","Price","QTY","Status"],header:""},null,8,["data"])):(n(),L(V,{key:1}))}}}),St={class:"flex justify-end item-center"},Et={class:"flex justify-end"},It=Y({__name:"ReportLiveSession",props:{session:{}},emits:["close"],setup(S,{emit:o}){const _=o,y=x(!1),g=S,s=x({description:"",email:""}),V=()=>{_("close")},b=async()=>{if(y.value=!0,!s.value.description){z("error","Please enter a description."),y.value=!1;return}const{data:m,error:i}=await De("/system/report-exception",{description:s.value.description,email:s.value.email,traceback:"manual report",mode:"live",attach_logs:!0,session_id:g.session},!0);if(y.value=!1,i.value&&i.value.statusCode!==200){z("error",`[${i.value.statusCode}]: ${i.value.statusText}`);return}const $=m.value;$.status==="success"?(s.value.description="",s.value.email="",z("success",$.message),V()):$.status==="error"&&z("error",$.message)};return(m,i)=>{const $=Ne,P=Ce,j=ze,u=se,f=Be;return n(),p(Z,null,[i[5]||(i[5]=a("p",null," If you think something is wrong with your running live session, you can submit a report. By submitting this form, the logs of this session will be sent to Jesse's developers so we can see what's going on. ",-1)),i[6]||(i[6]=a("br",null,null,-1)),i[7]||(i[7]=a("p",null,[we("Your exchange API keys and strategies are safe and "),a("b",null,"are never sent to us.")],-1)),i[8]||(i[8]=a("br",null,null,-1)),r(f,{state:l(s),class:"space-y-4",onSubmit:b},{default:w(()=>[r(P,{label:"Email (optional)",help:"Enter your email address for us to know who sent the email and possibly reply back to you."},{default:w(()=>[r($,{modelValue:l(s).email,"onUpdate:modelValue":i[0]||(i[0]=c=>l(s).email=c),placeholder:"Email address...",type:"email"},null,8,["modelValue"])]),_:1}),i[3]||(i[3]=a("br",null,null,-1)),r(P,{label:"Description:",name:"Description"},{default:w(()=>[r(j,{modelValue:l(s).description,"onUpdate:modelValue":i[1]||(i[1]=c=>l(s).description=c),rows:10,placeholder:"Describe what you think is wrong in this session..."},null,8,["modelValue"])]),_:1}),i[4]||(i[4]=a("br",null,null,-1)),a("div",St,[a("div",Et,[r(u,{color:"gray",variant:"link",class:"mr-8",label:"Cancel",onClick:i[2]||(i[2]=c=>V())}),r(u,{type:"submit",class:"w-48 flex justify-center",label:"Submit",loading:l(y),disabled:l(y)},null,8,["loading","disabled"])])])]),_:1},8,["state"])],64)}}}),Pt=Ge(ge.ui.strategy,ge.ui.skeleton,ht),jt=Y({inheritAttrs:!1,props:{class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},setup(S){const{ui:o,attrs:_}=He("skeleton",We(S,"ui"),Pt),y=T(()=>Ye(Ze(o.value.base,o.value.background,o.value.rounded),S.class));return{ui:o,attrs:_,skeletonClass:y}}});function Ut(S,o,_,y,g,s){return n(),p("div",qe({class:S.skeletonClass},S.attrs),null,16)}const Mt=Fe(jt,[["render",Ut]]),At={class:"mb-16"},Rt={key:0,class:"rounded overflow-hidden border-2 border-gray-100 dark:border-gray-600 p-4"},Ot={key:1},Bt=Y({__name:"CandlesChart",props:{form:{},results:{}},setup(S){const o=Qe(),_=T(()=>Je().params.id),y=x(!0),g=x(2),s=S,V=x();let b=null,m=null;const i={orderEntries:{},positionEntry:null},$=T(()=>o.value),P=s.form.exchange,j=T(()=>`${P}-${s.results.selectedRoute.symbol}-${s.results.selectedRoute.timeframe}`),u=T(()=>s.results.currentCandles),f=T(()=>{const v=s.results.positions.find(k=>k[0].value===s.results.selectedRoute.symbol);return v===void 0?[]:v}),c=T(()=>f.value[2].value),U=T(()=>Number(f.value[1].value)>0?"long":Number(f.value[1].value)<0?"short":"close");W(u,(v,k)=>{m!==null&&oe(v[j.value])}),W($,v=>{te(v)}),W(c,(v,k)=>{m!==null&&v!==k&&D()}),W(()=>s.results.orders,()=>{m!==null&&ee()},{deep:!0}),Ke(async()=>{setTimeout(async()=>{await H()},200)});async function H(){y.value=!0,await G().fetchCandles(_.value),y.value=!1,he.width=V.value.clientWidth,b=lt(V.value,he),b.applyOptions({watermark:{visible:!0,fontSize:16,horzAlign:"left",vertAlign:"bottom",color:"#888",text:`${s.results.selectedRoute.symbol} â€¢ ${s.results.selectedRoute.timeframe}`}}),m=b.addCandlestickSeries(),m.setData(s.results.candles),b.timeScale().fitContent(),m.applyOptions({priceFormat:{type:"price",precision:g.value,minMove:.01}}),D(),ee(),te($.value)}Xe(()=>{h()});function h(){b!==null&&(b.remove(),b=null),m&&(m=null)}function D(){const v=U.value==="long"?"#00AB5C":"#FF497D";if(i.positionEntry&&m.removePriceLine(i.positionEntry),Number(c.value)>0){const k={price:Number(c.value),color:v,lineWidth:1,lineStyle:0,axisLabelVisible:!0,title:"Entry Price"};i.positionEntry=m.createPriceLine(k)}}function ee(){const v=f.value[0].value;for(const k in i.orderEntries)m.removePriceLine(i.orderEntries[k]),delete i.orderEntries[k];s.results.orders.forEach(k=>{const I=k.side==="buy"?"#00AB5C":"#FF497D",O=ve.startCase(ve.lowerCase(`${k.side} ${k.type}`));if((k.status==="ACTIVE"||k.status==="QUEUED")&&k.symbol===v){const B={price:Number(k.price),color:I,lineWidth:1,lineStyle:0,axisLabelVisible:!0,title:O};i.orderEntries[k.id]=m.createPriceLine(B)}})}function oe(v){if(v===void 0)throw new TypeError("candle is undefined!");if(s.results.candles.length===0||s.results.candles[s.results.candles.length-1].time>v.time)return;const I=String(v.open).indexOf("."),O=I===-1?0:String(v.open).length-I-1;g.value!==O&&(g.value=O,(g.value<0||g.value>100)&&(g.value=0),m.applyOptions({priceFormat:{type:"price",precision:g.value,minMove:Math.pow(10,-O).toFixed(O)}})),m.update(v)}function te(v){b!==null&&b.applyOptions(v==="light"?pt.chart:gt.chart)}function re(v){s.results.selectedRoute=v,h(),H()}return(v,k)=>{const I=Mt,O=se;return n(),p("div",At,[l(y)?(n(),p("div",Rt,[r(I,{class:"h-4 w-full mb-4"}),r(I,{class:"h-4 w-2/3 mb-4"}),r(I,{class:"h-4 w-1/2 mb-4"}),r(I,{class:"h-4 w-full mb-4"}),r(I,{class:"h-4 w-full mb-4"}),r(I,{class:"h-4 w-2/3 mb-4"}),r(I,{class:"h-4 w-full mb-4"}),r(I,{class:"h-4 w-full"})])):C("",!0),a("div",{ref_key:"chartContainer",ref:V,class:ae({"rounded overflow-hidden border-2 border-gray-100 dark:border-gray-600":!l(y)})},null,2),s.form.routes.length>1?(n(),p("div",Ot,[(n(!0),p(Z,null,ie(s.form.routes,B=>(n(),L(O,{key:B.symbol,variant:"soft",color:"gray",disabled:v.results.selectedRoute.symbol===B.symbol&&v.results.selectedRoute.timeframe===B.timeframe,class:"mt-2 mr-2",onClick:ue=>re(B)},{default:w(()=>[we(q(B.symbol)+" â€¢ "+q(B.timeframe),1)]),_:2},1032,["disabled","onClick"]))),128))])):C("",!0)])}}}),Nt={key:0,class:"flex flex-col items-center justify-center select-none mt-[10%]"},zt=["textContent"],Dt={class:"mt-8"},Ft={key:1,class:"mx-auto container mt-8"},qt={key:0,"data-cy":"live-page-content"},Ht={class:"flex justify-between items-center"},Wt={class:"grid grid-cols-1 gap-6"},Yt={class:"flex justify-between items-center"},Zt={key:1},Gt={key:0,class:"mb-8"},Qt={key:0},Jt={key:0,class:"mt-8 lg:mt-0"},Kt={key:1,"data-cy":"live-action-button"},Xt={key:1,class:"my-8 border-2 dark:border-gray-600 rounded-full"},es={key:2,class:"bg-white dark:bg-gray-700 grid grid-cols-1 gap-6 border dark:border-gray-600 rounded py-4 px-6 select-none"},ts={class:"text-sm font-medium text-gray-500 dark:text-gray-400 truncate"},ss={class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},os={class:"flex justify-between items-center"},rs={class:"flex justify-start items-center"},ls={class:"focus:outline-none flex justify-start items-center"},ns={class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},as={class:"flex justify-between items-center"},is={class:"flex justify-start items-center"},us={class:"focus:outline-none flex justify-start items-center"},ds={class:"text-sm font-semibold text-gray-900 dark:text-gray-100"},cs={key:3},ms=Y({__name:"LiveTab",props:{form:{},results:{},session:{},tabs:{}},setup(S){const o=S,_=x([]),y=x(!1),g=x(!1),s=x(!1),V=x(!1),b=x(!1),m=x(!1),i=x(!1),$=x(!1),P=x(!1),j=x(!1),u=X(),f=G(),c=x([]);async function U(){if(!(o.results.monitoring||o.results.booting)){if(!o.form.paper_mode){const e=u.exchangeApiKeys.find(t=>t.id===o.form.exchange_api_key_id);e&&(o.form.exchange=e.exchange)}try{c.value=await X().getExchangeSupportedSymbols(o.form.exchange);for(let e=0;e<o.form.routes.length;e++)c.value.includes(o.form.routes[e].symbol)||(o.form.routes[e].symbol=c.value[0]);if(o.form.data_routes.length>0)for(let e=0;e<o.form.data_routes.length;e++)c.value.includes(o.form.data_routes[e].symbol)||(o.form.data_routes[e].symbol=c.value[0])}catch(e){console.error("Error updating supported symbols:",e)}}}o.form.exchange&&(!o.results.monitoring&&!o.results.booting||!c.value.length)&&U(),W(()=>o.form.exchange,async(e,t)=>{e!==t&&(c.value=[],await U())}),W(()=>o.results.monitoring,async e=>{e==!1&&await U()},{deep:!0}),W(()=>o.form.exchange_api_key_id,async(e,t)=>{e!==t&&(c.value=[],await U())});const H=T(()=>{const e=[{label:"Exchange",value:o.results.generalInfo.exchange},{label:"Current Time",value:N.timestampToTime(o.results.generalInfo.current_time)},{label:"Debug Mode",value:o.results.generalInfo.debug_mode},{label:"Paper Trade",value:o.results.generalInfo.paper_mode},{label:"PNL",value:`${o.results.generalInfo.pnl} (${o.results.generalInfo.pnl_perc}%)`},{label:"Started",value:N.timestampToTime(o.results.generalInfo.started_at)},{label:"Started/Current Balance",value:`${o.results.generalInfo.started_balance} / ${o.results.generalInfo.current_balance}`},{label:"Trades",value:`${o.results.generalInfo.count_trades}`}];return o.results.generalInfo.leverage_type!=="spot"&&(e.push({label:"Available Margin",value:`${o.results.generalInfo.available_margin}`}),e.push({label:"Leverage",value:`${o.results.generalInfo.leverage}x (${o.results.generalInfo.leverage_type})`})),e}),h=T(()=>u.notificationApiKeys.map(e=>({label:`${e.name} - ${e.driver}`,value:e.id}))),D=T(()=>Math.round(o.results.progressbar.estimated_remaining_seconds)===0?"Please wait...":`${Math.round(o.results.progressbar.estimated_remaining_seconds)} seconds remaining...`),ee=T(()=>{if(!o.results.orders)return[];const e=[],t=5,M=o.results.orders.length,A=M-t>=0?M-t:0;for(let Q=M-1;Q>=A;Q--){const E=o.results.orders[Q],R=E.status==="PARTIALLY FILLED"?`${E.filled_qty}/${E.qty}`:E.qty;e.push([{value:N.timestampToTimeOnly(E.created_at),style:"text-xs",tooltip:N.timestampToTime(E.created_at)},{value:E.symbol,style:"text-xs"},{value:E.type,style:"text-xs"},{value:E.side,style:N.colorBasedOnSide(E.side)},{value:E.price,style:"text-xs"},{value:R,style:N.colorBasedOnSide(E.side)},{value:E.status,style:"text-xs"}])}return e}),oe=T(()=>{let e=[];const t=u.jesseSupportedTimeframes;return u.settings.live.generate_candles_from_1m||!o.form.exchange?e=t.map(M=>u.planLimits.timeframes.includes(M)?{label:M,value:M,disabled:!1}:{label:`${M} (Upgrade required)`,value:M,disabled:!0}):e=u.exchangeInfo[o.form.exchange].supported_timeframes.map(A=>u.planLimits.timeframes.includes(A)?{label:A,value:A,disabled:!1}:{label:`${A} (Upgrade required)`,value:A,disabled:!0}),e}),te=T(()=>u.liveTradingExchangeNames.map(e=>u.planLimits.exchanges.includes(e)?{label:e,value:e,disabled:!1}:{label:`${e} (Upgrade required)`,value:e,disabled:!0})),re=T(()=>u.exchangeApiKeys.map(e=>u.planLimits.exchanges.includes(e.exchange)?{label:`${e.exchange} - ${e.name}`,value:e.id,disabled:!1}:{label:`${e.exchange} - ${e.name} (Upgrade required)`,value:e.id,disabled:!0})),v=f.cancel,k=f.newLive;function I(e){if(_.value.length){for(let t=0;t<_.value.length;t++)z("error",_.value[t]);return}if(o.form.paper_mode&&!o.form.exchange||!o.form.paper_mode&&o.form.exchange_api_key_id===""){z("error","Please select an exchange");return}f.start(e)}function O(e){f.closeTab(e)}function B(e){j.value=!1,f.stop(e)}function ue(){g.value=!0,navigator.clipboard.writeText(o.results.infoLogs),z("success","Logs copied successfully"),V.value=!0,setTimeout(()=>{V.value=!1},3e3)}function Ve(){s.value=!0,navigator.clipboard.writeText(o.results.errorLogs),z("success","Logs copied successfully"),b.value=!0,setTimeout(()=>{b.value=!1},3e3)}const de=T(()=>["basic","pro","enterprise","basic-lifetime","pro-lifetime","enterprise-lifetime","lifetime"].includes(u.plan));return(e,t)=>{const M=Lt,A=et,Q=It,E=mt,R=se,Le=xe,Se=nt,ce=at,J=tt,le=ft,Ee=it,me=st,Ie=Ce,Pe=Bt,ne=Te,je=ut,Ue=vt,Me=dt;return n(),p(Z,null,[r(A,{modelValue:l(m),"onUpdate:modelValue":t[0]||(t[0]=d=>F(m)?m.value=d:null),size:"ultra",title:"Orders"},{default:w(()=>[r(M,{orders:e.results.orders},null,8,["orders"])]),_:1},8,["modelValue"]),r(A,{modelValue:l(i),"onUpdate:modelValue":t[2]||(t[2]=d=>F(i)?i.value=d:null),size:"small",title:"Report An Issue"},{default:w(()=>[r(Q,{session:e.session,onClose:t[1]||(t[1]=d=>i.value=!1)},null,8,["session"])]),_:1},8,["modelValue"]),r(A,{modelValue:l($),"onUpdate:modelValue":t[3]||(t[3]=d=>F($)?$.value=d:null),title:"Info Logs"},{default:w(()=>[r(E,{logs:e.results.infoLogs},null,8,["logs"])]),buttons:w(()=>[a("button",{class:"ml-2 p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 focus:outline-none",onClick:ue},[l(V)?(n(),L(l(ye),{key:0,class:"h-6 w-6","aria-hidden":"true"})):C("",!0),!l(V)&&e.results.infoLogs.length!=0?(n(),L(l(be),{key:1,class:"h-6 w-6","aria-hidden":"true"})):C("",!0)])]),_:1},8,["modelValue"]),r(A,{modelValue:l(P),"onUpdate:modelValue":t[4]||(t[4]=d=>F(P)?P.value=d:null),title:"Error Logs"},{default:w(()=>[r(E,{logs:e.results.errorLogs},null,8,["logs"])]),buttons:w(()=>[a("button",{class:"ml-2 p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 focus:outline-none",onClick:Ve},[l(b)?(n(),L(l(ye),{key:0,class:"h-6 w-6","aria-hidden":"true"})):C("",!0),!l(b)&&e.results.errorLogs.length!=0?(n(),L(l(be),{key:1,class:"h-6 w-6","aria-hidden":"true"})):C("",!0)])]),_:1},8,["modelValue"]),r(Le,{modelValue:l(j),"onUpdate:modelValue":t[6]||(t[6]=d=>F(j)?j.value=d:null),title:"Termination Confirm",description:"Are you sure you want to terminate this session?",type:"info"},{default:w(()=>[r(R,{variant:"solid",color:"red",class:"flex justify-center",label:"Terminate",onClick:t[5]||(t[5]=d=>B((e._.provides[K]||e.$route).params.id))})]),_:1},8,["modelValue"]),e.results.booting?(n(),p("div",Nt,[a("div",null,[r(Se,{progress:e.results.progressbar.current},null,8,["progress"])]),e.results.exception.error?C("",!0):(n(),p("h3",{key:0,class:"mt-8 animate-pulse",textContent:q(l(D))},null,8,zt)),a("div",Dt,[e.form.debug_mode?(n(),L(R,{key:0,icon:"i-heroicons-clipboard-document-list",variant:"solid",label:"View Logs",size:"xl",class:"flex justify-center w-64",onClick:t[7]||(t[7]=d=>$.value=!0)})):C("",!0),r(R,{color:"gray",class:"w-64 flex justify-center mt-4",size:"xl",ui:{color:{gray:{solid:"text-rose-500 dark:text-rose-400"}}},icon:"i-heroicons-no-symbol",variant:"solid",label:"Cancel",trailing:!1,onClick:t[8]||(t[8]=d=>l(v)((e._.provides[K]||e.$route).params.id))})]),e.results.exception.error?(n(),p("div",Ft,[r(ce,{modelValue:l(y),"onUpdate:modelValue":t[9]||(t[9]=d=>F(y)?y.value=d:null),title:e.results.exception.error,content:e.results.exception.traceback,mode:"live","debug-mode":e.form.debug_mode},null,8,["modelValue","title","content","debug-mode"])])):C("",!0)])):(n(),L(Me,{key:1},{left:w(()=>[!e.results.booting&&!e.results.monitoring&&!e.results.showResults?(n(),p("div",qt,[r(J,{class:"mb-4",title:"Exchange"}),e.form.paper_mode?(n(),L(le,{key:0,modelValue:e.form.exchange,"onUpdate:modelValue":t[10]||(t[10]=d=>e.form.exchange=d),placeholder:"Select an exchange...",searchable:"",options:l(te),"value-attribute":"value",size:"lg",class:"mt-2 mb-16"},null,8,["modelValue","options"])):(n(),L(le,{key:1,modelValue:e.form.exchange_api_key_id,"onUpdate:modelValue":t[11]||(t[11]=d=>e.form.exchange_api_key_id=d),placeholder:"Select an exchange...",searchable:"",options:l(re),"value-attribute":"value",size:"lg",class:"mt-2 mb-16"},{empty:w(()=>[a("div",Ht,[t[23]||(t[23]=a("span",null," No exchange API keys found. Please add at least one: ",-1)),r(R,{to:"/exchange-api-keys",icon:"i-heroicons-plus",type:"link",variant:"solid",size:"sm",label:"Add Exchange API Key"})])]),_:1},8,["modelValue","options"])),r(Ee,{"total-routes-error":l(_),form:e.form,results:e.results,mode:"live",symbols:l(c),timeframes:l(oe)},null,8,["total-routes-error","form","results","symbols","timeframes"]),r(J,{class:"mt-16 mb-4",title:"Options"}),a("div",Wt,[r(me,{modelValue:e.form.debug_mode,"onUpdate:modelValue":t[12]||(t[12]=d=>e.form.debug_mode=d),title:"Debug Mode",description:"Logs more details, helpful for debugging."},null,8,["modelValue"]),r(me,{modelValue:e.form.paper_mode,"onUpdate:modelValue":t[13]||(t[13]=d=>e.form.paper_mode=d),title:"Paper Trade",disabled:!l(de),"disabled-guide":l(de)?"":"Premium plan required",description:"Trade in real-time using actual exchange data with PAPER money."},null,8,["modelValue","disabled","disabled-guide"]),r(Ie,{label:"Notifications:",help:"Select a notification driver to receive notifications"},{default:w(()=>[r(le,{modelValue:e.form.notification_api_key_id,"onUpdate:modelValue":t[14]||(t[14]=d=>e.form.notification_api_key_id=d),placeholder:"Select a notification driver",size:"lg",options:l(h),"value-attribute":"value"},{empty:w(()=>[a("div",Yt,[t[24]||(t[24]=a("span",null," No notification API keys found. Please add at least one: ",-1)),r(R,{to:"/notification-api-keys",icon:"i-heroicons-plus",type:"link",variant:"solid",size:"sm",label:"Add Notification API Key"})])]),_:1},8,["modelValue","options"])]),_:1})])])):C("",!0),e.results.monitoring?(n(),p("div",Zt,[e.results.exception.error?(n(),p("div",Gt,[r(ce,{title:e.results.exception.error,content:e.results.exception.traceback,mode:"live","debug-mode":e.form.debug_mode},null,8,["title","content","debug-mode"])])):C("",!0),e.results.monitoring&&!e.results.finished&&!e.results.exception.error?(n(),L(Pe,{key:1,results:e.results,form:e.form,exchange:e.form.exchange},null,8,["results","form","exchange"])):C("",!0),r(J,{class:"mb-4",title:"Routes"}),r(ne,{data:e.results.routes,"header-items":["Symbol","Timeframe","Strategy"],header:""},null,8,["data"]),r(J,{class:"mt-12 mb-4",title:"Positions"}),r(ne,{data:e.results.positions,"header-items":["Symbol","QTY","Entry","Price","Liq Price","PNL"],header:""},null,8,["data"]),r(je,{class:"mt-12 mb-4",title:"Orders"},{default:w(()=>[a("button",{type:"button",class:"inline-flex items-center shadow-sm px-4 py-1.5 border border-gray-300 dark:border-gray-900 text-sm leading-5 font-medium rounded-full text-gray-700 dark:text-gray-100 bg-white dark:bg-backdrop-dark hover:bg-gray-50 dark:hover:bg-gray-700 focus:outline-none",onClick:t[15]||(t[15]=d=>m.value=!0)},[r(l(bt),{class:"-ml-1.5 mr-1 h-5 w-5 text-gray-400","aria-hidden":"true"}),t[25]||(t[25]=a("span",null,"More",-1))])]),_:1}),r(ne,{data:l(ee),"header-items":["Created","Symbol","Type","Side","Price","QTY","Status"],header:""},null,8,["data"])])):C("",!0)]),right:w(()=>[e.results.booting?C("",!0):(n(),p("div",Qt,[e.results.monitoring?(n(),p("div",Jt,[e.results.finished?(n(),L(R,{key:0,class:"w-full flex justify-center",variant:"solid",icon:"i-heroicons-plus",size:"xl",label:"New session",onClick:t[16]||(t[16]=d=>l(k)((e._.provides[K]||e.$route).params.id))})):(n(),L(R,{key:1,class:"w-full flex justify-center",variant:"solid",color:"gray",icon:"i-heroicons-no-symbol",size:"xl",label:e.results.terminating?"Terminating...":"Terminate",ui:{color:{gray:{solid:"text-rose-500 dark:text-rose-400"}}},onClick:t[17]||(t[17]=d=>j.value=!0)},null,8,["label"])),e.results.monitoring||e.results.finished?(n(),L(R,{key:2,class:"w-full flex justify-center mt-4",variant:"solid",color:"gray",icon:"i-heroicons-flag",size:"xl",label:"Report",onClick:t[18]||(t[18]=d=>i.value=!0)})):C("",!0)])):(n(),p("div",Kt,[r(R,{class:"w-full flex justify-center",icon:"i-heroicons-bolt",size:"xl",variant:"solid",label:"Start",trailing:!1,onClick:t[19]||(t[19]=d=>I((e._.provides[K]||e.$route).params.id))}),Object.keys(e.tabs).length>1?(n(),L(R,{key:0,class:"w-full md:hidden flex justify-center mt-2",icon:"i-heroicons-x-mark",size:"xl",variant:"solid",color:"gray",label:"Close Tab",trailing:!1,onClick:t[20]||(t[20]=d=>O((e._.provides[K]||e.$route).params.id))})):C("",!0)]))])),e.results.monitoring?(n(),p("hr",Xt)):C("",!0),e.results.monitoring?(n(),p("dl",es,[(n(!0),p(Z,null,ie(l(H),d=>(n(),p("div",{key:d.label,class:"flex justify-between items-center"},[a("div",ts,q(d.label)+":",1),a("div",ss,q(d.value),1)]))),128)),a("div",os,[a("div",rs,[a("button",{class:"text-sm font-medium text-gray-500 hover:text-gray-600 dark:text-gray-400 dark:hover:text-gray-300 truncate flex items-center hover:underline cursor-pointer focus:outline-none",onClick:t[21]||(t[21]=d=>$.value=!0)},[t[26]||(t[26]=a("span",null,"Info Logs:",-1)),a("span",ls,[r(l(_e),{class:"w-6 h-6 ml-2"})])])]),a("div",ns,q(e.results.generalInfo.count_info_logs),1)]),a("div",as,[a("div",is,[a("button",{class:"text-sm font-medium text-gray-500 hover:text-gray-600 dark:text-gray-400 dark:hover:text-gray-300 truncate flex items-center hover:underline cursor-pointer focus:outline-none",onClick:t[22]||(t[22]=d=>P.value=!0)},[t[27]||(t[27]=a("span",null,"Error Logs:",-1)),a("span",us,[r(l(_e),{class:"w-6 h-6 ml-2 cursor-pointer"})])])]),a("div",ds,q(e.results.generalInfo.count_error_logs),1)])])):C("",!0),e.results.monitoring&&e.results.watchlist.length?(n(),p("div",cs,[r(J,{class:"mt-8 mb-4",title:"Watch List"}),r(Ue,{data:e.results.watchlist},null,8,["data"])])):C("",!0)]),_:1}))],64)}}}),fs={class:"w-full"},$s=Y({__name:"[id]",setup(S){yt({title:"Live/Paper trading - Jesse"});const o=G(),_=T(()=>o.tabs),y=ke(),g=T(()=>y.params.id),s=T(()=>{if(!_.value[g.value]){const b=Object.keys(_.value);if(b.length>0){const m=_.value[b[0]];return $e().push(`/live/${m.id}`),m}}return _.value[g.value]});(!Object.keys(s.value).includes("selectedRoute")||Object.keys(s.value.results.selectedRoute).length==0||V(s.value.results.selectedRoute,s.value.form.routes[0]))&&(s.value.results.selectedRoute=s.value.form.routes[0]),s.value.form.exchange==""&&(s.value.form.exchange=s.value.results.generalInfo.exchange),Object.keys(_.value).length===0&&G().addTab();function V(b,m){return b.length!==m.length?!1:b.every((i,$)=>i===m[$])}return(b,m)=>{const i=Vt,$=ms;return n(),p(Z,null,[a("div",fs,[r(i,{"current-tab":s.value?s.value.id:null,tabs:_.value,onClose:l(o).closeTab,onCancel:l(o).cancel},null,8,["current-tab","tabs","onClose","onCancel"])]),s.value?(n(),L($,{key:0,form:s.value.form,results:s.value.results,session:g.value,tabs:_.value},null,8,["form","results","session","tabs"])):C("",!0)],64)}}});export{$s as default};
