import{_ as ot}from"./DgT6eUf2.js";import{_ as lt}from"./CyMeHnuq.js";import{d as oe,r as w,c as B,w as W,n as Ae,a_ as rt,z as p,g as a,e as O,G as k,i as r,Z as Y,j as s,L as _,I as Z,J as me,t as be,u as $e,f as L,v as Fe,A as Be,_ as Le,m as _e,a as qe,q as ye,l as at,p as nt,s as Q,h as it,Q as Re,W as l,$ as te,bf as ue,a0 as Ne,bq as dt,bj as He,X as ae,b6 as We,br as ee,H as Ee,o as ut,P as je,bs as ct,b as Ge,a4 as ft,a1 as mt,be as vt,bt as pt,bc as gt,bu as ce,bd as yt,a6 as bt,k as ht,a8 as wt,bo as kt,al as xt}from"./BZBcjETW.js";import{_ as _t}from"./B-Uq0ZUV.js";import{r as $t,a as Ct,_ as Vt}from"./Brb7I5l6.js";import{_ as St}from"./B-2SFkko.js";import{_ as Tt}from"./BAhmbuaU.js";import{_ as jt}from"./bNiC0h8c.js";import{_ as Lt}from"./CK4DaXGt.js";import{_ as Rt}from"./BfP20kJa.js";import{_ as Et}from"./DCGi8i1_.js";import{s as xe,l as Pe,d as Ie,_ as zt,u as Ut}from"./CuQxZd7W.js";import{_ as Mt}from"./CNlI_mjZ.js";import{_ as Ot}from"./CKmzJTug.js";import{_ as Bt}from"./CBtiHpmx.js";import{T as De}from"./xgbdnDAz.js";import{u as Nt}from"./D-92rLZE.js";import"./CA3QkJiz.js";const Pt={class:"w-full h-full flex flex-col"},It={key:0,class:"flex justify-center items-center py-8"},Dt={class:"w-full relative"},At={key:0,class:"whitespace-pre-line select-text text-base dark:text-gray-300 w-full mb-1"},Ft={key:3,class:"mt-4 flex justify-center"},fe=1e3,qt=oe({__name:"Logs",props:{logs:{},sections:{},totalLogs:{}},setup(P){const n=P,b=w(""),m=w(!1),i=w(!1),v=w([]),u=w(null),t=w(1),c=w(!1),$=w(fe),U=B(()=>c.value?v.value:v.value.slice(0,$.value));W(()=>n.logs,async f=>{f&&(m.value=!0,await Ae(),setTimeout(()=>{v.value=f.slice(0,fe),t.value=1,c.value=f.length<=fe,m.value=!1},0),setTimeout(()=>{b.value=n.logs.join(`
`)},0))},{immediate:!0}),W(t,()=>{$.value=t.value*fe});function y(f){const g=f.target;g.scrollHeight-g.scrollTop<=g.clientHeight+50&&T()}async function T(){i.value||c.value||(i.value=!0,setTimeout(()=>{const f=t.value*fe,g=(t.value+1)*fe;if(f<n.logs.length){const R=n.logs.slice(f,g);v.value=[...v.value,...R],t.value++,c.value=g>=n.logs.length}else c.value=!0;i.value=!1},0))}return(f,g)=>{const R=rt("ULoading"),q=lt,D=be;return a(),p("div",Pt,[m.value?(a(),p("div",It,[r(R,{size:"lg"})])):v.value.length?(a(),p("div",{key:2,ref_key:"logContainer",ref:u,class:Y([c.value?"h-[calc(100vh-120px)]":"h-[calc(100vh-180px)]","w-full overflow-y-scroll rounded border dark:border-gray-600 bg-gray-50 dark:bg-gray-700 px-4 sm:px-6 py-2"]),onScroll:y},[s("div",Dt,[c.value?(a(),p("pre",At,"          "+_(b.value)+`
        `,1)):(a(!0),p(Z,{key:1},me(U.value,(V,j)=>(a(),p("pre",{key:0+j,class:"whitespace-pre-line select-text text-base dark:text-gray-300 w-full mb-1"},_(V),1))),128))])],34)):(a(),O(q,{key:1})),v.value.length&&!c.value?(a(),p("div",Ft,[r(D,{loading:i.value,class:"w-full flex justify-center",label:`(loaded ${v.value.length} / ${n.logs.length}) Load All Logs`,onClick:g[0]||(g[0]=V=>c.value=!0)},null,8,["loading","label"])])):k("",!0)])}}}),Ht={class:"flex items-center justify-between"},Wt=oe({__name:"FullscreenModal",props:{modelValue:{type:Boolean,default:!1},modelModifiers:{}},emits:["update:modelValue"],setup(P){const n=$e(P,"modelValue");return(b,m)=>{const i=be,v=Fe,u=Le;return a(),O(u,{modelValue:n.value,"onUpdate:modelValue":m[1]||(m[1]=t=>n.value=t),fullscreen:""},{default:L(()=>[r(v,{ui:{base:"h-full flex flex-col",rounded:"",divide:"divide-y divide-gray-100 dark:divide-gray-800",body:{base:"grow"}}},{header:L(()=>[s("div",Ht,[s("div",null,[Be(b.$slots,"title")]),r(i,{color:"gray",variant:"ghost",icon:"i-heroicons-x-mark-20-solid",class:"-my-1",onClick:m[0]||(m[0]=t=>n.value=!1)})])]),default:L(()=>[Be(b.$slots,"default")]),_:3})]),_:3},8,["modelValue"])}}}),Gt=nt(Bt),Jt={class:"flex items-center justify-between"},Qt={class:"flex flex-col space-y-4"},Yt={key:0,class:"flex flex-wrap gap-2"},Zt={class:"flex flex-col"},Xt={class:"flex items-center justify-between mb-2"},Kt={class:"flex gap-2"},es=oe({__name:"BacktestStrategyCodeModal",props:_e({routes:{},exchange:{},strategyCodes:{}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:["update:modelValue"],setup(P){const n=P,b=$e(P,"modelValue"),m=w(""),i=w(null),v=w(""),u=w(),t=qe(),c=B(()=>t.value==="light"?"vs-light":"vs-dark"),$=B(()=>({automaticLayout:!0,minimap:{enabled:!1},fontSize:14,lineHeight:21,readOnly:!0}));W(c,f=>{var g,R;(R=(g=u.value)==null?void 0:g.$editor)==null||R.updateOptions({theme:f})}),W(b,async f=>{f&&n.routes.length>0&&(await Ae(),setTimeout(()=>{var g;(g=u.value)!=null&&g.$editor&&u.value.$editor.updateOptions({theme:c.value}),U(n.routes[0])},50))}),W(()=>n.strategyCodes,f=>{f&&m.value&&(v.value=f[m.value]||"# No strategy code snapshot available for this route")},{deep:!0,immediate:!0});function U(f){var R;const g=`${n.exchange}-${f.symbol}`;m.value=g,i.value=f,v.value=((R=n.strategyCodes)==null?void 0:R[g])||"# No strategy code snapshot available for this route"}async function y(){try{await navigator.clipboard.writeText(v.value),Q("success","Strategy code copied to clipboard")}catch(f){it(f)}}function T(){var f;(f=i.value)!=null&&f.strategy?Re(`/strategies/${i.value.strategy}`):Q("error","No strategy selected")}return(f,g)=>{const R=be,q=Gt,D=at,V=Fe,j=Le;return a(),O(j,{modelValue:b.value,"onUpdate:modelValue":g[2]||(g[2]=z=>b.value=z),ui:{width:"sm:max-w-5xl"}},{default:L(()=>[r(V,null,{header:L(()=>[s("div",Jt,[g[3]||(g[3]=s("h3",{class:"text-lg font-semibold"},"Strategy Code Snapshot",-1)),r(R,{color:"gray",variant:"ghost",icon:"i-heroicons-x-mark",size:"sm",onClick:g[0]||(g[0]=z=>b.value=!1)})])]),default:L(()=>[s("div",Qt,[f.routes.length>1?(a(),p("div",Yt,[(a(!0),p(Z,null,me(f.routes,z=>(a(),O(R,{key:`${f.exchange}-${z.symbol}`,variant:"soft",color:"gray",disabled:m.value===`${f.exchange}-${z.symbol}`,onClick:G=>U(z)},{default:L(()=>[ye(_(z.strategy)+" • "+_(z.symbol),1)]),_:2},1032,["disabled","onClick"]))),128))])):k("",!0),s("div",Zt,[s("div",Xt,[g[4]||(g[4]=s("label",{class:"block text-sm font-medium"},null,-1)),s("div",Kt,[r(R,{icon:"i-heroicons-clipboard-document",label:"Copy",variant:"soft",color:"gray",size:"sm",onClick:y}),r(R,{icon:"i-heroicons-pencil-square",label:"Go to Strategy Editor",variant:"soft",color:"primary",size:"sm",onClick:T})])]),r(D,null,{default:L(()=>[r(q,{ref_key:"codeEditorRef",ref:u,modelValue:v.value,"onUpdate:modelValue":g[1]||(g[1]=z=>v.value=z),lang:"python",options:$.value,class:"border border-gray-200 dark:border-gray-800 rounded",style:{height:"500px"}},{default:L(()=>g[5]||(g[5]=[ye(" Loading editor... ")])),_:1},8,["modelValue","options"])]),_:1})])])]),_:1})]),_:1},8,["modelValue"])}}}),ts={class:"w-16 overflow-hidden"},ss={class:"w-8 overflow-hidden"},os={key:0,class:"w-full transition-all overflow-hidden duration-300 bg-gray-50 dark:bg-gray-800"},ls=["onClick"],rs={class:"w-16 overflow-hidden text-center"},as={class:"w-12 overflow-hidden text-center"},ns={class:"w-8 overflow-hidden text-center"},is={class:"p-4"},ds={class:"mt-4"},us={class:"w-full text-sm"},cs={class:"w-full"},fs={class:"w-full flex justify-between bg-gray-50 dark:bg-gray-800 py-2 px-4"},ms={class:"w-full flex justify-between py-2 px-4"},vs={class:"w-full flex justify-between bg-gray-50 dark:bg-gray-800 py-2 px-4"},ps={class:"w-full flex justify-between py-2 px-4"},gs={class:"w-full flex justify-between bg-gray-50 dark:bg-gray-800 py-2 px-4"},ys={class:"w-full flex justify-between py-2 px-4"},bs={class:"w-full flex justify-between bg-gray-50 dark:bg-gray-800 py-2 px-4"},hs={class:"w-full flex justify-between py-2 px-4"},ws={class:"w-full flex justify-between bg-gray-50 dark:bg-gray-800 py-2 px-4"},ks={class:"w-full"},xs={class:"w-full flex justify-between bg-gray-50 dark:bg-gray-800 py-2 px-4"},_s={class:"w-full flex justify-between py-2 px-4"},$s={class:"w-full flex justify-between bg-gray-50 dark:bg-gray-800 py-2 px-4"},Cs={key:0,class:"w-full flex justify-between py-2 px-4"},Vs={key:1,class:"w-full flex justify-between bg-gray-50 dark:bg-gray-800 py-2 px-4"},Ss={key:2,class:"w-full flex justify-between py-2 px-4"},Ts={class:"flex justify-end mt-4"},js=oe({__name:"ChartOrders",props:{trade:{}},emits:["zoom","hoverbg"],setup(P,{emit:n}){const b=n,m=w(null),i=w(!1),v=w(!1);return(u,t)=>{const c=dt,$=be,U=Le;return a(),p(Z,null,[r($,{variant:"ghost",color:"gray",class:"w-full flex justify-between hover:bg-gray-100 dark:hover:bg-gray-800 text-xs border-b border-gray-100 dark:border-gray-800 rounded-none p-2",onClick:t[1]||(t[1]=y=>v.value=!l(v)),onMouseover:t[2]||(t[2]=y=>b("hoverbg",u.trade.orders[0].id))},{default:L(()=>[s("div",{class:Y(["w-2 transition-all duration-300",[l(v)?"rotate-90":"rotate-0"]])},t[5]||(t[5]=[s("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor",class:"size-4"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m8.25 4.5 7.5 7.5-7.5 7.5"})],-1)]),2),s("div",ts,_(l(te).roundPrice(u.trade.entry_price)),1),t[6]||(t[6]=s("div",{class:"w-1 opacity-20"},"|",-1)),s("div",{class:Y(["w-16 overflow-hidden",u.trade.type.toLowerCase()==="long"?"text-green-500":"text-red-500"])},_(l(ue).round(u.trade.qty,2)),3),t[7]||(t[7]=s("div",{class:"w-1 opacity-20"},"|",-1)),s("div",{class:Y([[u.trade.PNL_percentage>0?"text-green-500":"text-red-500"],"w-16 overflow-hidden text-xs"])},_(l(ue).round(u.trade.PNL_percentage,2))+"% ",3),t[8]||(t[8]=s("div",{class:"w-1 opacity-20"},"|",-1)),s("div",ss,[r($,{color:"gray",size:"xs",onClick:t[0]||(t[0]=Ne(y=>b("zoom",u.trade.orders[0].id),["stop"]))},{default:L(()=>[r(c,{name:"i-heroicons-arrow-right"})]),_:1})])]),_:1}),l(v)?(a(),p("div",os,[t[13]||(t[13]=He('<div class="flex justify-between items-center border-b-2 border-gray-200 dark:border-gray-700 px-1 py-2 text-xs"><div class="w-16 overflow-hidden italic font-bold uppercase text-center">PRICE</div><div class="w-1 opacity-20">|</div><div class="w-10 overflow-hidden italic font-bold uppercase text-center">QTY</div><div class="w-1 opacity-20">|</div><div class="w-12 overflow-hidden italic font-bold uppercase text-center">TYPE</div><div class="w-1 opacity-20">|</div><div class="w-10 overflow-hidden italic font-bold uppercase text-center">SIDE</div><div class="w-1 opacity-20">|</div><div class="w-8 overflow-hidden italic font-bold uppercase text-center"></div></div>',1)),(a(!0),p(Z,null,me(u.trade.orders,(y,T)=>(a(),p("div",{key:T,class:"w-full flex justify-between items-center hover:bg-gray-200 dark:hover:bg-gray-900 text-xs py-2 border-b border-gray-200 cursor-pointer dark:border-gray-700 px-1",onClick:f=>{m.value=y,i.value=!0}},[s("div",rs,_(l(te).roundPrice(y.price)),1),t[9]||(t[9]=s("div",{class:"w-1 opacity-20"},"|",-1)),s("div",{class:Y(["w-10 overflow-hidden text-center",y.side==="buy"?"text-green-500":"text-red-500"])},_(l(ue).round(y.qty,2)),3),t[10]||(t[10]=s("div",{class:"w-1 opacity-20"},"|",-1)),s("div",as,_(y.type),1),t[11]||(t[11]=s("div",{class:"w-1 opacity-20"},"|",-1)),s("div",{class:Y([[y.side==="buy"?"text-green-500":"text-red-500"],"w-10 overflow-hidden text-center"])},_(y.side.toUpperCase()),3),t[12]||(t[12]=s("div",{class:"w-1 opacity-20"},"|",-1)),s("div",ns,[r($,{color:"gray",size:"xs",onClick:Ne(f=>b("zoom",y.id),["stop"])},{default:L(()=>[r(c,{name:"i-heroicons-arrow-right"})]),_:2},1032,["onClick"])])],8,ls))),128))])):k("",!0),r(U,{modelValue:l(i),"onUpdate:modelValue":t[4]||(t[4]=y=>ae(i)?i.value=y:null)},{default:L(()=>{var y,T,f,g,R,q,D,V,j,z,G;return[s("div",is,[s("div",ds,[s("div",us,[t[29]||(t[29]=s("h2",{class:"text-lg mb-2 font-bold italic dark:text-white text-center"}," Trade ",-1)),s("div",cs,[s("div",fs,[t[14]||(t[14]=s("div",{class:"font-bold"},"Entry Price",-1)),s("div",null,_(l(te).roundPrice(u.trade.entry_price)),1)]),s("div",ms,[t[15]||(t[15]=s("div",{class:"font-bold"},"Exit Price",-1)),s("div",null,_(l(te).roundPrice(u.trade.exit_price)),1)]),s("div",vs,[t[16]||(t[16]=s("div",{class:"font-bold"},"Qty",-1)),s("div",null,_(u.trade.qty),1)]),s("div",ps,[t[17]||(t[17]=s("div",{class:"font-bold"},"Size",-1)),s("div",null,_(l(te).roundPrice(u.trade.size)),1)]),s("div",gs,[t[18]||(t[18]=s("div",{class:"font-bold"},"PNL",-1)),s("div",{class:Y([u.trade.PNL>0?"text-green-500":"text-red-500"])},_(l(ue).round(u.trade.PNL,2))+" ("+_(l(ue).round(u.trade.PNL_percentage,2))+"%) ",3)]),s("div",ys,[t[19]||(t[19]=s("div",{class:"font-bold"},"Fee",-1)),s("div",null,_(l(ue).round(u.trade.fee,2)),1)]),s("div",bs,[t[20]||(t[20]=s("div",{class:"font-bold"},"Holding Period",-1)),s("div",null,_(l(te).secondsToHumanReadable(u.trade.holding_period)),1)]),s("div",hs,[t[21]||(t[21]=s("div",{class:"font-bold"},"Opened At",-1)),s("div",null,_(new Date(u.trade.opened_at).toLocaleString()),1)]),s("div",ws,[t[22]||(t[22]=s("div",{class:"font-bold"},"Closed At",-1)),s("div",null,_(new Date(u.trade.closed_at).toLocaleString()),1)])]),t[30]||(t[30]=s("h2",{class:"text-lg font-bold italic dark:text-white mt-6 mb-2 text-center"}," Order ",-1)),s("div",ks,[s("div",xs,[t[23]||(t[23]=s("div",{class:"font-bold"},"Side",-1)),s("div",{class:Y([((y=l(m))==null?void 0:y.side)==="buy"?"text-green-500":"text-red-500"])},_((f=(T=l(m))==null?void 0:T.side)==null?void 0:f.toUpperCase()),3)]),s("div",_s,[t[24]||(t[24]=s("div",{class:"font-bold"},"Type",-1)),s("div",null,_((g=l(m))==null?void 0:g.type),1)]),s("div",$s,[t[25]||(t[25]=s("div",{class:"font-bold"},"Qty",-1)),s("div",null,_((R=l(m))==null?void 0:R.qty),1)]),(q=l(m))!=null&&q.created_at?(a(),p("div",Cs,[t[26]||(t[26]=s("div",{class:"font-bold"},"Created At",-1)),s("div",null,_(new Date((D=l(m))==null?void 0:D.created_at).toLocaleString()),1)])):k("",!0),(V=l(m))!=null&&V.executed_at?(a(),p("div",Vs,[t[27]||(t[27]=s("div",{class:"font-bold"},"Executed At",-1)),s("div",null,_(new Date((j=l(m))==null?void 0:j.executed_at).toLocaleString()),1)])):k("",!0),(z=l(m))!=null&&z.canceled_at?(a(),p("div",Ss,[t[28]||(t[28]=s("div",{class:"font-bold"},"Canceled At",-1)),s("div",null,_(new Date((G=l(m))==null?void 0:G.canceled_at).toLocaleString()),1)])):k("",!0)])]),s("div",Ts,[r($,{color:"gray",block:"",onClick:t[3]||(t[3]=J=>i.value=!1)},{default:L(()=>t[31]||(t[31]=[ye(" Close ")])),_:1})])])])]}),_:1},8,["modelValue"])],64)}}}),Ls={class:"w-0 sidebar whitespace-nowrap relative transition-all duration-300"},Rs={key:1,class:"h-full flex justify-center items-center text-xs text-gray-500"},Es=oe({__name:"ChartSidebar",props:_e({items:{}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:_e(["zoom","hoverbg"],["update:modelValue"]),setup(P,{emit:n}){const b=$e(P,"modelValue"),m=n;return(i,v)=>{const u=js;return a(),p("div",Ls,[s("div",{class:Y([b.value?"w-96 p-2":"w-0 p-0","absolute h-full overflow-y-auto border-r-2 dark:border-gray-800 transition-all duration-300 z-0"])},[i.items.length>0?(a(),p(Z,{key:0},[v[2]||(v[2]=He('<div class="flex justify-between items-center border-b-2 p-2 text-xs dark:border-gray-800"><div class="w-2"></div><div class="w-16 overflow-hidden italic font-bold uppercase text-center">ENTRY</div><div class="w-1 opacity-20">|</div><div class="w-16 overflow-hidden italic font-bold uppercase text-center">QTY</div><div class="w-1 opacity-20">|</div><div class="w-16 overflow-hidden italic font-bold uppercase text-center">PNL</div><div class="w-1 opacity-20">|</div><div class="w-8 overflow-hidden italic font-bold uppercase text-center"></div></div>',1)),(a(!0),p(Z,null,me(i.items,(t,c)=>(a(),p("div",{key:c,class:"w-full"},[r(u,{trade:t,onZoom:v[0]||(v[0]=$=>m("zoom",$)),onHoverbg:v[1]||(v[1]=$=>m("hoverbg",$))},null,8,["trade"])]))),128))],64)):(a(),p("div",Rs," No trades were executed "))],2)])}}}),zs={class:"w-full h-full flex justify-between border-2 border-gray-200 dark:border-gray-800 rounded-lg"},Us={class:"w-full flex flex-col h-full border dark:border-gray-800"},Ms={key:0},Os=oe({__name:"BacktestCandlesChart",props:_e({form:{},results:{}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:["update:modelValue"],setup(P){const n=qe(),b=w(2),m=$e(P,"modelValue"),i=P,v=w(),u=w([]);let t=null,c=null;const $=[],U=[],y=B(()=>We().params.id),T=B(()=>ee.extraChartLines[y.value].find(h=>h.symbol===i.results.selectedRoute.symbol)),f=B(()=>n.value),g=B(()=>Ce());W(f,h=>{z(h)}),W(()=>i.results.selectedRoute.symbol,()=>{j(),setTimeout(async()=>{await R()},100)}),Ee(async()=>{setTimeout(async()=>{await R()},200)}),W(m,()=>{setTimeout(()=>{q()},300)});async function R(){var ne,ie,de,F;xe.width=v.value.clientWidth,xe.height=v.value.clientHeight-Object.keys(T.value.charts).length*150,t=De(v.value,xe),t.applyOptions({rightPriceScale:{borderColor:f.value==="light"?"#d1d4dc":"#4b5563",minimumWidth:80},watermark:{visible:!0,fontSize:16,horzAlign:"left",vertAlign:"bottom",color:"#888",text:`${i.results.selectedRoute.symbol} • ${i.results.selectedRoute.timeframe}`}}),c=t.addCandlestickSeries();const h=ee.candles[y.value].find(S=>S.symbol===i.results.selectedRoute.symbol).candles;c.setData(h),c.setMarkers(ee.orders[y.value].find(S=>S.symbol===i.results.selectedRoute.symbol).orders);const x=String(h[0].open).indexOf("."),C=x===-1?0:String(h[h.length-1].open).length-x-1;b.value!==C&&(b.value=C,(b.value<0||b.value>100)&&(b.value=0),c.applyOptions({priceFormat:{type:"price",precision:b.value,minMove:Math.pow(10,-b.value).toFixed(b.value)}}));const N=(ie=(ne=ee.lines[y.value])==null?void 0:ne.find(S=>S.symbol===i.results.selectedRoute.symbol))==null?void 0:ie.lines;if(N)for(const S of Object.keys(N)){const E=N[S];t.addLineSeries({lineWidth:1,title:S}).setData(E.data)}const I=(F=(de=ee.horizontalLines[y.value])==null?void 0:de.find(S=>S.symbol===i.results.selectedRoute.symbol))==null?void 0:F.lines;if(I)for(const S of Object.keys(I)){const H=I[S];c.createPriceLine(H)}t.timeScale().fitContent();const le=new Set;Object.keys(T.value.charts).forEach((S,E)=>{const H={...xe};H.width=u.value[E].clientWidth,H.height=150;const A=De(u.value[E],H);$.push(A),Object.keys(T.value.charts[S]).forEach(se=>{var he,we;const X=A.addLineSeries({lineWidth:1,title:se}),ve=(we=(he=ee.horizontalExtraLines[y.value])==null?void 0:he.find(e=>e.symbol===i.results.selectedRoute.symbol))==null?void 0:we.lines[S];if(ve&&!le.has(S)){for(const e of Object.keys(ve)){const pe=ve[e];X.createPriceLine(pe)}le.add(S)}X.setData(T.value.charts[S][se].data),U.push(X)}),A.applyOptions({rightPriceScale:{borderColor:f.value==="light"?"#d1d4dc":"#4b5563",minimumWidth:80},watermark:{visible:!0,fontSize:16,horzAlign:"left",vertAlign:"bottom",color:"#888",text:S}}),A.timeScale().subscribeVisibleLogicalRangeChange(se=>{t.timeScale().setVisibleLogicalRange(se)}),E!==Object.keys(T.value.charts).length-1&&A.timeScale().applyOptions({visible:!1})}),t.subscribeCrosshairMove(S=>{const E=D(c,S);Object.keys(T.value.charts).forEach((H,A)=>{V($[A],U[A],E)})}),Object.keys(T.value.charts).forEach((S,E)=>{$[E].subscribeCrosshairMove(H=>{const A=D(U[E],H);V(t,c,A),$.forEach((se,X)=>{X!==E&&V(se,U[X],A)})})}),t.timeScale().subscribeVisibleLogicalRangeChange(S=>{$.forEach(E=>{E.timeScale().setVisibleLogicalRange(S)})}),z(f.value),$.length>0&&t.timeScale().applyOptions({visible:!1})}function q(){var h;t!==null&&(t.applyOptions({width:(h=v.value)==null?void 0:h.clientWidth}),$.forEach(x=>{var C;x.applyOptions({width:(C=v.value)==null?void 0:C.clientWidth})}))}ut(()=>{j()});function D(h,x){return x.time&&x.seriesData.get(h)||null}function V(h,x,C){if(C){h.setCrosshairPosition(C.value,C.time,x);return}h.clearCrosshairPosition()}function j(){t!==null&&(t.remove(),t=null),c!==null&&(c=null),$.length>0&&($.forEach(h=>{h.remove()}),$.length=0),U.length>0&&(U.length=0)}function z(h){t!==null&&(t.applyOptions(h==="light"?Pe.chart:Ie.chart),$.forEach(x=>{x.applyOptions(h==="light"?Pe.chart:Ie.chart)}))}function G(h){const x=ee.orders[y.value].find(N=>N.symbol===i.results.selectedRoute.symbol).orders,C=x.find(N=>N.order_id===h);if(C&&t){const N=(typeof C.time=="number",C.time),I=t.timeScale(),le=x[1].time-x[0].time,ne=N-le*5,ie=N+le*5,de=C.color;c==null||c.setMarkers(x.map(F=>F.order_id===h?{...F,color:"#FFA500"}:F)),I.setVisibleRange({from:ne,to:ie}),setTimeout(()=>{c==null||c.setMarkers(x.map(F=>F.order_id===h?{...F,color:de}:F))},2e3)}}function J(h){const x=ee.orders[y.value].find(N=>N.symbol===i.results.selectedRoute.symbol).orders,C=x.find(N=>N.order_id===h);if(C&&t){const N=C.color;c==null||c.setMarkers(x.map(I=>I.order_id===h?{...I,color:"#FFA500"}:I)),setTimeout(()=>{c==null||c.setMarkers(x.map(I=>I.order_id===h?{...I,color:N}:I))},2e3)}}function Ce(){return i.results.trades.filter(h=>h.symbol===i.results.selectedRoute.symbol)}return(h,x)=>(a(),p("div",zs,[r(Es,{modelValue:m.value,"onUpdate:modelValue":x[0]||(x[0]=C=>m.value=C),items:l(g),onHoverbg:x[1]||(x[1]=C=>J(C)),onZoom:x[2]||(x[2]=C=>G(C))},null,8,["modelValue","items"]),s("div",{class:Y([[m.value?"w-[calc(100%-384px)]":"w-full"],"h-full transition-all duration-300"])},[s("div",Us,[s("div",{ref_key:"chartContainer",ref:v,class:"rounded overflow-hidden flex-grow"},null,512),l(T)&&Object.keys(l(T).charts).length?(a(),p("div",Ms,[(a(!0),p(Z,null,me(Object.keys(l(T).charts),C=>(a(),p("div",{key:C,ref_for:!0,ref_key:"extraChartsRef",ref:u,class:"relative border-t-[1.5px] dark:border-gray-800"}))),128))])):k("",!0)])],2)]))}}),Bs={key:0,class:"flex flex-col items-center justify-center select-none mt-[10%]"},Ns=["textContent"],Ps={class:"mt-8"},Is={class:"mt-8 flex flex-col gap-4"},Ds={key:0,class:"mt-4"},As={key:1,class:"mx-auto container mt-8"},Fs={key:0},qs={class:"mb-4 mt-4"},Hs={class:"flex items-center select-none flex-1 my-4"},Ws={class:"grid grid-cols-1 gap-6 mt-8"},Gs={key:1,class:"w-full mx-auto"},Js={key:4,class:"text-yellow-500 border-yellow-400 bg-yellow-50 dark:bg-gray-700 dark:text-yellow-400 mt-16 text-center text-2xl rounded border-2 border-dashed dark:border-gray-800 py-16 select-none"},Qs={class:"flex justify-start"},Ys={key:0,class:"flex h-[800px] border border-gray-200 dark:border-gray-800 rounded overflow-hidden"},Zs={class:"w-[460px] flex-shrink-0 border-r border-gray-200 dark:border-gray-800 bg-white dark:bg-gray-900"},Xs={class:"flex items-center border-b border-gray-200 dark:border-gray-800 px-6 py-3 bg-gray-50 dark:bg-gray-900"},Ks={class:"flex gap-16"},eo={class:"overflow-auto"},to={class:"flex gap-12 flex-1"},so={class:"flex-1 bg-white dark:bg-gray-900"},oo={key:0},lo={key:0},ro=["href"],ao=["href"],no=["href"],io={key:5,class:"my-4"},uo={key:1},co=oe({__name:"BacktestTab",props:{form:{},results:{}},setup(P){const n=P,b=w(!1),m=w(!1),i=w(!0),v=w(!1),u=w([]),t=w([]),c=w(!1),$=w(!1),U=je().authToken,y=w(ct().public.apiBaseUrl),T=w(!1),f=w(!1),g=w(!1),R=w(null),q=w(null),D=w(null),V=B(()=>We().params.id),j=Ge(),z=je(),G=ft(),J=w([]),Ce=B(()=>z.jesseSupportedTimeframes.map(e=>({label:e,value:e}))),h=B(()=>n.form.routes.map(e=>({label:`${e.strategy} • ${e.symbol}`,value:e})));n.results.selectedRoute=n.form.routes[0],Ee(async()=>{setTimeout(async()=>{await z.initiate(),!n.form.exchange&&z.backtestingExchangeNames.length&&(n.form.exchange=z.backtestingExchangeNames[0]),(!n.results.showResults&&n.form.exchange||!J.value.length)&&await x()},50)});async function x(){if(n.form.exchange)try{J.value=await z.getExchangeSupportedSymbols(n.form.exchange);for(let e=0;e<n.form.routes.length;e++)J.value.includes(n.form.routes[e].symbol)||(n.form.routes[e].symbol=J.value[0]);if(n.form.data_routes.length>0)for(let e=0;e<n.form.data_routes.length;e++)J.value.includes(n.form.data_routes[e].symbol)||(n.form.data_routes[e].symbol=J.value[0])}catch(e){console.error("Error updating supported symbols:",e)}}W(()=>n.form.exchange,async(e,o)=>{e!==o&&await x()}),W(f,async e=>{if(e){const o=await j.getSessionData(V.value);o&&(R.value=o.title||null,q.value=o.description||null,D.value=o.strategy_codes||null)}}),W(g,async e=>{if(e){const o=await j.getStrategyCode(V.value);o&&(D.value=o)}});const{cancel:C,newBacktest:N,retry:I}=j;function le(e){if(t.value.length){for(let o=0;o<t.value.length;o++)Q("error",t.value[o]);return}u.value=[],j.start(e)}function ne(e){u.value=[],j.rerun(e)}const ie=e=>{if(t.value.length){for(let o=0;o<t.value.length;o++)Q("error",t.value[o]);return}u.value=[],j.startInNewTab(e)},de=B(()=>{let e=`/download/backtest/tradingview/${n.results.generalInfo.session_id}?token=${U}`;return y.value!=="/"&&(e=y.value+e),e});B(()=>{let e=`/download/backtest/full-reports/${n.results.generalInfo.session_id}?token=${U}`;return y.value!=="/"&&(e=y.value+e),e});const F=B(()=>{let e=`/download/backtest/csv/${n.results.generalInfo.session_id}?token=${U}`;return y.value!=="/"&&(e=y.value+e),e}),S=B(()=>{let e=`/download/backtest/json/${n.results.generalInfo.session_id}?token=${U}`;return y.value!=="/"&&(e=y.value+e),e}),E=B(()=>j.formattedMetrics(V.value).length>0),H=B(()=>te.remainingTimeText(n.results.progressbar.estimated_remaining_seconds));function A(){try{u.value.length>1e6&&Q("success","Copying large log file, please wait..."),setTimeout(()=>{navigator.clipboard.writeText(u.value.join(`
`)),Q("success","Logs copied successfully"),$.value=!0,setTimeout(()=>{$.value=!1},3e3)},0)}catch{Q("error","Failed to copy logs")}}async function se(){const e=j.missingCandlesErrors[V.value];e&&(G.forms.push({id:te.uuid(),exchange:e.exchange,symbol:e.symbol,start_date:e.start_date,executing:!1,waiting:!1,progressbar:{current:0,estimated_remaining_seconds:0},exception:{error:"",traceback:""},alert:{message:"",type:""}}),await Re("/candles/"),await G.start(G.forms[G.forms.length-1].id))}async function X(){u.value.length===0?await ve():v.value=!0}async function ve(){b.value=!0;try{const{data:e,error:o}=await kt(`/backtest/logs/${V.value}?token=${U}`,!1);if(o.value){Q("error",o.value.message),b.value=!1;return}const pe=e.value;setTimeout(()=>{const Se=te.decompressData(pe.content).split(`
`).map(ke=>{const M=ke.match(/\[INFO \| (.*?)\] (.*)/);return M?`[${M[1]}] ${M[2]}`:ke});u.value=Se,b.value=!1,v.value=!0},0)}catch{Q("error","Failed to fetch logs"),b.value=!1}}async function he(){let e=`/backtest/download-log/${V.value}?token=${U}`;y.value!=="/"&&(e=y.value+e),window.open(e,"_blank")}async function we(){if(T.value=!0,!ee.candles[V.value]){m.value=!0;const e=await j.loadChartData(V.value);if(m.value=!1,!e){Q("error","Failed to load chart data"),T.value=!1;return}}}return(e,o)=>{const pe=qt,Ve=mt,Se=gt,ke=_t,M=be,Je=Ct,ze=St,ge=bt,Ue=Tt,Qe=jt,Me=ht,re=wt,Ye=Lt,Oe=yt,K=Rt,Ze=Wt,Te=Et,Xe=zt,Ke=Vt,et=Mt,tt=Ot,st=es;return a(),p(Z,null,[r(Se,{modelValue:l(v),"onUpdate:modelValue":o[0]||(o[0]=d=>ae(v)?v.value=d:null),title:"Logs"},{default:L(()=>[r(pe,{logs:l(u)},null,8,["logs"])]),buttons:L(()=>[r(Ve,{text:"Copy",class:"inline-block",popper:{arrow:!0}},{default:L(()=>[s("button",{class:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 focus:outline-none",onClick:A},[l($)?(a(),O(l(vt),{key:0,class:"h-6 w-6","aria-hidden":"true"})):k("",!0),!l($)&&l(u).length!=0?(a(),O(l($t),{key:1,class:"h-6 w-6","aria-hidden":"true"})):k("",!0)])]),_:1}),r(Ve,{text:"Download",class:"inline-block ml-2",popper:{arrow:!0}},{default:L(()=>[s("button",{class:"p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 focus:outline-none",onClick:he},[l(u).length!=0?(a(),O(l(pt),{key:0,class:"h-6 w-6","aria-hidden":"true"})):k("",!0)])]),_:1})]),_:1},8,["modelValue"]),e.results.executing&&!e.results.showResults?(a(),p("div",Bs,[s("div",null,[r(ke,{progress:e.results.progressbar.current},null,8,["progress"])]),e.results.exception.error?k("",!0):(a(),p("h3",{key:0,class:"mt-8 animate-pulse",textContent:_(l(H))},null,8,Ns)),s("div",Ps,[s("div",Is,[e.results.exception.error?(a(),O(M,{key:0,color:"primary",class:"w-64 flex justify-center",icon:"i-heroicons-arrow-path",size:"xl",variant:"solid",label:"Retry",trailing:!1,onClick:o[1]||(o[1]=d=>l(I)((e._.provides[ce]||e.$route).params.id))})):k("",!0),r(M,{color:"gray",ui:{color:{gray:{solid:"text-rose-500 dark:text-rose-400"}}},class:"w-64 flex justify-center",icon:"i-heroicons-no-symbol",size:"xl",variant:"solid",label:"Cancel",trailing:!1,onClick:o[2]||(o[2]=d=>l(C)((e._.provides[ce]||e.$route).params.id))})]),e.form.debug_mode&&e.results.exception.error?(a(),p("div",Ds,[r(M,{icon:"i-heroicons-clipboard-document-list",label:"Debugging Logs",color:"gray",size:"xl",variant:"solid",trailing:!1,class:"w-64 flex justify-center",onClick:X})])):k("",!0)]),e.results.exception.error&&e.results.executing?(a(),p("div",As,[r(Je,{modelValue:l(c),"onUpdate:modelValue":o[3]||(o[3]=d=>ae(c)?c.value=d:null),title:e.results.exception.error,content:e.results.exception.traceback,mode:"backtest","debug-mode":e.form.debug_mode},null,8,["modelValue","title","content","debug-mode"])])):k("",!0)])):k("",!0),r(et,null,{left:L(()=>[!e.results.executing&&!e.results.showResults?(a(),p("div",Fs,[l(j).missingCandlesErrors[l(V)]?(a(),O(ze,{key:0,icon:"i-heroicons-exclamation-triangle",color:"rose",variant:"soft",class:"mb-4"},{title:L(()=>o[29]||(o[29]=[s("h3",{class:"text-lg font-semibold"},"Missing Required Warmup Candles",-1)])),description:L(()=>[s("p",qs,[o[30]||(o[30]=ye(" Your strategy requires ")),o[31]||(o[31]=s("strong",{class:"font-bold"},"warmup candles",-1)),ye(' for "'+_(l(j).missingCandlesErrors[l(V)].symbol)+'" on "'+_(l(j).missingCandlesErrors[l(V)].exchange)+'" starting from "'+_(l(j).missingCandlesErrors[l(V)].start_date)+'". These candles are needed for proper strategy initialization. ',1)]),r(M,{label:"Import Required Candles",icon:"i-heroicons-arrow-down-tray",onClick:se})]),_:1})):k("",!0),r(ge,{class:"mb-4",title:"Exchange"}),r(Ue,{modelValue:e.form.exchange,"onUpdate:modelValue":o[4]||(o[4]=d=>e.form.exchange=d),placeholder:"Select an exchange...",searchable:"",options:l(je)().backtestingExchangeNames,size:"lg",class:"mt-2 mb-16"},null,8,["modelValue","options"]),r(Qe,{"total-routes-error":l(t),timeframes:l(Ce),form:e.form,results:e.results,symbols:l(J),mode:"backtest"},null,8,["total-routes-error","timeframes","form","results","symbols"]),r(ge,{class:"mt-16",title:"Duration"}),s("div",Hs,[r(Me,{modelValue:e.form.start_date,"onUpdate:modelValue":o[5]||(o[5]=d=>e.form.start_date=d),type:"date",variant:"outline",size:"lg",class:"w-full mr-2"},null,8,["modelValue"]),r(Me,{modelValue:e.form.finish_date,"onUpdate:modelValue":o[6]||(o[6]=d=>e.form.finish_date=d),type:"date",variant:"outline",size:"lg",class:"w-full ml-2"},null,8,["modelValue"])]),r(ge,{class:"mt-16",title:"Options"}),s("div",Ws,[r(re,{modelValue:e.form.debug_mode,"onUpdate:modelValue":o[7]||(o[7]=d=>e.form.debug_mode=d),title:"Debug Mode",description:"Logs every step of the execution. Very helpful for debugging your strategy but takes a lot longer to execute"},null,8,["modelValue"]),r(re,{modelValue:e.form.export_chart,"onUpdate:modelValue":o[8]||(o[8]=d=>e.form.export_chart=d),title:"Generate Interactive Charts",description:"Generate interactive charts for backtest results with details."},null,8,["modelValue"]),r(re,{modelValue:e.form.export_tradingview,"onUpdate:modelValue":o[9]||(o[9]=d=>e.form.export_tradingview=d),title:"Export Tradingview",description:"Exports the executed trades in a format accepted by TradingView's Pine Editor. Useful to look at the executed orders on their chart."},null,8,["modelValue"]),r(re,{modelValue:e.form.export_csv,"onUpdate:modelValue":o[10]||(o[10]=d=>e.form.export_csv=d),title:"Export CSV",description:"Exports executed trades in a CSV format"},null,8,["modelValue"]),r(re,{modelValue:e.form.export_json,"onUpdate:modelValue":o[11]||(o[11]=d=>e.form.export_json=d),title:"Export JSON",description:"Exports executed trades in a JSON format"},null,8,["modelValue"]),r(re,{modelValue:e.form.fast_mode,"onUpdate:modelValue":o[12]||(o[12]=d=>e.form.fast_mode=d),title:"Fast Mode",description:"Runs the backtest faster by using an improved algorithm. This is supposed to yield the same results; however, it's currently experimental, which is why it's an option."},null,8,["modelValue"]),r(re,{modelValue:e.form.benchmark,"onUpdate:modelValue":o[13]||(o[13]=d=>e.form.benchmark=d),title:"Benchmark",description:"If enabled, the backtest will compare the performance of the strategy against the buy and hold strategy of the market."},null,8,["modelValue"])])])):k("",!0),e.results.showResults?(a(),p("div",Gs,[s("div",null,[l(E)?(a(),O(ge,{key:0,class:"mb-4",title:"Equity Curve"})):k("",!0),l(E)?(a(),O(Ye,{key:1,data:e.results.charts.equity_curve},null,8,["data"])):k("",!0),l(E)?(a(),O(ge,{key:2,class:"mt-16 mb-4",title:"Performance"})):k("",!0),l(E)?(a(),O(Oe,{key:3,data:l(j).formattedMetrics(l(V))},null,8,["data"])):k("",!0),l(E)?k("",!0):(a(),p("div",Js," No trades were executed via this strategy! "))]),r(Ze,{modelValue:l(T),"onUpdate:modelValue":o[17]||(o[17]=d=>ae(T)?T.value=d:null)},{title:L(()=>[s("div",Qs,[r(Ue,{modelValue:e.results.selectedRoute,"onUpdate:modelValue":o[14]||(o[14]=d=>e.results.selectedRoute=d),"value-attribute":"value",options:l(h)},null,8,["modelValue","options"]),r(M,{class:"ml-2",color:"gray",label:l(i)?"Hide Trades":"Show Trades",onClick:o[15]||(o[15]=d=>i.value=!l(i))},null,8,["label"])])]),default:L(()=>[l(m)?(a(),p("div",Ys,[s("div",Zs,[s("div",Xs,[s("div",Ks,[r(K,{class:"h-4 w-12"}),r(K,{class:"h-4 w-12"}),r(K,{class:"h-4 w-12"})])]),s("div",eo,[(a(),p(Z,null,me(14,d=>s("div",{key:d,class:"flex items-center px-4 py-3.5 border-b border-gray-200 dark:border-gray-800"},[r(K,{class:"h-4 w-4 mr-4"}),s("div",to,[r(K,{class:"h-4 w-14"}),r(K,{class:"h-4 w-10"}),r(K,{class:"h-4 w-14"})]),r(K,{class:"h-7 w-7 rounded"})])),64))])]),s("div",so,[r(K,{class:"w-full h-full"})])])):(a(),O(Os,{key:1,modelValue:l(i),"onUpdate:modelValue":o[16]||(o[16]=d=>ae(i)?i.value=d:null),results:e.results,form:e.form},null,8,["modelValue","results","form"]))]),_:1},8,["modelValue"])])):k("",!0)]),right:L(()=>[e.results.executing?k("",!0):(a(),p("div",oo,[e.results.showResults?(a(),p("div",lo,[r(M,{class:"w-full flex justify-center",icon:"i-heroicons-arrow-path",size:"xl",variant:"solid",label:"Rerun",trailing:!1,onClick:o[18]||(o[18]=d=>ne((e._.provides[ce]||e.$route).params.id))}),r(M,{class:"w-full flex justify-center mt-4",color:"green",icon:"i-heroicons-arrow-uturn-left",size:"xl",variant:"solid",label:"New session",trailing:!1,onClick:o[19]||(o[19]=d=>l(N)((e._.provides[ce]||e.$route).params.id))}),r(M,{class:"w-full flex justify-center mt-4",color:"gray",icon:"i-heroicons-pencil-square",size:"xl",variant:"solid",label:"Title & Notes",trailing:!1,onClick:o[20]||(o[20]=d=>f.value=!0)}),r(M,{class:"w-full flex justify-center mt-4",color:"gray",icon:"i-heroicons-code-bracket",size:"xl",variant:"solid",label:"View Strategy Snapshot",trailing:!1,onClick:o[21]||(o[21]=d=>g.value=!0)}),e.form.debug_mode?(a(),O(M,{key:0,class:"w-full flex justify-center mt-4",color:"gray",icon:"i-heroicons-clipboard-document-list",size:"xl",variant:"solid",label:"Debugging Logs",loading:l(b),trailing:!1,onClick:o[22]||(o[22]=d=>X())},null,8,["loading"])):k("",!0),e.form.export_chart?(a(),O(M,{key:1,class:"mt-4 flex justify-center items-center btn-secondary text-center",color:"gray",icon:"i-heroicons-chart-bar",size:"xl",block:"",variant:"solid",label:"View charts",trailing:!1,onClick:o[23]||(o[23]=d=>we())})):k("",!0),e.form.export_csv&&l(E)?(a(),p("a",{key:2,href:l(F),target:"_blank",class:"flex justify-center items-center btn-secondary text-center w-full"},[r(M,{class:"w-full flex justify-center mt-4",color:"gray",icon:"i-heroicons-document-arrow-down",size:"xl",variant:"solid",label:"CSV",trailing:!1})],8,ro)):k("",!0),e.form.export_json&&l(E)?(a(),p("a",{key:3,href:l(S),target:"_blank",class:"flex justify-center items-center btn-secondary text-center w-full"},[r(M,{class:"w-full flex justify-center mt-4",color:"gray",icon:"i-heroicons-document-arrow-down",size:"xl",variant:"solid",label:"JSON",trailing:!1})],8,ao)):k("",!0),e.form.export_tradingview&&l(E)?(a(),p("a",{key:4,href:l(de),target:"_blank",class:"flex justify-center items-center btn-secondary text-center mb-4 w-full"},[r(M,{class:"w-full flex justify-center mt-4",color:"gray",icon:"i-heroicons-document-arrow-down",size:"xl",variant:"solid",label:"TradingView Pine Editor",trailing:!1})],8,no)):k("",!0),e.results.showResults&&e.results.alert&&e.results.alert.message?(a(),p("div",io,[r(ze,{color:"teal",icon:"i-heroicons-check-circle",variant:"soft",title:e.results.alert.message,"close-button":{icon:"i-heroicons-x-mark-20-solid",color:"white",variant:"link"},onClose:o[24]||(o[24]=d=>e.results.alert.message="")},null,8,["title"])])):k("",!0),r(Te,{class:"mt-8 mb-4",size:"lg",label:"General Info"}),r(Xe,{data:e.results.info},null,8,["data"]),r(Te,{class:"mt-8 mb-4",size:"lg",label:"Routes"}),r(Ke,{data:e.results.routes_info,"header-items":["Symbol","Timeframe","Strategy"],header:""},null,8,["data"]),e.results.hyperparameters.length?(a(),O(Te,{key:6,class:"mt-8 mb-4",size:"lg",label:"Hyperparameters"})):k("",!0),e.results.hyperparameters.length?(a(),O(Oe,{key:7,data:e.results.hyperparameters},null,8,["data"])):k("",!0)])):(a(),p("div",uo,[r(M,{class:"w-full flex justify-center",icon:"i-heroicons-bolt",size:"xl",variant:"solid",label:"Start",trailing:!1,onClick:o[25]||(o[25]=d=>le((e._.provides[ce]||e.$route).params.id))}),r(M,{class:"w-full flex justify-center mt-4",color:"gray",icon:"i-heroicons-plus",size:"xl",variant:"solid",label:"Start in a new tab",trailing:!1,onClick:o[26]||(o[26]=d=>ie((e._.provides[ce]||e.$route).params.id))})]))]))]),_:1}),r(tt,{modelValue:l(f),"onUpdate:modelValue":o[27]||(o[27]=d=>ae(f)?f.value=d:null),"session-id":l(V),"initial-title":l(R),"initial-description":l(q)},null,8,["modelValue","session-id","initial-title","initial-description"]),r(st,{modelValue:l(g),"onUpdate:modelValue":o[28]||(o[28]=d=>ae(g)?g.value=d:null),routes:n.form.routes,exchange:n.form.exchange,"strategy-codes":l(D)},null,8,["modelValue","routes","exchange","strategy-codes"])],64)}}}),fo={class:"w-full"},Ro=oe({__name:"[id]",setup(P){Nt({title:"Backtest - Jesse"});const n=Ge(),b=B(()=>n.tabs),m=B(()=>xt().params.id),i=B(()=>b.value[m.value]);return n.tabIds.length===0&&n.addTab(),Ee(()=>{setTimeout(async()=>{!i.value&&m.value&&(await n.loadSession(m.value)||(n.tabIds.length>0?await Re(`/backtest/${n.tabIds[0]}`):await n.addTab()))},20)}),Ut({w:()=>{i.value&&n.closeTab(i.value.id)},ArrowLeft:()=>n.goToPrevTab(m.value),ArrowRight:()=>n.goToNextTab(m.value)}),(v,u)=>{const t=ot,c=co;return a(),p(Z,null,[s("div",fo,[r(t,{"current-tab":i.value?i.value.id:null,tabs:b.value,onClose:l(n).closeTab,onCancel:l(n).cancel},null,8,["current-tab","tabs","onClose","onCancel"])]),i.value?(a(),O(c,{key:0,form:i.value.form,results:i.value.results},null,8,["form","results"])):k("",!0)],64)}}});export{Ro as default};
