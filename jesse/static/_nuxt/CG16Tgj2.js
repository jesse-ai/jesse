import{_ as Fe}from"./BuV2pFfZ.js";import{d as fe,a as _e,c as T,B as le,r as y,w as D,H as me,F as pe,z as d,g as i,G as h,j as t,L as m,bj as Ue,am as Ee,bk as Ie,I as F,J as P,y as ye,a3 as Be,b6 as He,bb as We,n as Pe,$ as R,i as s,f as b,bc as qe,_ as Ge,e as W,W as f,t as Je,Z as X,a6 as Ke,bd as Qe,q as A,a0 as oe,aw as Ze,bf as x,v as Xe,l as Ye,p as et,s as O,Q as tt,h as st}from"./BZBcjETW.js";import{_ as at}from"./B-2SFkko.js";import{_ as ot,a as lt}from"./Brb7I5l6.js";import{_ as nt}from"./BfP20kJa.js";import{T as it}from"./xgbdnDAz.js";import{s as rt,l as dt,d as ct,_ as ut}from"./DCGi8i1_.js";import{_ as vt}from"./B-Uq0ZUV.js";import{_ as gt}from"./CNlI_mjZ.js";import{_ as ft}from"./QzQJeclP.js";import{_ as _t}from"./CBtiHpmx.js";import{u as mt}from"./D-92rLZE.js";import{r as pt,a as yt}from"./DtUUiKMK.js";import"./CyMeHnuq.js";const bt={key:0,class:"mb-2 p-3 bg-red-100 dark:bg-red-900 text-red-700 dark:text-red-200 rounded-md"},ht={class:"text-sm font-medium"},wt={class:"mt-2 flex items-center justify-between"},xt={class:"flex items-center"},kt=["value"],Ct=fe({__name:"ObjectiveCurveChart",props:{data:{}},setup(ne){const J=_e(),U=T(()=>J.value),$=le(),u=y(null),M=ne,l=T(()=>{const c=$.results.generalInfo.find(S=>S[0]==="Objective Function");return c?{sharpe:"sharpe_ratio",calmar:"calmar_ratio",sortino:"sortino_ratio",omega:"omega_ratio",serenity:"serenity_index","smart sharpe":"smart_sharpe","smart sortino":"smart_sortino"}[c[1].toLowerCase()]||c[1].toLowerCase():"sharpe_ratio"}),z=y(null);let g=null,L=null,j=null;const E=T(()=>M.data.length>0&&M.data[0].training?Object.keys(M.data[0].training):[]),p=T({get:()=>$.results.selectedObjectiveMetric,set:c=>{$.results.selectedObjectiveMetric=c}});D(E,c=>{if(!$.results.selectedObjectiveMetric&&c.length){const r=l.value;c.includes(r)?p.value=r:p.value=c[0]}},{immediate:!0});const k=T(()=>M.data.map(r=>({trial:r.trial,training:r.training[p.value]!==void 0?r.training[p.value]:null,testing:r.testing[p.value]!==void 0?r.testing[p.value]:null})));function q(){if(z.value)try{u.value=null;const c={...rt,width:z.value.clientWidth,height:300,timeScale:{timeVisible:!1,secondsVisible:!1,tickMarkFormatter:r=>Math.floor(r)},localization:{timeFormatter:r=>Math.floor(r)}};g=it(z.value,c),L=g.addLineSeries({color:"#60A5FA",lineWidth:2,title:"Training"}),j=g.addLineSeries({color:"#F87171",lineWidth:2,title:"Testing"}),B(U.value),I()}catch(c){N(c)}}function I(){if(!(!L||!j))try{u.value=null;const c=k.value.sort((C,Y)=>C.trial-Y.trial),r=c.filter(C=>C.training!==null).map(C=>({time:C.trial,value:C.training})),S=c.filter(C=>C.testing!==null).map(C=>({time:C.trial,value:C.testing}));L.setData(r),j.setData(S),g==null||g.timeScale().fitContent()}catch(c){N(c)}}function N(c){console.error("Chart error:",c),u.value=`Failed to render chart: ${c.message||"Unknown error"}`,g&&(g.remove(),g=null,L=null,j=null)}function B(c){if(g)try{g.applyOptions(c==="light"?dt.chart:ct.chart)}catch(r){N(r)}}function K(){if(g&&z.value)try{g.applyOptions({width:z.value.clientWidth})}catch(c){N(c)}}me(()=>{q(),window.addEventListener("resize",K)}),pe(()=>{g&&(g.remove(),g=null),window.removeEventListener("resize",K)}),D(k,I),D(p,I),D(U,B);function Q(c){return c.replace(/_/g," ").toUpperCase()}return(c,r)=>(i(),d("div",null,[u.value?(i(),d("div",bt,[t("p",ht,m(u.value),1)])):h("",!0),t("div",{ref_key:"chartContainer",ref:z,class:"rounded overflow-hidden border-2 border-gray-100 dark:border-gray-600",style:{"min-height":"300px"}},null,512),t("div",wt,[r[2]||(r[2]=Ue('<div class="flex items-center" data-v-a7d13feb><span class="text-xs mr-2 rounded bg-white dark:bg-gray-700 p-1" data-v-a7d13feb><span class="inline-block" style="background-color:#60A5FA;width:25px;height:10px;" data-v-a7d13feb></span><span class="ml-2" data-v-a7d13feb>Training</span></span><span class="text-xs mr-2 rounded bg-white dark:bg-gray-700 p-1" data-v-a7d13feb><span class="inline-block" style="background-color:#F87171;width:25px;height:10px;" data-v-a7d13feb></span><span class="ml-2" data-v-a7d13feb>Testing</span></span></div>',1)),t("div",xt,[r[1]||(r[1]=t("label",{class:"text-sm text-gray-700 dark:text-gray-300 mr-2"},"Metric:",-1)),Ee(t("select",{"onUpdate:modelValue":r[0]||(r[0]=S=>p.value=S),class:"text-sm py-1 px-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 bg-white dark:bg-gray-800"},[(i(!0),d(F,null,P(E.value,S=>(i(),d("option",{key:S,value:S},m(Q(S)),9,kt))),128))],512),[[Ie,p.value]])])])]))}}),Tt=ye(Ct,[["__scopeId","data-v-a7d13feb"]]),St=et(_t),$t={key:0,class:"mb-8"},jt={key:1,class:"mb-8"},zt={key:2,class:"mb-8"},Lt={class:"border-2 border-gray-100 dark:border-gray-600 rounded overflow-hidden p-4 mb-8"},Mt={class:"space-y-2"},Vt={class:"border border-gray-200 bg-white dark:border-gray-700 dark:bg-gray-700 rounded-lg overflow-hidden"},Dt={class:"flex justify-between font-semibold p-4 bg-gray-100 dark:bg-gray-900 text-sm"},Nt={class:"w-[10%]"},Rt={class:"w-[12%]"},At={class:"w-[28%]"},Ot={class:"w-[20%]"},Ft={class:"w-[15%]"},Ut={class:"w-[15%]"},Et={class:"w-[10%]"},It={class:"w-[12%]"},Bt={class:"w-[28%]"},Ht={class:"w-[20%]"},Wt={class:"w-[15%]"},Pt={class:"w-[15%]"},qt={key:3},Gt={class:"mb-8"},Jt={key:0},Kt={key:1,class:"border-2 border-gray-100 dark:border-gray-600 rounded overflow-hidden p-4"},Qt={class:"space-y-2"},Zt={key:2,class:"border-2 border-gray-100 dark:border-gray-600 rounded overflow-hidden p-8 text-center"},Xt={class:"mt-16"},Yt={class:"text-sm text-gray-500 dark:text-gray-400 mb-4"},es={key:0,class:"my-4 flex gap-2"},ts={class:"border border-gray-200 bg-white dark:border-gray-700 rounded-lg overflow-hidden"},ss={class:"flex justify-between font-semibold p-4 bg-gray-100 dark:bg-gray-900 text-sm"},as={class:"w-[28%] text-center"},os={key:0},ls=["onClick"],ns={class:"w-[10%] text-sm font-medium"},is={class:"w-[12%] text-sm"},rs={class:"w-[28%] text-sm text-center"},ds={class:"w-[20%] text-sm"},cs={class:"w-[15%] flex justify-center space-x-1"},us={class:"relative w-[15%] flex justify-center"},vs={key:1,class:"dark:bg-gray-800"},gs={class:"w-[10%]"},fs={class:"w-[12%]"},_s={class:"w-[28%] flex justify-center"},ms={class:"w-[20%]"},ps={class:"w-[15%] flex justify-center"},ys={class:"w-[15%] flex justify-center"},bs={key:2,class:"text-center py-8 text-gray-500 dark:text-gray-400 dark:bg-gray-800"},hs={key:1,class:"mt-4 flex gap-2"},ws={key:0,class:"flex flex-col items-center justify-center select-none"},xs={class:"mb-8 w-full"},ks={class:"flex flex-col gap-4 mt-4"},Cs=["textContent"],Ts={key:1},Ss={class:"mb-8 w-full"},$s={class:"flex flex-col gap-4 mt-4"},js={key:2,class:"mt-8 w-full"},zs={class:"p-4"},Ls={class:"mt-4"},Ms={class:"w-full text-sm"},Vs={class:"w-full"},Ds={class:"w-full flex justify-between bg-gray-50 dark:bg-gray-800 py-2 px-4"},Ns={class:"w-full flex justify-between py-2 px-4"},Rs={class:"w-full flex justify-between bg-gray-50 dark:bg-gray-800 py-2 px-4"},As={class:"w-full flex justify-between py-2 px-4"},Os={class:"w-full"},Fs={class:"font-bold"},Us={class:"w-full"},Es={class:"w-1/3 font-bold italic"},Is={class:"w-1/3 text-center"},Bs={class:"w-1/3 text-center"},Hs={class:"flex justify-end mt-8 space-x-2"},Ws={class:"flex items-center justify-between"},Ps={key:0,class:"flex flex-col space-y-4"},qs={class:"flex flex-col"},Gs={class:"flex items-center justify-between mb-2"},Js={class:"flex gap-2"},Ks={class:"border border-gray-200 dark:border-gray-800 rounded",style:{height:"500px"}},Qs={class:"p-4 space-y-3"},Zs={key:1,class:"flex flex-col space-y-4"},Xs={class:"flex flex-col"},Ys={class:"flex items-center justify-between mb-2"},ea={class:"flex gap-2"},ta={key:2,class:"text-center py-8 text-gray-500 dark:text-gray-400"},sa=fe({__name:"[id]",setup(ne){mt({title:"Optimization Session - Jesse"});const J=Be(),U=He(),$=T(()=>U.params.id),u=le(),M=T(()=>u.form),l=T(()=>u.results),z=y(!1),g=y(!1),L=y(!1),j=y(!1),E=y(null),p=y(),k=y(""),q=y(!1),I=y(""),N=y(""),B=y(!0),K=_e(),Q=T(()=>K.value==="light"?"vs-light":"vs-dark"),c=T(()=>({automaticLayout:!0,minimap:{enabled:!1},fontSize:14,lineHeight:21,readOnly:!0})),r=y([]);D(()=>u.results.status,n=>{n==="terminated"||n==="stopped"?V.value=!0:V.value=!1});const S=T(()=>U.query.status?U.query.status:null);me(()=>{const n=()=>{var _;(_=u.clearCurrentSession)==null||_.call(u)},e=()=>{document.hidden&&(k.value="",E.value=null)};window.addEventListener("beforeunload",n),document.addEventListener("visibilitychange",e),pe(()=>{var _;if(window.removeEventListener("beforeunload",n),document.removeEventListener("visibilitychange",e),(_=p.value)!=null&&_.$editor)try{p.value.$editor.dispose()}catch(G){console.error("Error disposing editor:",G)}p.value=void 0,k.value="",E.value=null,l.value.infoLogs="",l.value.best_candidates=[],u.clearCurrentSession&&u.clearCurrentSession()}),setTimeout(async()=>{S.value?J.replace(`/optimization/${$.value}`):(u.clearCurrentSession(),await u.loadSession($.value),u.results.status==="terminated"||u.results.status==="stopped"?V.value=!0:V.value=!1),B.value=!1},100)}),We(()=>{var n;return(n=u.clearCurrentSession)==null||n.call(u),k.value="",E.value=null,B.value=!0,!0}),D(Q,n=>{var e,_;(_=(e=p.value)==null?void 0:e.$editor)==null||_.updateOptions({theme:n})}),D(j,async n=>{if(q.value=!0,n&&k.value===""){const e=await u.getSessionStrategyCodes($.value);e&&(k.value=Object.values(e)[0]),await Pe(),setTimeout(()=>{var _;(_=p.value)!=null&&_.$editor&&p.value.$editor.updateOptions({theme:Q.value})},50)}q.value=!1}),D(L,async n=>{if(n){const e=await u.getSessionNotes($.value);e&&(I.value=e.title||"",N.value=e.description||"")}});const C=T(()=>R.remainingTimeText(l.value.progressbar.estimated_remaining_seconds)),Y=T(()=>{const n=l.value.generalInfo.find(e=>e[0]==="Objective Function");return n?n[1]:"sharpe"});function be(){R.copyToClipboard(l.value.infoLogs),O("success","Info logs copied successfully"),g.value=!0,setTimeout(()=>{g.value=!1},3e3)}async function he(){await u.terminate()}const Z=y(!1),w=y({});async function ie(n){(await R.copyToClipboard(n)).success?O("success","DNA copied to clipboard"):O("error","Failed to copy DNA. Please try manually selecting and copying.")}function we(n){w.value=n,Z.value=!0}const V=y(!1);async function xe(){await u.resume()}function re(){u.newSession(),tt("/optimization/")}const ke=n=>{const e=[];return n.forEach(_=>{e.push([{value:_.symbol,style:""},{value:_.timeframe,style:""},{value:_.strategy,style:""}])}),e},Ce=n=>[["Training Start Date",n.training_start_date],["Training Finish Date",n.training_finish_date],["Testing Start Date",n.testing_start_date],["Testing Finish Date",n.testing_finish_date]];async function Te(){try{await navigator.clipboard.writeText(k.value),O("success","Strategy code copied to clipboard")}catch(n){st(n)}}function Se(){var e;const n=(e=M.value.routes[0])==null?void 0:e.strategy;n?te(`/strategies/${n}`):O("error","No strategy selected")}function de(n){const e=r.value.findIndex(_=>_.trial===n.trial);e>-1?r.value.splice(e,1):r.value.push(n)}function ee(){r.value=[]}async function ce(){if(r.value.length===0)return;const e=r.value.map(G=>G.dna).join(`

`);(await R.copyToClipboard(e)).success?(O("success",`DNA from ${r.value.length} candidates copied to clipboard`),ee()):O("error","Failed to copy DNA. Please try manually selecting and copying.")}function te(n){J.push(n)}return(n,e)=>{const _=Fe,G=qe,$e=at,je=lt,o=nt,se=Ke,ze=Tt,v=Je,Le=Ze,Me=vt,ue=Qe,ve=ut,Ve=ot,De=gt,ge=Ge,Ne=ft,Re=St,Ae=Ye,Oe=Xe;return i(),d(F,null,[s(G,{modelValue:l.value.logsModal,"onUpdate:modelValue":e[0]||(e[0]=a=>l.value.logsModal=a),title:"Logs"},{default:b(()=>[s(_,{logs:l.value.infoLogs},null,8,["logs"])]),buttons:b(()=>[t("button",{class:"ml-2 p-2 hover:bg-gray-200 dark:hover:bg-gray-700 rounded-full text-gray-400 hover:text-gray-500 dark:hover:text-gray-300 focus:outline-none",onClick:be},[g.value?(i(),W(f(pt),{key:0,class:"h-6 w-6","aria-hidden":"true"})):h("",!0),!g.value&&l.value.infoLogs.length!=0?(i(),W(f(yt),{key:1,class:"h-6 w-6","aria-hidden":"true"})):h("",!0)])]),_:1},8,["modelValue"]),s(De,null,{left:b(()=>[l.value.alert.message?(i(),d("div",$t,[s($e,{color:"teal",icon:"i-heroicons-check-circle",variant:"soft",title:l.value.alert.message,"close-button":{icon:"i-heroicons-x-mark-20-solid",color:"white",variant:"link"},onClose:e[1]||(e[1]=a=>l.value.alert.message="")},null,8,["title"])])):h("",!0),l.value.exception.error&&l.value.executing?(i(),d("div",jt,[s(je,{modelValue:z.value,"onUpdate:modelValue":e[2]||(e[2]=a=>z.value=a),title:l.value.exception.error,content:l.value.exception.traceback,mode:"optimize"},null,8,["modelValue","title","content"])])):h("",!0),B.value&&!l.value.executing&&!l.value.showResults?(i(),d("div",zt,[t("div",Lt,[t("div",Mt,[s(o,{class:"h-8 w-3/4"}),s(o,{class:"h-8 w-full"}),s(o,{class:"h-8 w-5/6"}),s(o,{class:"h-8 w-full"}),s(o,{class:"h-8 w-4/5"}),s(o,{class:"h-8 w-full"})])]),t("div",Vt,[t("div",Dt,[t("div",Nt,[s(o,{class:"h-4 w-12"})]),t("div",Rt,[s(o,{class:"h-4 w-12"})]),t("div",At,[s(o,{class:"h-4 w-32"})]),t("div",Ot,[s(o,{class:"h-4 w-16"})]),t("div",Ft,[s(o,{class:"h-4 w-16"})]),t("div",Ut,[s(o,{class:"h-4 w-16"})])]),(i(),d(F,null,P(5,a=>t("div",{key:a,class:"flex justify-between border-t border-gray-200 dark:border-gray-700 p-4"},[t("div",Et,[s(o,{class:"h-4 w-8"})]),t("div",It,[s(o,{class:"h-4 w-10"})]),t("div",Bt,[s(o,{class:"h-4 w-24"})]),t("div",Ht,[s(o,{class:"h-4 w-16"})]),t("div",Wt,[s(o,{class:"h-4 w-12"})]),t("div",Pt,[s(o,{class:"h-4 w-8"})])])),64))])])):h("",!0),(l.value.executing||l.value.showResults)&&!l.value.exception.error?(i(),d("div",qt,[t("div",Gt,[s(se,{title:"Objective Progress",class:"mb-4"}),l.value.objective_curve&&l.value.objective_curve.length?(i(),d("div",Jt,[s(ze,{data:l.value.objective_curve},null,8,["data"])])):l.value.executing&&!V.value?(i(),d("div",Kt,[t("div",Qt,[s(o,{class:"h-8 w-3/4"}),s(o,{class:"h-8 w-full"}),s(o,{class:"h-8 w-5/6"}),s(o,{class:"h-8 w-full"}),s(o,{class:"h-8 w-4/5"}),s(o,{class:"h-8 w-full"}),s(o,{class:"h-8 w-3/4"}),s(o,{class:"h-8 w-full"}),s(o,{class:"h-8 w-5/6"}),s(o,{class:"h-8 w-full"})])])):(i(),d("div",Zt,e[21]||(e[21]=[t("div",{class:"text-gray-400 dark:text-gray-500"},[t("svg",{class:"mx-auto h-12 w-12 mb-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})]),t("p",{class:"text-sm"},"No optimization progress data available")],-1)])))]),t("div",Xt,[s(se,{title:"Best Trials",class:"my-4"}),t("p",Yt," Showing "+m(l.value.best_candidates.length)+" trials sorted by fitness score ",1),r.value.length>0?(i(),d("div",es,[s(v,{variant:"soft",color:"primary",size:"sm",icon:"i-heroicons-clipboard-document-list",onClick:ce},{default:b(()=>[A(" Copy Selected DNA ("+m(r.value.length)+") ",1)]),_:1}),s(v,{variant:"soft",color:"gray",size:"sm",icon:"i-heroicons-x-mark",onClick:ee},{default:b(()=>e[22]||(e[22]=[A(" Clear Selection ")])),_:1})])):h("",!0),t("div",ts,[t("div",ss,[e[23]||(e[23]=t("div",{class:"w-[10%]"},"Rank",-1)),e[24]||(e[24]=t("div",{class:"w-[12%]"},"Trial",-1)),t("div",as,"Training/Testing "+m(Y.value),1),e[25]||(e[25]=t("div",{class:"w-[20%]"},"Fitness",-1)),e[26]||(e[26]=t("div",{class:"w-[15%] text-center"},"Actions",-1)),e[27]||(e[27]=t("div",{class:"w-[15%] text-center"},"Select",-1))]),l.value.best_candidates.length?(i(),d("div",os,[(i(!0),d(F,null,P(l.value.best_candidates,(a,H)=>(i(),d("div",{key:H,class:X(["flex items-center justify-between border-t border-gray-200 dark:border-gray-700 p-4 dark:bg-gray-700 cursor-pointer",{"bg-gray-50 dark:bg-gray-800":H%2===0}]),onClick:oe(ae=>de(a),["stop"])},[t("div",ns,m(a.rank),1),t("div",is,m(a.trial),1),t("div",rs,m(a.objective_metric),1),t("div",ds,m(a.fitness),1),t("div",cs,[s(v,{variant:"ghost",color:"gray",icon:"i-heroicons-clipboard-document-list",onClick:oe(ae=>ie(a.dna),["stop"])},null,8,["onClick"]),s(v,{variant:"ghost",icon:"i-heroicons-information-circle",onClick:oe(ae=>we(a),["stop"])},null,8,["onClick"])]),t("div",us,[e[28]||(e[28]=t("div",{class:"inset-0 absolute z-10"},null,-1)),s(Le,{"model-value":r.value.includes(a),"onUpdate:modelValue":ae=>de(a)},null,8,["model-value","onUpdate:modelValue"])])],10,ls))),128))])):l.value.executing&&!V.value?(i(),d("div",vs,[(i(),d(F,null,P(5,a=>t("div",{key:a,class:"flex justify-between border-t border-gray-200 dark:border-gray-700 p-4"},[t("div",gs,[s(o,{class:"h-4 w-8"})]),t("div",fs,[s(o,{class:"h-4 w-10"})]),t("div",_s,[s(o,{class:"h-4 w-24"})]),t("div",ms,[s(o,{class:"h-4 w-16"})]),t("div",ps,[s(o,{class:"h-4 w-12"})]),t("div",ys,[s(o,{class:"h-4 w-8"})])])),64))])):(i(),d("div",bs,e[29]||(e[29]=[t("svg",{class:"mx-auto h-10 w-10 mb-3 text-gray-300 dark:text-gray-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})],-1),t("p",{class:"text-sm"},"No candidates were found in this session",-1)])))]),r.value.length>0?(i(),d("div",hs,[s(v,{variant:"soft",color:"primary",size:"sm",icon:"i-heroicons-clipboard-document-list",onClick:ce},{default:b(()=>[A(" Copy Selected DNA ("+m(r.value.length)+") ",1)]),_:1}),s(v,{variant:"soft",color:"gray",size:"sm",icon:"i-heroicons-x-mark",onClick:ee},{default:b(()=>e[30]||(e[30]=[A(" Clear Selection ")])),_:1})])):h("",!0)])])):h("",!0)]),right:b(()=>[l.value.executing&&!l.value.showResults?(i(),d("div",ws,[t("div",xs,[l.value.exception.error?(i(),W(v,{key:0,class:"w-full flex justify-center mt-4",icon:"i-heroicons-arrow-path",size:"xl",variant:"solid",label:"Rerun",trailing:!1,onClick:e[3]||(e[3]=a=>f(le)().rerun())})):h("",!0),l.value.exception.error?(i(),W(v,{key:1,class:"w-full flex justify-center mt-4",icon:"i-heroicons-arrow-uturn-left",size:"xl",variant:"solid",color:"green",label:"New Session",trailing:!1,onClick:e[4]||(e[4]=a=>re())})):l.value.showResults?h("",!0):(i(),W(v,{key:2,color:"gray",ui:{color:{gray:{solid:"text-rose-500 dark:text-rose-400"}}},class:"w-full flex justify-center mt-4",icon:"i-heroicons-pause",size:"xl",variant:"solid",label:"Terminate",trailing:!1,onClick:e[5]||(e[5]=a=>he())})),t("div",ks,[s(v,{class:"w-full flex justify-center",color:"gray",size:"xl",variant:"solid",label:"Logs",icon:"i-heroicons-document-text",trailing:!1,onClick:e[6]||(e[6]=a=>l.value.logsModal=!0)}),s(v,{class:"w-full flex justify-center",color:"gray",size:"xl",variant:"solid",label:"History",icon:"i-heroicons-clock",trailing:!1,onClick:e[7]||(e[7]=a=>te("/optimization/history"))})])]),t("div",null,[s(Me,{progress:l.value.progressbar.current},null,8,["progress"])]),!l.value.exception.error&&!l.value.best_candidates.length?(i(),d("h3",{key:0,class:"mt-8 animate-pulse",textContent:m(C.value)},null,8,Cs)):h("",!0)])):h("",!0),l.value.showResults?(i(),d("div",Ts,[t("div",Ss,[V.value?(i(),W(v,{key:0,class:"w-full flex justify-center",icon:"i-heroicons-play",size:"xl",variant:"solid",color:"primary",label:"Resume",trailing:!1,onClick:e[8]||(e[8]=a=>xe())})):h("",!0),s(v,{class:X(["w-full flex justify-center",{"mt-4":V.value}]),icon:"i-heroicons-arrow-uturn-left",size:"xl",variant:"solid",color:"green",label:"New Session",trailing:!1,onClick:e[9]||(e[9]=a=>re())},null,8,["class"]),t("div",$s,[s(v,{class:"w-full flex justify-center",color:"gray",size:"xl",variant:"solid",label:"Logs",icon:"i-heroicons-document-text",trailing:!1,onClick:e[10]||(e[10]=a=>l.value.logsModal=!0)}),s(v,{class:"w-full flex justify-center",color:"gray",size:"xl",variant:"solid",label:"History",icon:"i-heroicons-clock",trailing:!1,onClick:e[11]||(e[11]=a=>te("/optimization/history"))}),s(v,{class:"w-full flex justify-center",color:"gray",size:"xl",variant:"solid",label:"Title & Notes",icon:"i-heroicons-pencil-square",trailing:!1,onClick:e[12]||(e[12]=a=>L.value=!0)}),s(v,{class:"w-full flex justify-center",color:"gray",size:"xl",variant:"solid",label:"View Strategy",icon:"i-heroicons-code-bracket",trailing:!1,onClick:e[13]||(e[13]=a=>j.value=!0)})])])])):h("",!0),(l.value.executing||l.value.showResults)&&l.value.generalInfo.length?(i(),d("div",js,[s(se,{title:"Info",class:"mb-4"}),s(ue,{data:l.value.generalInfo},null,8,["data"]),s(ve,{class:"mt-8 mb-4",size:"lg",label:"Duration"}),s(ue,{data:Ce(M.value)},null,8,["data"]),s(ve,{class:"mt-8 mb-4",size:"lg",label:"Routes"}),s(Ve,{data:ke(M.value.routes),"header-items":["Symbol","Timeframe","Strategy"],header:""},null,8,["data"])])):h("",!0)]),_:1}),s(ge,{modelValue:Z.value,"onUpdate:modelValue":e[16]||(e[16]=a=>Z.value=a)},{default:b(()=>[t("div",zs,[t("div",Ls,[t("div",Ms,[e[37]||(e[37]=t("h2",{class:"text-lg mb-2 font-bold italic dark:text-white text-center"}," Candidate Info ",-1)),t("div",Vs,[t("div",Ds,[e[31]||(e[31]=t("div",{class:"font-bold"},"Rank",-1)),t("div",null,m(w.value.rank),1)]),t("div",Ns,[e[32]||(e[32]=t("div",{class:"font-bold"},"Trial",-1)),t("div",null,m(w.value.trial),1)]),t("div",Rs,[e[33]||(e[33]=t("div",{class:"font-bold"},"Fitness",-1)),t("div",null,m(w.value.fitness),1)]),t("div",As,[e[35]||(e[35]=t("div",{class:"font-bold"},"DNA",-1)),s(v,{size:"xs",color:"primary",onClick:e[14]||(e[14]=a=>ie(w.value.dna))},{default:b(()=>e[34]||(e[34]=[A(" Copy DNA ")])),_:1})])]),e[38]||(e[38]=t("h2",{class:"text-lg font-bold italic dark:text-white mt-6 mb-2 text-center"}," Parameters ",-1)),t("div",Os,[(i(!0),d(F,null,P(Object.keys(w.value.params),(a,H)=>(i(),d("div",{key:a,class:X([{"bg-gray-50 dark:bg-gray-800":H%2===0},"w-full flex justify-between py-2 px-4"])},[t("div",Fs,m(a),1),t("div",null,m(typeof w.value.params[a]=="number"?f(x).round(w.value.params[a],6):w.value.params[a]),1)],2))),128))]),e[39]||(e[39]=t("h2",{class:"text-lg font-bold italic dark:text-white mt-6 mb-2 text-center"}," Metrics Comparison ",-1)),t("div",Us,[e[36]||(e[36]=t("div",{class:"flex justify-between py-2 px-4 bg-gray-100 dark:bg-gray-800 font-bold text-sm"},[t("div",{class:"w-1/3 font-bold"},"Metric"),t("div",{class:"w-1/3 text-center font-bold"},"Training"),t("div",{class:"w-1/3 text-center font-bold"},"Testing")],-1)),(i(!0),d(F,null,P([{key:"total",label:"Total Closed Trades"},{key:"net_profit",label:"Total Net Profit",format:a=>`${f(x).round(a.net_profit,2)} (${f(x).round(a.net_profit_percentage,2)}%)`},{key:"starting_balance",label:"Starting => Finishing Balance",format:a=>`${f(x).round(a.starting_balance,2)} => ${f(x).round(a.finishing_balance,2)}`},{key:"total_open_trades",label:"Open Trades"},{key:"fee",label:"Total Paid Fees",round:2},{key:"max_drawdown",label:"Max Drawdown",round:2},{key:"annual_return",label:"Annual Return",format:a=>`${f(x).round(a.annual_return,2)}%`},{key:"expectancy",label:"Expectancy",format:a=>`${f(x).round(a.expectancy,2)} (${f(x).round(a.expectancy_percentage,2)}%)`},{key:"average_win",label:"Avg Win | Avg Loss",format:a=>`${f(x).round(a.average_win,2)} | ${f(x).round(a.average_loss,2)}`},{key:"ratio_avg_win_loss",label:"Ratio Avg Win / Avg Loss",round:2},{key:"win_rate",label:"Win-rate",format:a=>`${f(x).round(a.win_rate*100,2)}%`},{key:"longs_percentage",label:"Longs | Shorts",format:a=>`${f(x).round(a.longs_percentage,2)}% | ${f(x).round(a.shorts_percentage,2)}%`},{key:"average_holding_period",label:"Avg Holding Time",format:a=>f(R).secondsToHumanReadable(a.average_holding_period)},{key:"average_winning_holding_period",label:"Winning Trades Avg Holding Time",format:a=>f(R).secondsToHumanReadable(a.average_winning_holding_period)},{key:"average_losing_holding_period",label:"Losing Trades Avg Holding Time",format:a=>f(R).secondsToHumanReadable(a.average_losing_holding_period)},{key:"sharpe_ratio",label:"Sharpe Ratio",round:2},{key:"calmar_ratio",label:"Calmar Ratio",round:2},{key:"sortino_ratio",label:"Sortino Ratio",round:2},{key:"omega_ratio",label:"Omega Ratio",round:2},{key:"winning_streak",label:"Winning Streak"},{key:"losing_streak",label:"Losing Streak"},{key:"largest_winning_trade",label:"Largest Winning Trade",round:2},{key:"largest_losing_trade",label:"Largest Losing Trade",round:2},{key:"total_winning_trades",label:"Total Winning Trades"},{key:"total_losing_trades",label:"Total Losing Trades"}],(a,H)=>(i(),d("div",{key:a.key,class:X([{"bg-gray-50 dark:bg-gray-800":H%2===0},"w-full flex justify-between py-2 px-4"])},[t("div",Es,m(a.label),1),t("div",Is,m(a.format?a.format(w.value.training_metrics):a.round?f(x).round(w.value.training_metrics[a.key],a.round):w.value.training_metrics[a.key]),1),t("div",Bs,m(a.format?a.format(w.value.testing_metrics):a.round?f(x).round(w.value.testing_metrics[a.key],a.round):w.value.testing_metrics[a.key]),1)],2))),128))])])]),t("div",Hs,[s(v,{color:"gray",block:"",onClick:e[15]||(e[15]=a=>Z.value=!1)},{default:b(()=>e[40]||(e[40]=[A(" Close ")])),_:1})])])]),_:1},8,["modelValue"]),s(Ne,{modelValue:L.value,"onUpdate:modelValue":e[17]||(e[17]=a=>L.value=a),"session-id":$.value,"initial-title":I.value,"initial-description":N.value},null,8,["modelValue","session-id","initial-title","initial-description"]),s(ge,{modelValue:j.value,"onUpdate:modelValue":e[20]||(e[20]=a=>j.value=a),ui:{width:"sm:max-w-5xl"}},{default:b(()=>[s(Oe,null,{header:b(()=>[t("div",Ws,[e[41]||(e[41]=t("h3",{class:"text-lg font-semibold"},"Strategy Code Snapshot",-1)),s(v,{color:"gray",variant:"ghost",icon:"i-heroicons-x-mark",size:"sm",onClick:e[18]||(e[18]=a=>j.value=!1)})])]),default:b(()=>[q.value?(i(),d("div",Ps,[t("div",qs,[t("div",Gs,[s(o,{class:"h-4 w-20"}),t("div",Js,[s(o,{class:"h-8 w-16"}),s(o,{class:"h-8 w-32"})])]),t("div",Ks,[t("div",Qs,[s(o,{class:"h-4 w-full"}),s(o,{class:"h-4 w-5/6"}),s(o,{class:"h-4 w-4/5"}),s(o,{class:"h-4 w-full"}),s(o,{class:"h-4 w-3/4"}),s(o,{class:"h-4 w-full"}),s(o,{class:"h-4 w-2/3"}),s(o,{class:"h-4 w-5/6"}),s(o,{class:"h-4 w-full"}),s(o,{class:"h-4 w-4/5"}),s(o,{class:"h-4 w-1/2"}),s(o,{class:"h-4 w-3/4"}),s(o,{class:"h-4 w-full"}),s(o,{class:"h-4 w-5/6"}),s(o,{class:"h-4 w-2/3"})])])])])):k.value&&k.value.length>0?(i(),d("div",Zs,[t("div",Xs,[t("div",Ys,[e[42]||(e[42]=t("label",{class:"block text-sm font-medium"},null,-1)),t("div",ea,[s(v,{icon:"i-heroicons-clipboard-document",label:"Copy",variant:"soft",color:"gray",size:"sm",onClick:Te}),s(v,{icon:"i-heroicons-pencil-square",label:"Go to Strategy Editor",variant:"soft",color:"primary",size:"sm",onClick:Se})])]),s(Ae,null,{default:b(()=>[s(Re,{ref_key:"codeEditorRef",ref:p,modelValue:k.value,"onUpdate:modelValue":e[19]||(e[19]=a=>k.value=a),lang:"python",options:c.value,class:"border border-gray-200 dark:border-gray-800 rounded",style:{height:"500px"}},{default:b(()=>e[43]||(e[43]=[A(" Loading editor... ")])),_:1},8,["modelValue","options"])]),_:1})])])):(i(),d("div",ta," No strategy code snapshot available for this session. "))]),_:1})]),_:1},8,["modelValue"])],64)}}}),pa=ye(sa,[["__scopeId","data-v-bb2916b9"]]);export{pa as default};
