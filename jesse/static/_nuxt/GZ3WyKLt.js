import{_ as Y}from"./D9Ckaykk.js";import{d as ee,A as te,r as h,c as u,w as M,B as se,C as g,i,j as n,x as a,E,f as S,G as x,F as oe,O as ne,D as O,t as re,aa as ae,g as f,q as B,ac as le,H as ie,s as R}from"./CCP630y_.js";import{_ as de}from"./DB-7Vy6V.js";import{_ as ce}from"./Ba-VmK1O.js";import{u as ue}from"./Dmfbhh7F.js";import{u as ge}from"./ByTHOC9c.js";import"./DIRnqvt5.js";import"./9VOnL4Iz.js";import"./vlmPAk7D.js";import"./DDQFqpHC.js";import"./DnshXE1x.js";const fe={class:"bg-gray-50 dark:bg-transparent min-h-screen pb-12"},ye={class:"container mx-auto px-4 pt-16 pb-6 max-w-7xl"},me={class:"mb-6"},pe={class:"flex flex-col md:flex-row md:items-center justify-between gap-4 mb-6"},xe={class:"flex gap-3 flex-wrap"},be={class:"grid grid-cols-2 lg:grid-cols-4 gap-4 mb-8"},he={class:"bg-white dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl p-5 flex flex-col justify-between shadow-sm"},ve={class:"flex items-center justify-between mb-3"},_e={class:"text-3xl font-bold text-gray-900 dark:text-gray-100 leading-none"},we={class:"bg-white dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl p-5 flex flex-col justify-between shadow-sm"},ke={class:"flex items-center justify-between mb-3"},Se={class:"text-3xl font-bold text-gray-900 dark:text-gray-100 leading-none"},Ce={class:"bg-white dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl p-5 flex flex-col justify-between shadow-sm"},Ae={class:"flex items-center justify-between mb-3"},Fe={class:"text-3xl font-bold text-gray-900 dark:text-gray-100 leading-none"},Te={class:"bg-white dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl p-5 flex flex-col justify-between shadow-sm"},je={class:"flex items-center justify-between mb-3"},qe={class:"text-3xl font-bold text-gray-900 dark:text-gray-100 leading-none"},Ne={key:0,class:"mb-8"},Ee={class:"bg-white dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-xl p-6 shadow-sm"},Be={class:"flex flex-col sm:flex-row sm:items-center justify-between gap-4 mb-6"},Ie={key:0,class:"flex items-center gap-2"},Ve={class:"flex gap-2"},$e=["onClick"],De={key:0},Le={key:0,class:"mt-4 text-sm text-gray-500 dark:text-gray-400 italic"},Me={key:1,class:"text-center py-12 text-gray-500 dark:text-gray-400 text-sm"},Oe={key:1},Re={key:2,class:"text-center py-20 bg-white dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-lg shadow-sm"},et=ee({__name:"overview",setup(Ue){ue({title:"Overview - Jesse"});const d=te(),v=h(!1),_=h(!1),C=h(!1),A=h(!1),w=h("USD"),b=h(new Set),m=u(()=>Object.values(d.tabs)),I=u(()=>m.value.length),p=u(()=>m.value.filter(e=>e.results.phase==="running"));u(()=>m.value.filter(e=>e.results.phase==="starting"));const U=u(()=>m.value.filter(e=>e.results.phase==="editing")),z=u(()=>m.value.filter(e=>["ended","error","stopping"].includes(e.results.phase))),F=u(()=>m.value.filter(e=>["running","starting"].includes(e.results.phase))),T=u(()=>m.value.filter(e=>["editing","ended"].includes(e.results.phase))),V=["#818CF8","#34D399","#FBBF24","#F87171","#A78BFA","#60A5FA","#FB923C","#2DD4BF","#FB7185","#C084FC","#4ADE80","#FACC15"];function P(e,t){let s=0;for(let l=0;l<e.length;l++)s=(s<<5)-s+e.charCodeAt(l),s=s&s;return Math.abs(s)%t}function G(e){return V[P(e,V.length)]}function j(e){var l,o,r;const t=(r=(o=(l=e.results.charts)==null?void 0:l.equity_curve)==null?void 0:o[0])==null?void 0:r.name;if(!t)return null;const s=t.match(/\(([A-Z]+)\)/);return s?s[1]:null}function H(e){var l,o,r;if((l=e.results.generalInfo)!=null&&l.title)return e.results.generalInfo.title;const t=e.form.exchange||((o=e.results.generalInfo)==null?void 0:o.exchange)||"",s=(r=e.form.routes)==null?void 0:r[0];return s?`${t} ${s.symbol} ${s.timeframe}`:e.id.substring(0,8)}const q=u(()=>{const e=new Set;for(const t of p.value){const s=j(t);s&&e.add(s)}return Array.from(e).sort()}),N=u(()=>{var s,l,o;const e=p.value.filter(r=>j(r)===w.value).sort((r,y)=>r.id.localeCompare(y.id)),t=[];for(const r of e){const y=(l=(s=r.results.charts)==null?void 0:s.equity_curve)==null?void 0:l[0];if(!((o=y==null?void 0:y.data)!=null&&o.length))continue;const k=G(r.id),c=y.data.map(L=>({...L,color:k}));t.push({name:H(r),color:k,data:c})}return t});M(q,e=>{if(e.length>0&&!e.includes(w.value)){const t=new Map;for(const o of p.value){const r=j(o);r&&t.set(r,(t.get(r)||0)+1)}let s=e[0],l=0;for(const[o,r]of t)r>l&&(l=r,s=o);w.value=s}},{immediate:!0}),M(()=>p.value.map(e=>e.id).sort().join(","),async(e,t)=>{if(e===t)return;const s=new Set(p.value.map(o=>o.id)),l=Array.from(s).filter(o=>!b.value.has(o));for(const o of l){b.value.add(o);try{await d.fetchEquityCurve(o,"auto")}catch(r){console.error(`Failed to fetch equity curve for session ${o}:`,r)}}for(const o of b.value)s.has(o)||b.value.delete(o)}),se(async()=>{for(const e of p.value)if(!b.value.has(e.id)){b.value.add(e.id);try{await d.fetchEquityCurve(e.id,"auto")}catch(t){console.error(`Failed to fetch equity curve for session ${e.id}:`,t)}}});function J(){if(T.value.length===0){R("info","No sessions to start");return}v.value=!0}function K(){if(F.value.length===0){R("info","No running sessions to stop");return}_.value=!0}async function Z(){v.value=!1,C.value=!0;try{await d.startAll()}finally{C.value=!1}}async function Q(){_.value=!1,A.value=!0;try{await d.stopAll()}finally{A.value=!1}}async function W(e){await d.rerunAndStart(e,{navigate:!1})}function $(e){d.openStopConfirmModal(e)}function D(e){d.closeTab(e)}function X(){d.addTab()}return ge({ArrowLeft:()=>d.goToPrevTab(null),ArrowRight:()=>d.goToNextTab(null)}),(e,t)=>{const s=Y,l=re,o=le,r=de,y=ce,k=ae;return f(),g("div",fe,[i(s,{"current-tab":null,tabs:a(d).tabs,onClose:D,onCancel:$},null,8,["tabs"]),n("div",ye,[n("div",me,[n("div",pe,[t[2]||(t[2]=n("h1",{class:"text-2xl font-bold text-gray-900 dark:text-gray-100"}," Overview ",-1)),n("div",xe,[i(l,{disabled:a(T).length===0||a(C),loading:a(C),icon:"i-heroicons-play",onClick:J},{default:S(()=>[B(" Start All ("+x(a(T).length)+") ",1)]),_:1},8,["disabled","loading"]),i(l,{disabled:a(F).length===0||a(A),loading:a(A),color:"rose",icon:"i-heroicons-stop",onClick:K},{default:S(()=>[B(" Stop All Running ("+x(a(F).length)+") ",1)]),_:1},8,["disabled","loading"])])]),n("div",be,[n("div",he,[n("div",ve,[t[3]||(t[3]=n("span",{class:"text-xs text-gray-500 dark:text-gray-400 uppercase font-bold tracking-wider"},"Total Sessions",-1)),i(o,{name:"i-heroicons-squares-2x2",class:"w-5 h-5 text-gray-400"})]),n("div",_e,x(a(I)),1)]),n("div",we,[n("div",ke,[t[4]||(t[4]=n("span",{class:"text-xs text-gray-500 dark:text-gray-400 uppercase font-bold tracking-wider"},"Running",-1)),i(o,{name:"i-heroicons-play-circle",class:"w-6 h-6 text-gray-400"})]),n("div",Se,x(a(p).length),1)]),n("div",Ce,[n("div",Ae,[t[5]||(t[5]=n("span",{class:"text-xs text-gray-500 dark:text-gray-400 uppercase font-bold tracking-wider"},"Drafts",-1)),i(o,{name:"i-heroicons-pencil-square",class:"w-5 h-5 text-gray-400"})]),n("div",Fe,x(a(U).length),1)]),n("div",Te,[n("div",je,[t[6]||(t[6]=n("span",{class:"text-xs text-gray-500 dark:text-gray-400 uppercase font-bold tracking-wider"},"Ended/Error",-1)),i(o,{name:"i-heroicons-stop-circle",class:"w-6 h-6 text-gray-400"})]),n("div",qe,x(a(z).length),1)])])]),a(p).length>0?(f(),g("div",Ne,[n("div",Ee,[n("div",Be,[t[8]||(t[8]=n("h2",{class:"text-lg font-bold text-gray-900 dark:text-gray-100"}," Equity Comparison ",-1)),a(q).length>1?(f(),g("div",Ie,[t[7]||(t[7]=n("span",{class:"text-sm text-gray-500 dark:text-gray-400"},"Currency:",-1)),n("div",Ve,[(f(!0),g(oe,null,ne(a(q),c=>(f(),g("button",{key:c,class:ie(["px-3 py-1.5 text-xs font-semibold rounded-lg transition-colors duration-200",[a(w)===c?"bg-primary-500 text-white":"bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600"]]),onClick:L=>w.value=c},x(c),11,$e))),128))])])):E("",!0)]),a(N).length>0?(f(),g("div",De,[i(r,{data:a(N)},null,8,["data"]),a(N).length===1?(f(),g("div",Le," This chart is designed to compare multiple sessions simultaneously. For a detailed view of this single session, visit its individual tab instead. ")):E("",!0)])):(f(),g("div",Me," No equity data yet. Charts will appear shortly after sessions start collecting balance snapshots. "))])])):E("",!0),a(I)>0?(f(),g("div",Oe,[i(y,{sessions:a(m),onStart:W,onStop:$,onClose:D},null,8,["sessions"])])):(f(),g("div",Re,[t[10]||(t[10]=n("div",{class:"text-gray-500 dark:text-gray-400 text-lg mb-6"}," No live sessions found ",-1)),i(l,{size:"lg",variant:"solid",icon:"i-heroicons-plus",onClick:X},{default:S(()=>t[9]||(t[9]=[B(" Create New Session ")])),_:1})]))]),i(k,{modelValue:a(v),"onUpdate:modelValue":t[0]||(t[0]=c=>O(v)?v.value=c:null),title:"Start All Sessions",description:"Are you sure you want to start all eligible sessions? This includes both drafts and ended sessions that don't have errors.",type:"info"},{default:S(()=>[i(l,{variant:"solid",color:"green",block:"",class:"sm:w-auto",label:"Start All",onClick:Z})]),_:1},8,["modelValue"]),i(k,{modelValue:a(_),"onUpdate:modelValue":t[1]||(t[1]=c=>O(_)?_.value=c:null),title:"Stop All Running Sessions",description:"Are you sure you want to terminate all running sessions? This will stop all active trading.",type:"info"},{default:S(()=>[i(l,{variant:"solid",color:"red",block:"",class:"sm:w-auto",label:"Stop All",onClick:Q})]),_:1},8,["modelValue"])])}}});export{et as default};
