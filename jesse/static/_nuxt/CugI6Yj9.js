import{_ as D}from"./DgT6eUf2.js";import{z as u,j as t,g as d,d as O,m as N,u as I,r as $,G as V,W as s,L as j,Z as w,i as l,I as S,J as B,be as U,b as G,c as A,bf as p,w as R,f as _,t as L,a1 as E,e as T}from"./BZBcjETW.js";import{u as W}from"./D-92rLZE.js";import{r as F}from"./CA3QkJiz.js";function q(k,r){return d(),u("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"})])}const Z={class:"relative"},H=["onClick"],K={class:"w-full text-sm text-left"},P={key:0},Q=O({__name:"MultipleSelect",props:N({options:{type:Array,required:!0},animate:{type:Boolean,default:!1}},{modelValue:{type:Array,default:[]},modelModifiers:{}}),emits:["update:modelValue"],setup(k){const r=I(k,"modelValue"),z=k,n=$(!1);function C(m){return r.value.some(c=>c.key===m.key)}function f(m){const c=r.value.findIndex(g=>g.key===m.key);c===-1?r.value.push(m):r.value.splice(c,1)}return(m,c)=>(d(),u("div",Z,[s(n)?(d(),u("div",{key:0,class:"fixed inset-0 w-screen z-10",onClick:c[0]||(c[0]=g=>n.value=!s(n))})):V("",!0),t("button",{class:w(["relative min-w-40 xl:min-w-52 w-full bg-white dark:bg-gray-800 flex justify-between items-center px-2 py-0.5 rounded-md border-[2px] border-gray-300 dark:border-gray-900",s(n)?"z-20":""]),onClick:c[1]||(c[1]=g=>n.value=!s(n))},[t("div",null,j(r.value.length)+" selected ",1),t("div",{class:w(["transition-all duration-200",s(n)?"-rotate-180":"rotate-0"])},[l(s(q),{class:"h-3 w-3 text-gray-400 dark:text-gray-600"})],2)],2),t("div",{class:w(["absolute w-full max-h-60 overflow-y-scroll top-9 bg-white dark:bg-gray-800 right-0 rounded-md border-[2px] border-gray-300 dark:border-gray-900 z-20 p-0.5",k.animate?s(n)?"transition-all h-60 opacity-100":"transition-all h-0 opacity-0 pointer-events-none":s(n)?"h-60":"h-0 opacity-0"])},[(d(!0),u(S,null,B(z.options,g=>(d(),u("button",{key:g.key,class:"w-full flex justify-between items-center hover:bg-gray-100 hover:dark:bg-gray-800 p-1 rounded-md",onClick:M=>f(g)},[t("div",K,j(g.label),1),C(g)?(d(),u("div",P,[l(s(U),{class:"h-4 w-4 text-gray-600 dark:text-gray-400"})])):V("",!0)],8,H))),128))],2)]))}}),X={class:"relative"},Y=["onClick"],ee={class:"w-full text-sm text-left"},te={key:0},re=O({__name:"SingleSelect",props:N({options:{type:Array,required:!0},animate:{type:Boolean,default:!1}},{modelValue:{type:Object,default:{}},modelModifiers:{}}),emits:["update:modelValue"],setup(k){const r=I(k,"modelValue"),z=k,n=$(!1);function C(f){r.value=f}return(f,m)=>(d(),u("div",X,[s(n)?(d(),u("div",{key:0,class:"fixed inset-0 w-screen z-10",onClick:m[0]||(m[0]=c=>n.value=!s(n))})):V("",!0),t("button",{class:w(["relative min-w-40 xl:min-w-52 w-full bg-white dark:bg-gray-800 flex justify-between items-center px-2 py-0.5 rounded-md border-[2px] border-gray-300 dark:border-gray-900",s(n)?"z-20":""]),onClick:m[1]||(m[1]=c=>n.value=!s(n))},[t("div",null,j(r.value.label),1),t("div",{class:w(["transition-all duration-200",s(n)?"-rotate-180":"rotate-0"])},[l(s(q),{class:"h-3 w-3 text-gray-400 dark:text-gray-600"})],2)],2),t("div",{class:w(["absolute w-full max-h-60 overflow-y-scroll top-9 bg-white dark:bg-gray-800 right-0 rounded-md border-[2px] border-gray-300 dark:border-gray-900 z-20 p-0.5",k.animate?s(n)?"transition-all h-60 opacity-100":"transition-all h-0 opacity-0 pointer-events-none":s(n)?"h-60":"h-0 opacity-0"])},[(d(!0),u(S,null,B(z.options,c=>(d(),u("button",{key:c.key,class:"w-full flex justify-between items-center hover:bg-gray-100 hover:dark:bg-gray-800 p-1 rounded-md",onClick:g=>C(c)},[t("div",ee,j(c.label),1),c.key==r.value.key?(d(),u("div",te,[l(s(U),{class:"h-4 w-4 text-gray-600 dark:text-gray-400"})])):V("",!0)],8,Y))),128))],2)]))}}),se={class:"w-full"},oe={class:"mt-4 md:mt-8 p-3 md:p-4"},ae={class:"space-y-4 lg:space-y-0 lg:flex justify-center items-center mb-4"},ne={class:"space-y-4 md:space-y-0 md:flex justify-center items-center lg:mb-0"},le={class:"flex items-center"},ie={class:"flex items-center md:ml-4"},de={class:"lg:ml-4"},ce={class:"flex flex-wrap gap-2 items-center"},ue={class:"overflow-x-auto -mx-3 md:mx-0"},me={class:"flex min-w-max"},pe={class:"flex flex-col border-r-2 dark:border-gray-900 font-bold flex-shrink-0"},fe={class:"text-center"},ge={class:"flex overflow-x-auto"},ye={class:"px-2 md:px-4 flex items-center justify-center border-b border-t-2 dark:border-gray-900 h-16 md:h-20 bg-white dark:bg-backdrop-dark gap-1"},be={class:"text-xs md:text-sm text-gray-700 dark:text-gray-300 truncate"},_e=O({__name:"benchmark",setup(k){W({title:"Benchmark"});const r=G(),z=A(()=>r.tabs),n=$(r.benchmarkColumns),C=$(r.benchmarkSorts);r.benchmarkFilters.length===0&&r.setBenchmarkFilters(n.value);const f=$(JSON.parse(JSON.stringify(r.benchmarkFilters)));Object.keys(r.benchmarkSelectedSort).length==0&&r.setBenchmarkSort(C.value[0]);const m=$(r.benchmarkSelectedSort),c=A(()=>{var y,h,v;const x=r.tabs,o=[];for(const b in x){const i=x[b],e={id:i.id,strategy:((y=i.form.routes[0])==null?void 0:y.strategy)??"",start_date:i.form.start_date,finish_date:i.form.finish_date,fast_mode:i.form.fast_mode,exchange:i.form.exchange,symbol:((h=i.form.routes[0])==null?void 0:h.symbol)??"",timeframe:((v=i.form.routes[0])==null?void 0:v.timeframe)??""},a=i.results.metrics;Object.keys(a).length>0&&(e.total_closed_trades=a.total,e.net_profit=p.round(a.net_profit,1),e.net_profit_percentage=`${p.round(a.net_profit_percentage,1)} %`,e.total_paid_fees=p.round(a.fee,1),e.max_drawdown=`${p.round(a.max_drawdown,1)} %`,e.annual_return=`${p.round(a.annual_return,1)} %`,e.expectancy=`${p.round(a.expectancy_percentage,1)} %`,e.ratio_avg_win_loss=p.round(a.ratio_avg_win_loss,1),e.win_rate=`${p.round(a.win_rate*100,1)} %`,e.longs_percentage=`${p.round(a.longs_percentage,1)} %`,e.shorts_percentage=`${p.round(a.shorts_percentage,1)} %`,e.average_holding_hours=p.round(a.average_holding_period/3600,1),e.sharpe_ratio=p.round(a.sharpe_ratio,1),e.sortino_ratio=p.round(a.sortino_ratio,1),e.calmar_ratio=p.round(a.calmar_ratio,1),e.omega_ratio=p.round(a.omega_ratio,1)),i.results.executing&&!i.results.exception.error?(e.progress=`${i.results.progressbar.current}%`,e.status="running"):i.results.exception.error&&i.results.executing?(e.progress="❌",e.status="error"):Object.keys(a).length===0?e.status="":(e.progress="✅",e.status="finished"),o.push(e)}return o}),g=A(()=>m.value.key==="none"?c.value:[...c.value].sort((x,o)=>{const y=m.value.key,h=parseFloat(x[y])||null,v=parseFloat(o[y])||null;return h===null&&v===null?0:h===null?1:v===null||h>v?-1:h<v?1:0}));function M(){f.value.sort((x,o)=>n.value.findIndex(y=>y.key===x.key)-n.value.findIndex(y=>y.key===o.key)),r.setBenchmarkFilters(f.value)}return R(f,M,{deep:!0}),R(m,x=>{r.setBenchmarkSort(x)},{deep:!0}),(x,o)=>{const y=D,h=Q,v=re,b=L,i=E;return d(),u(S,null,[t("div",se,[l(y,{"current-tab":null,tabs:z.value,onClose:s(r).closeTab},null,8,["tabs","onClose"])]),t("div",oe,[t("div",ae,[t("div",ne,[t("div",le,[o[3]||(o[3]=t("div",{class:"font-bold whitespace-nowrap mr-3 text-sm md:text-base"},"Filter by:",-1)),l(h,{modelValue:f.value,"onUpdate:modelValue":o[0]||(o[0]=e=>f.value=e),options:n.value},null,8,["modelValue","options"])]),t("div",ie,[o[4]||(o[4]=t("div",{class:"font-bold whitespace-nowrap mr-3 text-sm md:text-base"},"Sort by:",-1)),l(v,{modelValue:m.value,"onUpdate:modelValue":o[1]||(o[1]=e=>m.value=e),options:C.value},null,8,["modelValue","options"])])]),t("div",de,[o[9]||(o[9]=t("div",{class:"font-bold mb-3 text-sm md:text-base lg:hidden"},"Actions:",-1)),t("div",ce,[o[8]||(o[8]=t("div",{class:"hidden lg:block font-bold mr-2"},"Actions:",-1)),l(b,{icon:"i-heroicons-arrow-path",size:"sm",class:"flex-1 sm:flex-none",onClick:s(r).rerunAll},{default:_(()=>o[5]||(o[5]=[t("span",{class:"hidden sm:inline"},"Rerun All",-1),t("span",{class:"sm:hidden"},"Rerun",-1)])),_:1},8,["onClick"]),l(b,{icon:"i-heroicons-arrow-path",color:"rose",size:"sm",class:"flex-1 sm:flex-none",onClick:s(r).rerunFailed},{default:_(()=>o[6]||(o[6]=[t("span",{class:"hidden sm:inline"},"Rerun Failed Only",-1),t("span",{class:"sm:hidden"},"Failed",-1)])),_:1},8,["onClick"]),l(b,{icon:"i-heroicons-stop",color:"gray",size:"sm",class:"flex-1 sm:flex-none",onClick:s(r).cancelAllRunning},{default:_(()=>o[7]||(o[7]=[t("span",{class:"hidden sm:inline"},"Cancel All",-1),t("span",{class:"sm:hidden"},"Cancel",-1)])),_:1},8,["onClick"])])])]),t("div",ue,[t("div",me,[t("div",pe,[o[10]||(o[10]=t("div",{class:"border-b-2 dark:border-gray-900 h-16 md:h-20"},null,-1)),(d(!0),u(S,null,B(f.value,(e,a)=>(d(),u("div",{key:e.key,class:w(["text-xs md:text-sm uppercase border-b border-l dark:border-gray-900 min-w-[10rem] md:min-w-[13rem] min-h-[3.5rem] md:min-h-[4rem] flex items-center justify-center px-2",a%2===0?"bg-gray-50 dark:bg-gray-800":"bg-white dark:bg-backdrop-dark"])},[t("span",fe,j(e.label),1)],2))),128))]),t("div",ge,[(d(!0),u(S,null,B(g.value,e=>(d(),u("div",{key:e.id,class:"flex flex-col border-r dark:border-gray-900 flex-shrink-0"},[t("div",ye,[l(i,{text:"Rerun","open-delay":500,popper:{arrow:!0}},{default:_(()=>[l(b,{size:"xs",class:"md:mr-2",variant:"ghost",icon:"i-heroicons-arrow-path",disabled:e.status==="running",onClick:a=>s(r).rerun(e.id)},null,8,["disabled","onClick"])]),_:2},1024),l(i,{text:"Go to backtest page","open-delay":500,popper:{arrow:!0}},{default:_(()=>[l(b,{to:`/backtest/${e.id}`,size:"xs",class:"md:mr-2",variant:"ghost",color:"gray",icon:"i-heroicons-arrow-top-right-on-square"},null,8,["to"])]),_:2},1024),l(i,{text:"Duplicate","open-delay":500,popper:{arrow:!0}},{default:_(()=>[l(b,{size:"xs",class:"md:mr-2",variant:"ghost",icon:"i-heroicons-document-duplicate",color:"blue",onClick:a=>s(r).duplicateTab(e.id)},null,8,["onClick"])]),_:2},1024),e.status==="running"?(d(),T(i,{key:0,text:"Cancel","open-delay":500,popper:{arrow:!0}},{default:_(()=>[l(b,{size:"xs",variant:"ghost",icon:"i-heroicons-stop",color:"gray",onClick:a=>s(r).cancel(e.id)},null,8,["onClick"])]),_:2},1024)):(d(),T(i,{key:1,text:"Close tab","open-delay":500,popper:{arrow:!0}},{default:_(()=>[l(b,{size:"xs",variant:"ghost",icon:"i-heroicons-trash",color:"red",disabled:Object.keys(g.value).length==1,onClick:a=>s(r).closeTab(e.id)},null,8,["disabled","onClick"])]),_:2},1024))]),(d(!0),u(S,null,B(f.value,(a,J)=>(d(),u("div",{key:a.key,class:w(["border-b dark:border-gray-900 min-w-[6rem] text-center min-h-[3.5rem] md:min-h-[4rem] w-[10em] md:w-[13em]",e.status==="running"?"animate-pulse":""])},[t("div",{class:w(["px-2 md:px-4 py-3 md:py-4 w-full h-full truncate flex items-center justify-center",J%2===0?"bg-gray-50 dark:bg-gray-800":"bg-white dark:bg-backdrop-dark"])},[t("span",be,j(e[a.key]||"-"),1)],2)],2))),128))]))),128)),l(i,{text:"Add New Tab","open-delay":500,popper:{arrow:!0}},{default:_(()=>[t("button",{class:"w-16 md:w-20 h-full px-2 md:px-4 flex flex-col justify-between items-center border-dashed border-2 dark:border-gray-900 bg-white hover:bg-gray-50 dark:bg-backdrop-dark hover:dark:bg-gray-800 py-8 md:py-10 flex-shrink-0",onClick:o[2]||(o[2]=e=>s(r).addTab())},[l(s(F),{class:"h-5 w-5 md:h-6 md:w-6 text-gray-400 dark:text-gray-100"}),l(s(F),{class:"h-5 w-5 md:h-6 md:w-6 text-gray-400 dark:text-gray-100"}),l(s(F),{class:"h-5 w-5 md:h-6 md:w-6 text-gray-400 dark:text-gray-100"})])]),_:1})])])])])],64)}}});export{_e as default};
