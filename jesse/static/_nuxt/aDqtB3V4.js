import{_ as N}from"./hZKWDH-o.js";import{C as u,g as l,j as o,d as R,m as F,u as J,c as g,a6 as P,a0 as G,ah as O,r as _,i as n,f as m,E as h,x as t,aw as q,e as f,ab as W,aN as Z,k as z,t as K,L as Q,aO as X,G as C,ad as Y,ae as ee,F as te,a8 as oe,s as b,ag as ae}from"./CtRP3raE.js";import{a as se}from"./CJIcHR_m.js";function ne(r,s){return l(),u("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M15.666 3.888A2.25 2.25 0 0 0 13.5 2.25h-3c-1.03 0-1.9.693-2.166 1.638m7.332 0c.055.194.084.4.084.612v0a.75.75 0 0 1-.75.75H9a.75.75 0 0 1-.75-.75v0c0-.212.03-.418.084-.612m7.332 0c.646.049 1.288.11 1.927.184 1.1.128 1.907 1.077 1.907 2.185V19.5a2.25 2.25 0 0 1-2.25 2.25H6.75A2.25 2.25 0 0 1 4.5 19.5V6.257c0-1.108.806-2.057 1.907-2.185a48.208 48.208 0 0 1 1.927-.184"})])}function re(r,s){return l(),u("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 3v1.5M3 21v-6m0 0 2.77-.693a9 9 0 0 1 6.208.682l.108.054a9 9 0 0 0 6.086.71l3.114-.732a48.524 48.524 0 0 1-.005-10.499l-3.11.732a9 9 0 0 1-6.085-.711l-.108-.054a9 9 0 0 0-6.208-.682L3 4.5M3 15V4.5"})])}function le(r,s){return l(),u("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[o("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"})])}const ie={key:0,class:"mb-4"},de=["innerHTML"],ue={class:"flex justify-end"},ce={class:"rounded-md bg-red-50 p-4 my-4 select-text"},me={class:"flex"},pe={class:"flex-shrink-0"},ge={class:"ml-3 overflow-hidden w-full"},he=["textContent"],fe=["innerHTML"],be=["value"],ke=R({__name:"Exception",props:F({title:String,content:{type:String,default:""},mode:String,debugMode:{type:Boolean,default:!1}},{modelValue:{type:Boolean,default:!1},modelModifiers:{}}),emits:["update:modelValue"],setup(r){const s=r,c=J(r,"modelValue"),M=g(()=>P().params.id),L=G(),a=O({description:"",attachLogs:!0,email:""}),B=_(!1),p=_(!1),x=_(!1),y=g(()=>s.mode==="backtest"&&!s.debugMode?{message:'It is highly recommended to attach log files with reports. To do that, press cancel, enable "Debug Mode", and  run again. ',type:"warning"}:{message:"",type:""}),T=g(()=>s.mode==="backtest"&&s.debugMode||s.mode==="live"),k=g(()=>L.hasLivePluginInstalled),U=async()=>{x.value=!0;const{data:v,error:e}=await oe("/system/report-exception",{description:a.description,email:a.email,traceback:s.content,mode:s.mode,attach_logs:a.attachLogs,session_id:M.value},!0);if(x.value=!1,e.value&&e.value.statusCode!==200){b("error",`[${e.value.statusCode}]: ${e.value.message}`);return}const d=v.value;d.status==="success"?(a.description="",a.email="",b("success",d.message),c.value=!1):d.status==="error"&&b("error",d.message)},$=()=>{navigator.clipboard.writeText(s.content),b("success","Copied successfully"),p.value=!0,setTimeout(()=>{p.value=!1},2e3)},E=()=>{c.value=!0};return(v,e)=>{const d=N,S=Z,w=W,D=z,I=ae,V=K,j=q,A=Q,H=se;return l(),u(te,null,[n(A,{modelValue:c.value,"onUpdate:modelValue":e[5]||(e[5]=i=>c.value=i),title:"Report"},{default:m(()=>[t(y).message?(l(),u("div",ie,[n(d,{color:"teal",icon:"i-heroicons-check-circle",title:t(y).message,"close-button":{icon:"i-heroicons-x-mark-20-solid",color:"white",variant:"link"},onClose:e[0]||(e[0]=i=>t(y).message="")},null,8,["title"])])):h("",!0),e[6]||(e[6]=o("p",null," If the exception you're seeing is not clear and you think it might be a bug, please send us a report to help us debugging and fixing it in a future release. ",-1)),e[7]||(e[7]=o("br",null,null,-1)),e[8]||(e[8]=o("label",{class:"font-semibold"},"Exception:",-1)),o("pre",{class:"break-all lg:break-normal mt-2 text-sm whitespace-pre-line px-6 py-6 rounded-md bg-gray-50 dark:bg-gray-700 text-gray-700 dark:text-gray-300 dark:border-gray-800 border border-gray-200",innerHTML:r.content},null,8,de),n(j,{state:t(a),class:"space-y-4 mt-4",onSubmit:U},{default:m(()=>[n(w,{label:"Description (optional):",name:"Description (optional):"},{default:m(()=>[n(S,{modelValue:t(a).description,"onUpdate:modelValue":e[1]||(e[1]=i=>t(a).description=i),rows:10,placeholder:"Describe how the exception occurred..."},null,8,["modelValue"])]),_:1}),t(k)?h("",!0):(l(),f(w,{key:0,label:"Email (must be registered with on Jesse.Trade)",help:"Enter your email address for us to know who sent the feedback and possibly reply back to you. It must be the email address of your account on Jesse.Trade",required:""},{default:m(()=>[n(D,{modelValue:t(a).email,"onUpdate:modelValue":e[2]||(e[2]=i=>t(a).email=i),placeholder:"Email address...",type:"email"},null,8,["modelValue"])]),_:1})),t(T)?(l(),f(I,{key:1,modelValue:t(a).attachLogs,"onUpdate:modelValue":e[3]||(e[3]=i=>t(a).attachLogs=i),title:"Attach Debugging Logs",help:"Attach the log file of this session along with this report which helps Jesse's team"},null,8,["modelValue"])):h("",!0),o("div",ue,[n(V,{id:"feedback-cancel-button",color:"gray",variant:"ghost",class:"mr-2",label:"Cancel",onClick:e[4]||(e[4]=i=>c.value=!1)}),n(V,{id:"feedback-submit-button",type:"submit",class:"w-48 flex justify-center",label:"Submit",loading:t(x),disabled:!t(a).email.length&&!t(k)},null,8,["loading","disabled"])])]),_:1},8,["state"])]),_:1},8,["modelValue"]),n(H,{title:"Exception"},{default:m(()=>[o("button",{type:"button",class:"inline-flex items-center shadow-sm px-4 py-1.5 border border-gray-300 dark:border-gray-600 text-sm leading-5 font-medium rounded-l-full text-gray-700 dark:text-gray-100 bg-white dark:bg-backdrop-dark hover:bg-gray-50 dark:hover:bg-gray-800 focus:outline-none",onClick:E},[n(t(re),{class:"-ml-1.5 mr-1 h-5 w-5 text-gray-400","aria-hidden":"true"}),e[9]||(e[9]=o("span",null,"Report",-1))]),o("button",{type:"button",class:"inline-flex items-center shadow-sm px-4 py-1.5 border border-gray-300 dark:border-gray-600 text-sm leading-5 font-medium rounded-r-full text-gray-700 dark:text-gray-100 bg-white dark:bg-backdrop-dark hover:bg-gray-50 dark:hover:bg-gray-800 focus:outline-none",onClick:$},[t(p)?(l(),f(t(X),{key:0,class:"-ml-1.5 mr-1 h-5 w-5 text-gray-400","aria-hidden":"true"})):(l(),f(t(ne),{key:1,class:"-ml-1.5 mr-1 h-5 w-5 text-gray-400","aria-hidden":"true"})),o("span",null,C(t(p)?"Copied":"Copy"),1)])]),_:1}),o("div",ce,[o("div",me,[o("div",pe,[n(t(le),{class:"h-5 w-5 text-red-400","aria-hidden":"true"})]),o("div",ge,[o("h3",{class:"text-base font-medium text-red-800 mb-6",textContent:C(r.title)},null,8,he),r.content?(l(),u("pre",{key:0,class:"mt-2 text-sm text-red-700 whitespace-pre-line px-6 py-6 rounded-md border-2 border-dashed border-red-200",innerHTML:r.content},null,8,fe)):h("",!0)])]),Y(o("textarea",{id:"exception-info",value:r.content,class:"fixed left-0 bottom-0 opacity-0"},null,8,be),[[ee,t(B)]])])],64)}}});export{ke as _,ne as r};
