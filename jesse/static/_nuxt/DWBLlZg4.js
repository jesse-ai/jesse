import{_ as re}from"./D5TVA8bG.js";import{d as de,a6 as ie,a4 as ue,a0 as ce,A as _e,c as y,r as p,B as pe,w as $,a7 as me,h as j,C as g,j as t,i as a,x as o,E as I,f as n,F as ye,O as ge,D as v,ab as ve,t as he,g as h,k as fe,a9 as xe,G as m,J as M,H as R}from"./DqOwpkBS.js";import{_ as be}from"./BQa5vPmZ.js";import{_ as ke}from"./n_Em2vSK.js";import{_ as we}from"./D4lpbEFL.js";import{_ as Ve}from"./BBK6Zz--.js";import{_ as Te}from"./CE3vDUkH.js";import{u as qe}from"./B8dasSS2.js";import"./BIJgsyhf.js";import"./Mj9S6aN0.js";import"./B28eTbtd.js";import"./DLGiYoOZ.js";const Se={class:"w-full"},Ce={class:"container mx-auto px-4 pt-16 pb-6 max-w-7xl"},Ue={class:"mb-8"},Oe={class:"bg-white dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-2xl p-6 shadow-sm"},De={class:"space-y-6"},Fe={class:"grid grid-cols-1 lg:grid-cols-12 gap-5"},Me={class:"lg:col-span-6"},Re={class:"lg:col-span-3"},ze={class:"lg:col-span-3"},Ee={class:"pt-6 border-t border-gray-100 dark:border-gray-700/50"},Le={class:"flex flex-col sm:flex-row gap-5 sm:items-end"},Ae={class:"w-full sm:flex-1 grid grid-cols-1 sm:grid-cols-3 gap-5"},Ne={class:"flex justify-end pt-2 sm:pt-0"},He={key:0,class:"space-y-4"},Be={class:"bg-white dark:bg-gray-800 shadow rounded-lg overflow-hidden"},$e={class:"divide-y divide-gray-200 dark:divide-gray-700"},je={class:"hidden md:grid md:grid-cols-9 gap-4 items-center"},Ie={class:"col-span-1"},Pe={class:"col-span-1"},Ge={class:"col-span-1"},Je={class:"col-span-1"},Qe={class:"col-span-1"},Ye={class:"col-span-1"},Ke={class:"col-span-1"},We={class:"col-span-1"},Xe={class:"col-span-1"},Ze={key:1,class:"space-y-4"},el={class:"bg-white dark:bg-gray-800/50 border border-gray-200 dark:border-gray-700 rounded-lg overflow-hidden shadow-sm"},ll={class:"text-sm font-medium"},tl={class:"text-sm text-gray-700 dark:text-gray-300"},sl={class:"text-sm text-gray-700 dark:text-gray-300"},al={class:"text-sm text-gray-700 dark:text-gray-300"},ol={key:0,class:"flex flex-col"},nl={key:1,class:"text-gray-400"},rl={class:"text-sm text-gray-500 dark:text-gray-400"},dl={class:"text-sm text-gray-700 dark:text-gray-300"},il={key:0,class:"flex justify-center"},ul={key:2,class:"bg-white dark:bg-gray-800 shadow rounded-lg p-12 text-center"},P=50,Vl=de({__name:"trades-history",setup(cl){qe({title:"Trades History - Jesse"});const r=ie(),k=ue(),z=ce(),V=_e(),G=y(()=>V.tabs),f=p([]),q=p(!1),O=p(!1),D=p(!0),T=p(0),S=p(!1),E=p(null),C=p(!1),L=p(null),x=y({get:()=>r.query.id||"",set:s=>{const e={...r.query};s?e.id=s:delete e.id,k.push({query:e})}}),d=y({get:()=>r.query.status||"all",set:s=>{const e={...r.query};s==="all"?delete e.status:e.status=s,k.push({query:e})}}),b=y({get:()=>r.query.symbol||"",set:s=>{const e={...r.query};s?e.symbol=s:delete e.symbol,k.push({query:e})}}),i=y({get:()=>r.query.dateRange||"all_time",set:s=>{const e={...r.query};s==="all_time"?delete e.dateRange:e.dateRange=s,k.push({query:e})}}),u=y({get:()=>r.query.exchange||"all",set:s=>{const e={...r.query};s==="all"?delete e.exchange:e.exchange=s,k.push({query:e})}}),c=y({get:()=>r.query.type||"all",set:s=>{const e={...r.query};s==="all"?delete e.type:e.type=s,k.push({query:e})}}),J=[{label:"All Statuses",value:"all"},{label:"Open",value:"open"},{label:"Closed",value:"closed"}],Q=[{label:"All Time",value:"all_time"},{label:"Last 7 Days",value:"7_days"},{label:"Last 30 Days",value:"30_days"},{label:"Last 90 Days",value:"90_days"}],Y=y(()=>{const s=[{label:"All Exchanges",value:"all",disabled:!1}];for(const e of z.liveTradingExchangeNames)z.planLimits.exchanges.includes(e)?s.push({label:e,value:e,disabled:!1}):s.push({label:`${e} (Upgrade required)`,value:e,disabled:!0});return s}),K=[{label:"All Types",value:"all"},{label:"Long",value:"long"},{label:"Short",value:"short"}],W=[{key:"symbol",label:"Symbol"},{key:"type",label:"Type"},{key:"entry_price",label:"Entry"},{key:"exit_price",label:"Exit"},{key:"qty",label:"QTY"},{key:"pnl",label:"PNL"},{key:"opened_at",label:"Opened"},{key:"status",label:"Status"},{key:"exchange",label:"Exchange"}];pe(()=>{setTimeout(()=>{F()},20)});const X=me(()=>{T.value=0,F()},300);$(x,()=>{X()}),$([d,b,i,u,c],()=>{T.value=0,F()});async function F(){q.value=!0;try{const s=await V.fetchTradesHistory({limit:P,offset:0,id_search:x.value||null,status_filter:d.value==="all"?null:d.value,symbol_filter:b.value||null,date_filter:i.value==="all_time"?null:i.value,exchange_filter:u.value==="all"?null:u.value,type_filter:c.value==="all"?null:c.value});f.value=s.trades||[],T.value=f.value.length,D.value=s.hasMore}catch(s){j(s)}finally{q.value=!1}}async function Z(){O.value=!0;try{const s=await V.fetchTradesHistory({limit:P,offset:T.value,id_search:x.value||null,status_filter:d.value==="all"?null:d.value,symbol_filter:b.value||null,date_filter:i.value==="all_time"?null:i.value,exchange_filter:u.value==="all"?null:u.value,type_filter:c.value==="all"?null:c.value});f.value=[...f.value,...s.trades||[]],T.value+=(s.trades||[]).length,D.value=s.hasMore}catch(s){j(s)}finally{O.value=!1}}function ee(s){E.value=s.id,S.value=!0}function le(s){L.value=s,C.value=!0}function te(){x.value="",d.value="all",b.value="",i.value="all_time",u.value="all",c.value="all"}function A(s){const e=Number(s);return e===0||isNaN(e)?"text-gray-900 dark:text-gray-100":e>0?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"}return(s,e)=>{const N=re,H=fe,w=ve,U=xe,B=he,_=be,se=ke,ae=we,oe=Ve,ne=Te;return h(),g("div",null,[t("div",Se,[a(N,{"current-tab":null,tabs:o(G),onClose:o(V).closeTab,onCancel:o(V).cancel},null,8,["tabs","onClose","onCancel"])]),t("div",Ce,[t("div",Ue,[e[8]||(e[8]=t("h1",{class:"text-2xl md:text-3xl font-bold text-gray-900 dark:text-white mb-6"}," Trades History ",-1)),t("div",Oe,[t("div",De,[t("div",Fe,[t("div",Me,[a(w,{label:"Search Session",size:"md"},{default:n(()=>[a(H,{modelValue:o(x),"onUpdate:modelValue":e[0]||(e[0]=l=>v(x)?x.value=l:null),placeholder:"Enter Session ID...",icon:"i-heroicons-magnifying-glass",variant:"outline"},null,8,["modelValue"])]),_:1})]),t("div",Re,[a(w,{label:"Status",size:"md"},{default:n(()=>[a(U,{modelValue:o(d),"onUpdate:modelValue":e[1]||(e[1]=l=>v(d)?d.value=l:null),options:J},null,8,["modelValue"])]),_:1})]),t("div",ze,[a(w,{label:"Timeframe",size:"md"},{default:n(()=>[a(U,{modelValue:o(i),"onUpdate:modelValue":e[2]||(e[2]=l=>v(i)?i.value=l:null),options:Q},null,8,["modelValue"])]),_:1})])]),t("div",Ee,[t("div",Le,[t("div",Ae,[a(w,{label:"Symbol",size:"sm"},{default:n(()=>[a(H,{modelValue:o(b),"onUpdate:modelValue":e[3]||(e[3]=l=>v(b)?b.value=l:null),placeholder:"BTC-USDT...",icon:"i-heroicons-currency-dollar"},null,8,["modelValue"])]),_:1}),a(w,{label:"Exchange",size:"sm"},{default:n(()=>[a(U,{modelValue:o(u),"onUpdate:modelValue":e[4]||(e[4]=l=>v(u)?u.value=l:null),options:o(Y)},null,8,["modelValue","options"])]),_:1}),a(w,{label:"Type",size:"sm"},{default:n(()=>[a(U,{modelValue:o(c),"onUpdate:modelValue":e[5]||(e[5]=l=>v(c)?c.value=l:null),options:K},null,8,["modelValue"])]),_:1})]),t("div",Ne,[a(B,{label:"Reset All",color:"gray",variant:"soft",icon:"i-heroicons-arrow-path",size:"sm",class:"w-full sm:w-auto justify-center",onClick:te})])])])])])]),o(q)?(h(),g("div",He,[t("div",Be,[t("div",$e,[(h(),g(ye,null,ge(5,l=>t("div",{key:l,class:"p-4"},[t("div",je,[t("div",Ie,[a(_,{class:"h-4 w-full"})]),t("div",Pe,[a(_,{class:"h-4 w-full"})]),t("div",Ge,[a(_,{class:"h-4 w-full"})]),t("div",Je,[a(_,{class:"h-4 w-full"})]),t("div",Qe,[a(_,{class:"h-4 w-full"})]),t("div",Ye,[a(_,{class:"h-4 w-full"})]),t("div",Ke,[a(_,{class:"h-4 w-full"})]),t("div",We,[a(_,{class:"h-4 w-full"})]),t("div",Xe,[a(_,{class:"h-4 w-full"})])])])),64))])])])):o(f).length?(h(),g("div",Ze,[t("div",el,[a(ae,{rows:o(f),columns:W,class:"w-full",ui:{td:{base:"whitespace-nowrap"},th:{base:"whitespace-nowrap"}},onSelect:ee},{"symbol-data":n(({row:l})=>[t("span",ll,m(l.symbol),1)]),"type-data":n(({row:l})=>[t("span",{class:R(["text-sm font-medium",l.type==="long"?"text-green-600 dark:text-green-400":"text-red-600 dark:text-red-400"])},m(l.type),3)]),"entry_price-data":n(({row:l})=>[t("span",tl,m(o(M).roundPrice(l.entry_price)),1)]),"exit_price-data":n(({row:l})=>[t("span",sl,m(l.exit_price?o(M).roundPrice(l.exit_price):"-"),1)]),"qty-data":n(({row:l})=>[t("span",al,m(l.qty),1)]),"pnl-data":n(({row:l})=>[l.pnl!==null&&l.pnl!==void 0?(h(),g("div",ol,[t("span",{class:R(["text-sm font-bold",A(l.pnl)])},m(Math.round(l.pnl*100)/100),3),t("span",{class:R(["text-xs",A(l.pnl)])}," ("+m(Math.round(l.pnl_percentage*100)/100)+"%) ",3)])):(h(),g("span",nl,"-"))]),"opened_at-data":n(({row:l})=>[t("span",rl,m(o(M).timestampToReadableDateTime(l.opened_at)),1)]),"status-data":n(({row:l})=>[a(se,{color:l.status==="open"?"blue":"gray",label:l.status,variant:"soft",size:"xs"},null,8,["color","label"])]),"exchange-data":n(({row:l})=>[t("span",dl,m(l.exchange),1)]),_:1},8,["rows"])]),o(D)?(h(),g("div",il,[a(B,{label:"Load More",variant:"soft",color:"gray",loading:o(O),onClick:Z},null,8,["loading"])])):I("",!0)])):!o(q)&&o(f).length===0?(h(),g("div",ul,e[9]||(e[9]=[t("div",{class:"text-gray-400 dark:text-gray-500"},[t("i",{class:"i-heroicons-chart-bar h-12 w-12 mx-auto mb-4"}),t("p",{class:"text-lg"},"No trades found"),t("p",{class:"text-sm mt-2"},"Adjust your filters to see items in your trade history")],-1)]))):I("",!0),a(oe,{modelValue:o(S),"onUpdate:modelValue":e[6]||(e[6]=l=>v(S)?S.value=l:null),"trade-id":o(E),onOrderClick:le},null,8,["modelValue","trade-id"]),a(ne,{modelValue:o(C),"onUpdate:modelValue":e[7]||(e[7]=l=>v(C)?C.value=l:null),"order-id":o(L)},null,8,["modelValue","order-id"])])])}}});export{Vl as default};
