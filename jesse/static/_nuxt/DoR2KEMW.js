import{u as S,S as O}from"./70-VMsKu.js";import{b3 as P,b4 as j,b5 as M,d as K,r as _,c as h,b6 as A,a as F,w,H as T,o as q,P as I,b7 as J,z as X,j as g,i as a,f as u,W as f,X as $,I as G,s as E,l as Q,as as Y,g as Z,L as ee,t as te,q as v,p as oe,$ as ne,a3 as ae}from"./BZBcjETW.js";import{_ as se}from"./CBtiHpmx.js";import{u as ie}from"./D-92rLZE.js";function re(){const{$connectPyrightLsp:k}=P();function p(o,l,d){var c;const i=j.parse(`file:///${l}`);let n=M.getModel(i);return n?n.setValue(d.value):n=M.createModel(d.value,"python",i),(c=o.getModel())==null||c.dispose(),o.setModel(n),n.onDidChangeContent(()=>{d.value=n.getValue()}),n}return{onEditorLoaded:async(o,l,d,i,n)=>{const c=await S().getStrategy(l);return i.value=c,p(o,d,i),n&&o.updateOptions(n),k(o),c}}}const le=oe(se),de={class:"grid items-start lg:grid-cols-5"},ce={class:"grid grid-cols-1 lg:col-span-4 bg-backdrop dark:bg-backdrop-dark"},ue={class:"h-10 flex items-center justify-between px-4"},pe={class:"font-semibold"},ge={class:"flex items-center select-none"},me={class:"overflow-hidden border-l border-t dark:border-gray-600"},he=K({__name:"[name]",setup(k){const p=_(!1),s=h(()=>A().params.name),o=_(""),l=_(""),d=F(),i=h(()=>d.value==="light"?"vs-light":"vs-dark"),n=_(),{onEditorLoaded:c}=re();ie({title:`${s.value} - Jesse`}),w(i,t=>{n.value.$editor.updateOptions({theme:t})});async function z(t){const e=`strategies/${s.value}/__init__.py`,b=await c(t,s.value,e,o,{theme:i.value});l.value=b}T(async()=>{window.addEventListener("keydown",L)}),q(()=>{window.removeEventListener("keydown",L)});const C=h(()=>o.value!==l.value),r=h(()=>I().settings.editor),H={automaticLayout:!0,minimap:{enabled:r.value.minimap},fontSize:r.value.fontSize,padding:{top:16,bottom:16},cursorStyle:r.value.cursorStyle,cursorWidth:r.value.cursorWidth,lineHeight:r.value.lineHeight,cursorBlinking:r.value.cursorBlinking,renderLineHighlight:r.value.renderLineHighlight};w(r,t=>{n.value.$editor.updateOptions({minimap:{enabled:t.minimap},fontSize:t.fontSize,cursorStyle:t.cursorStyle,cursorWidth:t.cursorWidth,lineHeight:t.lineHeight,cursorBlinking:t.cursorBlinking,renderLineHighlight:t.renderLineHighlight})},{deep:!0});function B(){ne.copyToClipboard(o.value),E("success","Code copied to clipboard")}async function x(){if(C.value){if(o.value===""){E("error","Code cannot be empty");return}await S().saveStrategy(s.value,o.value),l.value=o.value}}const D=J.debounce(async()=>{await x()},300);function L(t){t.key==="s"&&(navigator.platform.match("Mac")?t.metaKey:t.ctrlKey)&&(t.preventDefault(),D())}function U(){n.value.$editor.trigger("source","actions.find",{})}function N(){S().deleteStrategy(s.value),ae().push("/strategies")}return(t,e)=>{const b=O,m=te,R=le,V=Q,W=Y;return Z(),X(G,null,[g("section",de,[a(b),g("div",ce,[a(V,null,{default:u(()=>[g("div",ue,[g("h2",pe,ee(f(s)),1),g("div",ge,[a(m,{size:"xs",icon:"i-heroicons-trash",color:"gray",variant:"ghost",class:"ml-2",onClick:e[0]||(e[0]=y=>p.value=!0)},{default:u(()=>e[3]||(e[3]=[v(" Delete ")])),_:1}),a(m,{size:"xs",icon:"i-heroicons-clipboard",color:"gray",variant:"ghost",class:"ml-2",onClick:B},{default:u(()=>e[4]||(e[4]=[v(" Copy ")])),_:1}),a(m,{size:"xs",icon:"i-heroicons-magnifying-glass",class:"ml-2",color:"gray",variant:"ghost",onClick:U},{default:u(()=>e[5]||(e[5]=[v(" Find ")])),_:1}),a(m,{size:"xs",icon:"i-heroicons-check",class:"ml-2",color:"teal",variant:"ghost",disabled:!f(C),onClick:x},{default:u(()=>e[6]||(e[6]=[v(" Save ")])),_:1},8,["disabled"])])]),g("div",me,[a(R,{ref_key:"editorRef",ref:n,modelValue:f(o),"onUpdate:modelValue":e[1]||(e[1]=y=>$(o)?o.value=y:null),lang:"python",options:H,style:{height:"calc(100vh - 4rem - 4px - 2.5rem)"},onLoad:z},{default:u(()=>e[7]||(e[7]=[v(" Loading editor... ")])),_:1},8,["modelValue"])])]),_:1})])]),a(W,{modelValue:f(p),"onUpdate:modelValue":e[2]||(e[2]=y=>$(p)?p.value=y:null),title:"Delete strategy",description:`Are you sure you want to delete the strategy '${f(s)}'?`,type:"info"},{default:u(()=>[a(m,{variant:"solid",color:"red",class:"flex justify-center",label:"Delete",onClick:N})]),_:1},8,["modelValue","description"])],64)}}});export{he as default};
